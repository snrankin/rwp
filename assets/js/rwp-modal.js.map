{"version":3,"file":"js/rwp-modal.js","mappings":"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","sources":["webpack:///../node_modules/@fancyapps/ui/src/Carousel/Carousel.js","webpack:///../node_modules/@fancyapps/ui/src/Carousel/l10n/en.js","webpack:///../node_modules/@fancyapps/ui/src/Carousel/plugins/Dots/Dots.js","webpack:///../node_modules/@fancyapps/ui/src/Carousel/plugins/Navigation/Navigation.js","webpack:///../node_modules/@fancyapps/ui/src/Carousel/plugins/Sync/Sync.js","webpack:///../node_modules/@fancyapps/ui/src/Carousel/plugins/index.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/Fancybox.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/l10n/en.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/Hash/Hash.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/Html/Html.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/Image/Image.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/ScrollLock/ScrollLock.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/Thumbs/Thumbs.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/Toolbar/Toolbar.js","webpack:///../node_modules/@fancyapps/ui/src/Fancybox/plugins/index.js","webpack:///../node_modules/@fancyapps/ui/src/Panzoom/Panzoom.js","webpack:///../node_modules/@fancyapps/ui/src/Panzoom/plugins/index.js","webpack:///../node_modules/@fancyapps/ui/src/shared/Base/Base.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/Fullscreen.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/PointerTracker.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/ResizeObserver.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/Slideshow.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/canUseDOM.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/extend.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/getDimensions.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/getTextNodeFromPoint.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/isPlainObject.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/isScrollable.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/resolve.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/round.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/setFocusOn.js","webpack:///../node_modules/@fancyapps/ui/src/shared/utils/throttle.js","webpack:///webpack/bootstrap","webpack:///webpack/runtime/define property getters","webpack:///webpack/runtime/hasOwnProperty shorthand","webpack:///webpack/runtime/make namespace object","webpack:///./js/plugins/modal.js"],"sourcesContent":["import { Base } from \"../shared/Base/Base.js\";\r\nimport { Panzoom } from \"../Panzoom/Panzoom.js\";\r\n\r\nimport { extend } from \"../shared/utils/extend.js\";\r\nimport { round } from \"../shared/utils/round.js\";\r\nimport { throttle } from \"../shared/utils/throttle.js\";\r\n\r\nimport { Plugins } from \"./plugins/index.js\";\r\n\r\n// Default language\r\nimport en from \"./l10n/en.js\";\r\n\r\nconst defaults = {\r\n  // Virtual slides. Each object should have at least `html` property that will be used to set content,\r\n  // example: `slides: [{html: 'First slide'}, {html: 'Second slide'}]`\r\n  slides: [],\r\n\r\n  // Number of slides to preload before/after visible slides\r\n  preload: 0,\r\n\r\n  // Number of slides to group into the page,\r\n  // if `auto` - group all slides that fit into the viewport\r\n  slidesPerPage: \"auto\",\r\n\r\n  // Index of initial page\r\n  initialPage: null,\r\n\r\n  // Index of initial slide\r\n  initialSlide: null,\r\n\r\n  // Panzoom friction while changing page\r\n  friction: 0.92,\r\n\r\n  // Should center active page\r\n  center: true,\r\n\r\n  // Should carousel scroll infinitely\r\n  infinite: true,\r\n\r\n  // Should the gap be filled before first and after last slide if `infinite: false`\r\n  fill: true,\r\n\r\n  // Should Carousel settle at any position after a swipe.\r\n  dragFree: false,\r\n\r\n  // Prefix for CSS classes, must be the same as the  SCSS `$carousel-prefix` variable\r\n  prefix: \"\",\r\n\r\n  // Class names for DOM elements (without prefix)\r\n  classNames: {\r\n    viewport: \"carousel__viewport\",\r\n    track: \"carousel__track\",\r\n    slide: \"carousel__slide\",\r\n\r\n    // Classname toggled for slides inside current page\r\n    slideSelected: \"is-selected\",\r\n  },\r\n\r\n  // Localization of strings\r\n  l10n: en,\r\n};\r\n\r\nexport class Carousel extends Base {\r\n  /**\r\n   * Carousel constructor\r\n   * @constructs Carousel\r\n   * @param {HTMLElement} $container - Carousel container\r\n   * @param {Object} [options] - Options for Carousel\r\n   */\r\n  constructor($container, options = {}) {\r\n    options = extend(true, {}, defaults, options);\r\n\r\n    super(options);\r\n\r\n    this.state = \"init\";\r\n\r\n    this.$container = $container;\r\n\r\n    if (!(this.$container instanceof HTMLElement)) {\r\n      throw new Error(\"No root element provided\");\r\n    }\r\n\r\n    this.slideNext = throttle(this.slideNext.bind(this), 250, true);\r\n    this.slidePrev = throttle(this.slidePrev.bind(this), 250, true);\r\n\r\n    this.init();\r\n\r\n    $container.__Carousel = this;\r\n  }\r\n\r\n  /**\r\n   * Perform initialization\r\n   */\r\n  init() {\r\n    this.pages = [];\r\n    this.page = this.pageIndex = null;\r\n    this.prevPage = this.prevPageIndex = null;\r\n\r\n    this.attachPlugins(Carousel.Plugins);\r\n\r\n    this.trigger(\"init\");\r\n\r\n    this.initLayout();\r\n\r\n    this.initSlides();\r\n\r\n    this.updateMetrics();\r\n\r\n    if (this.$track && this.pages.length) {\r\n      this.$track.style.transform = `translate3d(${this.pages[this.page].left * -1}px, 0px, 0) scale(1)`;\r\n    }\r\n\r\n    this.manageSlideVisiblity();\r\n\r\n    this.initPanzoom();\r\n\r\n    this.state = \"ready\";\r\n\r\n    this.trigger(\"ready\");\r\n  }\r\n\r\n  /**\r\n   * Initialize layout; create necessary elements\r\n   */\r\n  initLayout() {\r\n    const prefix = this.option(\"prefix\");\r\n    const classNames = this.option(\"classNames\");\r\n\r\n    this.$viewport = this.option(\"viewport\") || this.$container.querySelector(`.${prefix}${classNames.viewport}`);\r\n\r\n    if (!this.$viewport) {\r\n      this.$viewport = document.createElement(\"div\");\r\n      this.$viewport.classList.add(...(prefix + classNames.viewport).split(\" \"));\r\n\r\n      this.$viewport.append(...this.$container.childNodes);\r\n\r\n      this.$container.appendChild(this.$viewport);\r\n    }\r\n\r\n    this.$track = this.option(\"track\") || this.$container.querySelector(`.${prefix}${classNames.track}`);\r\n\r\n    if (!this.$track) {\r\n      this.$track = document.createElement(\"div\");\r\n      this.$track.classList.add(...(prefix + classNames.track).split(\" \"));\r\n\r\n      this.$track.append(...this.$viewport.childNodes);\r\n\r\n      this.$viewport.appendChild(this.$track);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Fill `slides` array with objects from existing nodes and/or `slides` option\r\n   */\r\n  initSlides() {\r\n    this.slides = [];\r\n\r\n    // Get existing slides from the DOM\r\n    const elems = this.$viewport.querySelectorAll(`.${this.option(\"prefix\")}${this.option(\"classNames.slide\")}`);\r\n\r\n    elems.forEach((el) => {\r\n      const slide = {\r\n        $el: el,\r\n        isDom: true,\r\n      };\r\n\r\n      this.slides.push(slide);\r\n\r\n      this.trigger(\"createSlide\", slide, this.slides.length);\r\n    });\r\n\r\n    // Add virtual slides, but do not create DOM elements yet,\r\n    // because they will be created dynamically based on current carousel position\r\n    if (Array.isArray(this.options.slides)) {\r\n      this.slides = extend(true, [...this.slides], this.options.slides);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Do all calculations related to slide size and paging\r\n   */\r\n  updateMetrics() {\r\n    // Calculate content width, viewport width\r\n    // ===\r\n    let contentWidth = 0;\r\n    let indexes = [];\r\n    let lastSlideWidth;\r\n\r\n    this.slides.forEach((slide, index) => {\r\n      const $el = slide.$el;\r\n      const slideWidth = slide.isDom || !lastSlideWidth ? this.getSlideMetrics($el) : lastSlideWidth;\r\n\r\n      slide.index = index;\r\n      slide.width = slideWidth;\r\n      slide.left = contentWidth;\r\n\r\n      lastSlideWidth = slideWidth;\r\n      contentWidth += slideWidth;\r\n\r\n      indexes.push(index);\r\n    });\r\n\r\n    let viewportWidth = Math.max(this.$track.offsetWidth, round(this.$track.getBoundingClientRect().width));\r\n\r\n    let viewportStyles = getComputedStyle(this.$track);\r\n    viewportWidth = viewportWidth - (parseFloat(viewportStyles.paddingLeft) + parseFloat(viewportStyles.paddingRight));\r\n\r\n    this.contentWidth = contentWidth;\r\n    this.viewportWidth = viewportWidth;\r\n\r\n    // Split slides into pages\r\n    // ===\r\n    const pages = [];\r\n    const slidesPerPage = this.option(\"slidesPerPage\");\r\n\r\n    if (Number.isInteger(slidesPerPage) && contentWidth > viewportWidth) {\r\n      // Fixed number of slides in the page\r\n      for (let i = 0; i < this.slides.length; i += slidesPerPage) {\r\n        pages.push({\r\n          indexes: indexes.slice(i, i + slidesPerPage),\r\n          slides: this.slides.slice(i, i + slidesPerPage),\r\n        });\r\n      }\r\n    } else {\r\n      // Slides that fit inside viewport\r\n      let currentPage = 0;\r\n      let currentWidth = 0;\r\n\r\n      for (let i = 0; i < this.slides.length; i += 1) {\r\n        let slide = this.slides[i];\r\n\r\n        // Add next page\r\n        if (!pages.length || currentWidth + slide.width > viewportWidth) {\r\n          pages.push({\r\n            indexes: [],\r\n            slides: [],\r\n          });\r\n\r\n          currentPage = pages.length - 1;\r\n          currentWidth = 0;\r\n        }\r\n\r\n        currentWidth += slide.width;\r\n\r\n        pages[currentPage].indexes.push(i);\r\n        pages[currentPage].slides.push(slide);\r\n      }\r\n    }\r\n\r\n    const shouldCenter = this.option(\"center\");\r\n    const shouldFill = this.option(\"fill\");\r\n\r\n    // Calculate width and start position for each page\r\n    // ===\r\n    pages.forEach((page, index) => {\r\n      page.index = index;\r\n      page.width = page.slides.reduce((sum, slide) => sum + slide.width, 0);\r\n\r\n      page.left = page.slides[0].left;\r\n\r\n      if (shouldCenter) {\r\n        page.left += (viewportWidth - page.width) * 0.5 * -1;\r\n      }\r\n\r\n      if (shouldFill && !this.option(\"infiniteX\", this.option(\"infinite\")) && contentWidth > viewportWidth) {\r\n        page.left = Math.max(page.left, 0);\r\n        page.left = Math.min(page.left, contentWidth - viewportWidth);\r\n      }\r\n    });\r\n\r\n    // Merge pages\r\n    // ===\r\n    const rez = [];\r\n    let prevPage;\r\n\r\n    pages.forEach((page2) => {\r\n      const page = { ...page2 };\r\n\r\n      if (prevPage && page.left === prevPage.left) {\r\n        prevPage.width += page.width;\r\n\r\n        prevPage.slides = [...prevPage.slides, ...page.slides];\r\n        prevPage.indexes = [...prevPage.indexes, ...page.indexes];\r\n      } else {\r\n        page.index = rez.length;\r\n\r\n        prevPage = page;\r\n\r\n        rez.push(page);\r\n      }\r\n    });\r\n\r\n    this.pages = rez;\r\n\r\n    let page = this.page;\r\n\r\n    if (page === null) {\r\n      const initialSlide = this.option(\"initialSlide\");\r\n\r\n      if (initialSlide !== null) {\r\n        page = this.findPageForSlide(initialSlide);\r\n      } else {\r\n        page = parseInt(this.option(\"initialPage\", 0), 10) || 0;\r\n      }\r\n\r\n      if (!rez[page]) {\r\n        page = rez.length && page > rez.length ? rez[rez.length - 1].index : 0;\r\n      }\r\n\r\n      this.page = page;\r\n      this.pageIndex = page;\r\n    }\r\n\r\n    this.updatePanzoom();\r\n\r\n    this.trigger(\"refresh\");\r\n  }\r\n\r\n  /**\r\n   * Calculate slide element width (including left, right margins)\r\n   * @param {Object} node\r\n   * @returns {Number} Width in px\r\n   */\r\n  getSlideMetrics(node) {\r\n    if (!node) {\r\n      const firstSlide = this.slides[0];\r\n\r\n      node = document.createElement(\"div\");\r\n\r\n      node.dataset.isTestEl = 1;\r\n      node.style.visibility = \"hidden\";\r\n      node.classList.add(...(this.option(\"prefix\") + this.option(\"classNames.slide\")).split(\" \"));\r\n\r\n      // Assume all slides have the same custom class, if any\r\n      if (firstSlide.customClass) {\r\n        node.classList.add(...firstSlide.customClass.split(\" \"));\r\n      }\r\n\r\n      this.$track.prepend(node);\r\n    }\r\n\r\n    let width = Math.max(node.offsetWidth, round(node.getBoundingClientRect().width));\r\n\r\n    // Add left/right margin\r\n    const style = node.currentStyle || window.getComputedStyle(node);\r\n    width = width + (parseFloat(style.marginLeft) || 0) + (parseFloat(style.marginRight) || 0);\r\n\r\n    if (node.dataset.isTestEl) {\r\n      node.remove();\r\n    }\r\n\r\n    return width;\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param {Integer} index Index of the slide\r\n   * @returns {Integer|null} Index of the page if found, or null\r\n   */\r\n  findPageForSlide(index) {\r\n    index = parseInt(index, 10) || 0;\r\n\r\n    const page = this.pages.find((page) => {\r\n      return page.indexes.indexOf(index) > -1;\r\n    });\r\n\r\n    return page ? page.index : null;\r\n  }\r\n\r\n  /**\r\n   * Slide to next page, if possible\r\n   */\r\n  slideNext() {\r\n    this.slideTo(this.pageIndex + 1);\r\n  }\r\n\r\n  /**\r\n   * Slide to previous page, if possible\r\n   */\r\n  slidePrev() {\r\n    this.slideTo(this.pageIndex - 1);\r\n  }\r\n\r\n  /**\r\n   * Slides carousel to given page\r\n   * @param {Number} page - New index of active page\r\n   * @param {Object} [params] - Additional options\r\n   */\r\n  slideTo(page, params = {}) {\r\n    const { x = this.setPage(page, true) * -1, y = 0, friction = this.option(\"friction\") } = params;\r\n\r\n    if (this.Panzoom.content.x === x && !this.Panzoom.velocity.x && friction) {\r\n      return;\r\n    }\r\n\r\n    this.Panzoom.panTo({\r\n      x,\r\n      y,\r\n      friction,\r\n      ignoreBounds: true,\r\n    });\r\n\r\n    if (this.state === \"ready\" && this.Panzoom.state === \"ready\") {\r\n      this.trigger(\"settle\");\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Initialise main Panzoom instance\r\n   */\r\n  initPanzoom() {\r\n    if (this.Panzoom) {\r\n      this.Panzoom.destroy();\r\n    }\r\n\r\n    // Create fresh object containing options for Pazoom instance\r\n    const options = extend(\r\n      true,\r\n      {},\r\n      {\r\n        // Track element will be set as Panzoom $content\r\n        content: this.$track,\r\n        wrapInner: false,\r\n        resizeParent: false,\r\n\r\n        // Disable any user interaction\r\n        zoom: false,\r\n        click: false,\r\n\r\n        // Right now, only horizontal navigation is supported\r\n        lockAxis: \"x\",\r\n\r\n        x: this.pages.length ? this.pages[this.page].left * -1 : 0,\r\n        centerOnStart: false,\r\n\r\n        // Make `textSelection` option more easy to customize\r\n        textSelection: () => this.option(\"textSelection\", false),\r\n\r\n        // Disable dragging if content (e.g. all slides) fits inside viewport\r\n        panOnlyZoomed: function () {\r\n          return this.content.width <= this.viewport.width;\r\n        },\r\n      },\r\n      this.option(\"Panzoom\")\r\n    );\r\n\r\n    // Create new Panzoom instance\r\n    this.Panzoom = new Panzoom(this.$container, options);\r\n\r\n    this.Panzoom.on({\r\n      // Bubble events\r\n      \"*\": (name, ...details) => this.trigger(`Panzoom.${name}`, ...details),\r\n      // The rest of events to be processed\r\n      afterUpdate: () => {\r\n        this.updatePage();\r\n      },\r\n      beforeTransform: this.onBeforeTransform.bind(this),\r\n      touchEnd: this.onTouchEnd.bind(this),\r\n      endAnimation: () => {\r\n        this.trigger(\"settle\");\r\n      },\r\n    });\r\n\r\n    // The contents of the slides may cause the page scroll bar to appear, so the carousel width may change\r\n    // and slides have to be repositioned\r\n    this.updateMetrics();\r\n    this.manageSlideVisiblity();\r\n  }\r\n\r\n  updatePanzoom() {\r\n    if (!this.Panzoom) {\r\n      return;\r\n    }\r\n\r\n    this.Panzoom.content = {\r\n      ...this.Panzoom.content,\r\n      fitWidth: this.contentWidth,\r\n      origWidth: this.contentWidth,\r\n      width: this.contentWidth,\r\n    };\r\n\r\n    if (this.pages.length > 1 && this.option(\"infiniteX\", this.option(\"infinite\"))) {\r\n      this.Panzoom.boundX = null;\r\n    } else if (this.pages.length) {\r\n      this.Panzoom.boundX = {\r\n        from: this.pages[this.pages.length - 1].left * -1,\r\n        to: this.pages[0].left * -1,\r\n      };\r\n    }\r\n\r\n    if (this.option(\"infiniteY\", this.option(\"infinite\"))) {\r\n      this.Panzoom.boundY = null;\r\n    } else {\r\n      this.Panzoom.boundY = {\r\n        from: 0,\r\n        to: 0,\r\n      };\r\n    }\r\n\r\n    this.Panzoom.handleCursor();\r\n  }\r\n\r\n  manageSlideVisiblity() {\r\n    const contentWidth = this.contentWidth;\r\n    const viewportWidth = this.viewportWidth;\r\n\r\n    let currentX = this.Panzoom ? this.Panzoom.content.x * -1 : this.pages.length ? this.pages[this.page].left : 0;\r\n\r\n    const preload = this.option(\"preload\");\r\n    const infinite = this.option(\"infiniteX\", this.option(\"infinite\"));\r\n\r\n    const paddingLeft = parseFloat(getComputedStyle(this.$viewport, null).getPropertyValue(\"padding-left\"));\r\n    const paddingRight = parseFloat(getComputedStyle(this.$viewport, null).getPropertyValue(\"padding-right\"));\r\n\r\n    // Check visibility of each slide\r\n    this.slides.forEach((slide) => {\r\n      let leftBoundary, rightBoundary;\r\n\r\n      let hasDiff = 0;\r\n\r\n      // #1 - slides in current viewport; this does not include infinite items\r\n      leftBoundary = currentX - paddingLeft;\r\n      rightBoundary = currentX + viewportWidth + paddingRight;\r\n\r\n      leftBoundary -= preload * (viewportWidth + paddingLeft + paddingRight);\r\n      rightBoundary += preload * (viewportWidth + paddingLeft + paddingRight);\r\n\r\n      const insideCurrentInterval = slide.left + slide.width > leftBoundary && slide.left < rightBoundary;\r\n\r\n      // #2 - infinite items inside current viewport; from previous interval\r\n      leftBoundary = currentX + contentWidth - paddingLeft;\r\n      rightBoundary = currentX + contentWidth + viewportWidth + paddingRight;\r\n\r\n      // Include slides that have to be preloaded\r\n      leftBoundary -= preload * (viewportWidth + paddingLeft + paddingRight);\r\n\r\n      const insidePrevInterval = infinite && slide.left + slide.width > leftBoundary && slide.left < rightBoundary;\r\n\r\n      // #2 - infinite items inside current viewport; from next interval\r\n      leftBoundary = currentX - contentWidth - paddingLeft;\r\n      rightBoundary = currentX - contentWidth + viewportWidth + paddingRight;\r\n\r\n      // Include slides that have to be preloaded\r\n      leftBoundary -= preload * (viewportWidth + paddingLeft + paddingRight);\r\n\r\n      const insideNextInterval = infinite && slide.left + slide.width > leftBoundary && slide.left < rightBoundary;\r\n\r\n      // Create virtual slides that should be visible or preloaded, remove others\r\n      if (insidePrevInterval || insideCurrentInterval || insideNextInterval) {\r\n        this.createSlideEl(slide);\r\n\r\n        if (insideCurrentInterval) {\r\n          hasDiff = 0;\r\n        }\r\n\r\n        if (insidePrevInterval) {\r\n          hasDiff = -1;\r\n        }\r\n\r\n        if (insideNextInterval) {\r\n          hasDiff = 1;\r\n        }\r\n\r\n        // Bring preloaded slides back to viewport, if needed\r\n        if (slide.left + slide.width > currentX && slide.left <= currentX + viewportWidth + paddingRight) {\r\n          hasDiff = 0;\r\n        }\r\n      } else {\r\n        this.removeSlideEl(slide);\r\n      }\r\n\r\n      slide.hasDiff = hasDiff;\r\n    });\r\n\r\n    // Reposition slides for continuity\r\n    let nextIndex = 0;\r\n    let nextPos = 0;\r\n\r\n    this.slides.forEach((slide, index) => {\r\n      let updatedX = 0;\r\n\r\n      if (slide.$el) {\r\n        if (index !== nextIndex || slide.hasDiff) {\r\n          updatedX = nextPos + slide.hasDiff * contentWidth;\r\n        } else {\r\n          nextPos = 0;\r\n        }\r\n\r\n        slide.$el.style.left = Math.abs(updatedX) > 0.1 ? `${nextPos + slide.hasDiff * contentWidth}px` : \"\";\r\n\r\n        nextIndex++;\r\n      } else {\r\n        nextPos += slide.width;\r\n      }\r\n    });\r\n\r\n    this.markSelectedSlides();\r\n  }\r\n\r\n  /**\r\n   * Creates main DOM element for virtual slides,\r\n   * lazy loads images inside regular slides\r\n   * @param {Object} slide\r\n   */\r\n  createSlideEl(slide) {\r\n    if (!slide) {\r\n      return;\r\n    }\r\n\r\n    if (slide.$el) {\r\n      let curentIndex = slide.$el.dataset.index;\r\n\r\n      if (!curentIndex || parseInt(curentIndex, 10) !== slide.index) {\r\n        slide.$el.dataset.index = slide.index;\r\n\r\n        // Lazy load images\r\n        // ===\r\n        slide.$el.querySelectorAll(\"[data-lazy-srcset]\").forEach((node) => {\r\n          node.srcset = node.dataset.lazySrcset;\r\n        });\r\n\r\n        slide.$el.querySelectorAll(\"[data-lazy-src]\").forEach((node) => {\r\n          let lazySrc = node.dataset.lazySrc;\r\n\r\n          if (node instanceof HTMLImageElement) {\r\n            node.src = lazySrc;\r\n          } else {\r\n            node.style.backgroundImage = `url('${lazySrc}')`;\r\n          }\r\n        });\r\n\r\n        // Lazy load slide background image\r\n        // ===\r\n        let lazySrc;\r\n\r\n        if ((lazySrc = slide.$el.dataset.lazySrc)) {\r\n          slide.$el.style.backgroundImage = `url('${lazySrc}')`;\r\n        }\r\n\r\n        slide.state = \"ready\";\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    const div = document.createElement(\"div\");\r\n\r\n    div.dataset.index = slide.index;\r\n    div.classList.add(...(this.option(\"prefix\") + this.option(\"classNames.slide\")).split(\" \"));\r\n\r\n    if (slide.customClass) {\r\n      div.classList.add(...slide.customClass.split(\" \"));\r\n    }\r\n\r\n    if (slide.html) {\r\n      div.innerHTML = slide.html;\r\n    }\r\n\r\n    const allElelements = [];\r\n\r\n    this.slides.forEach((slide, index) => {\r\n      if (slide.$el) {\r\n        allElelements.push(index);\r\n      }\r\n    });\r\n\r\n    // Find a place in DOM to insert an element\r\n    const goal = slide.index;\r\n    let refSlide = null;\r\n\r\n    if (allElelements.length) {\r\n      let refIndex = allElelements.reduce((prev, curr) =>\r\n        Math.abs(curr - goal) < Math.abs(prev - goal) ? curr : prev\r\n      );\r\n      refSlide = this.slides[refIndex];\r\n    }\r\n\r\n    this.$track.insertBefore(\r\n      div,\r\n      refSlide && refSlide.$el ? (refSlide.index < slide.index ? refSlide.$el.nextSibling : refSlide.$el) : null\r\n    );\r\n\r\n    slide.$el = div;\r\n\r\n    this.trigger(\"createSlide\", slide, goal);\r\n\r\n    return slide;\r\n  }\r\n\r\n  /**\r\n   * Removes main DOM element of given slide\r\n   * @param {Object} slide\r\n   */\r\n  removeSlideEl(slide) {\r\n    if (slide.$el && !slide.isDom) {\r\n      this.trigger(\"removeSlide\", slide);\r\n\r\n      slide.$el.remove();\r\n      slide.$el = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Toggles selected class name and aria-hidden attribute for slides based on visibility\r\n   */\r\n  markSelectedSlides() {\r\n    const selectedClass = this.option(\"classNames.slideSelected\");\r\n    const attr = \"aria-hidden\";\r\n\r\n    this.slides.forEach((slide, index) => {\r\n      const $el = slide.$el;\r\n\r\n      if (!$el) {\r\n        return;\r\n      }\r\n\r\n      const page = this.pages[this.page];\r\n\r\n      if (page && page.indexes && page.indexes.indexOf(index) > -1) {\r\n        if (selectedClass && !$el.classList.contains(selectedClass)) {\r\n          $el.classList.add(selectedClass);\r\n          this.trigger(\"selectSlide\", slide);\r\n        }\r\n\r\n        $el.removeAttribute(attr);\r\n      } else {\r\n        if (selectedClass && $el.classList.contains(selectedClass)) {\r\n          $el.classList.remove(selectedClass);\r\n          this.trigger(\"unselectSlide\", slide);\r\n        }\r\n\r\n        $el.setAttribute(attr, true);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Perform all calculations and center current page\r\n   */\r\n  updatePage() {\r\n    this.updateMetrics();\r\n\r\n    this.slideTo(this.page, { friction: 0 });\r\n  }\r\n\r\n  /**\r\n   * Process `Panzoom.beforeTransform` event to remove slides moved out of viewport and\r\n   * to create necessary ones\r\n   */\r\n  onBeforeTransform() {\r\n    if (this.option(\"infiniteX\", this.option(\"infinite\"))) {\r\n      this.manageInfiniteTrack();\r\n    }\r\n\r\n    this.manageSlideVisiblity();\r\n  }\r\n\r\n  /**\r\n   * Seamlessly flip position of infinite carousel, if needed; this way x position stays low\r\n   */\r\n  manageInfiniteTrack() {\r\n    const contentWidth = this.contentWidth;\r\n    const viewportWidth = this.viewportWidth;\r\n\r\n    if (!this.option(\"infiniteX\", this.option(\"infinite\")) || this.pages.length < 2 || contentWidth < viewportWidth) {\r\n      return;\r\n    }\r\n\r\n    const panzoom = this.Panzoom;\r\n\r\n    let isFlipped = false;\r\n\r\n    if (panzoom.content.x < (contentWidth - viewportWidth) * -1) {\r\n      panzoom.content.x += contentWidth;\r\n\r\n      this.pageIndex = this.pageIndex - this.pages.length;\r\n\r\n      isFlipped = true;\r\n    }\r\n\r\n    if (panzoom.content.x > viewportWidth) {\r\n      panzoom.content.x -= contentWidth;\r\n\r\n      this.pageIndex = this.pageIndex + this.pages.length;\r\n\r\n      isFlipped = true;\r\n    }\r\n\r\n    if (isFlipped && panzoom.state === \"pointerdown\") {\r\n      panzoom.resetDragPosition();\r\n    }\r\n\r\n    return isFlipped;\r\n  }\r\n\r\n  /**\r\n   * Process `Panzoom.touchEnd` event; slide to next/prev page if needed\r\n   * @param {object} panzoom\r\n   */\r\n  onTouchEnd(panzoom, event) {\r\n    const dragFree = this.option(\"dragFree\");\r\n\r\n    // If this is a quick horizontal flick, slide to next/prev slide\r\n    if (\r\n      !dragFree &&\r\n      this.pages.length > 1 &&\r\n      panzoom.dragOffset.time < 350 &&\r\n      Math.abs(panzoom.dragOffset.y) < 1 &&\r\n      Math.abs(panzoom.dragOffset.x) > 5\r\n    ) {\r\n      this[panzoom.dragOffset.x < 0 ? \"slideNext\" : \"slidePrev\"]();\r\n      return;\r\n    }\r\n\r\n    // Set the slide at the end of the animation as the current one,\r\n    // or slide to closest page\r\n    if (dragFree) {\r\n      const [, nextPageIndex] = this.getPageFromPosition(panzoom.transform.x * -1);\r\n      this.setPage(nextPageIndex);\r\n    } else {\r\n      this.slideToClosest();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Slides to the closest page (useful, if carousel is changed manually)\r\n   * @param {Object} [params] - Object containing additional options\r\n   */\r\n  slideToClosest(params = {}) {\r\n    let [, nextPageIndex] = this.getPageFromPosition(this.Panzoom.content.x * -1);\r\n\r\n    this.slideTo(nextPageIndex, params);\r\n  }\r\n\r\n  /**\r\n   * Returns index of closest page to given x position\r\n   * @param {Number} xPos\r\n   */\r\n  getPageFromPosition(xPos) {\r\n    const pageCount = this.pages.length;\r\n    const center = this.option(\"center\");\r\n\r\n    if (center) {\r\n      xPos += this.viewportWidth * 0.5;\r\n    }\r\n\r\n    const interval = Math.floor(xPos / this.contentWidth);\r\n\r\n    xPos -= interval * this.contentWidth;\r\n\r\n    let slide = this.slides.find((slide) => slide.left <= xPos && slide.left + slide.width > xPos);\r\n\r\n    if (slide) {\r\n      let pageIndex = this.findPageForSlide(slide.index);\r\n\r\n      return [pageIndex, pageIndex + interval * pageCount];\r\n    }\r\n\r\n    return [0, 0];\r\n  }\r\n\r\n  /**\r\n   * Changes active page\r\n   * @param {Number} page - New index of active page\r\n   * @param {Boolean} toClosest - to closest page based on scroll distance (for infinite navigation)\r\n   */\r\n  setPage(page, toClosest) {\r\n    let nextPosition = 0;\r\n    let pageIndex = parseInt(page, 10) || 0;\r\n\r\n    const prevPage = this.page,\r\n      prevPageIndex = this.pageIndex,\r\n      pageCount = this.pages.length;\r\n\r\n    const contentWidth = this.contentWidth;\r\n    const viewportWidth = this.viewportWidth;\r\n\r\n    page = ((pageIndex % pageCount) + pageCount) % pageCount;\r\n\r\n    if (this.option(\"infiniteX\", this.option(\"infinite\")) && contentWidth > viewportWidth) {\r\n      const nextInterval = Math.floor(pageIndex / pageCount) || 0,\r\n        elemDimWidth = contentWidth;\r\n\r\n      nextPosition = this.pages[page].left + nextInterval * elemDimWidth;\r\n\r\n      if (toClosest === true && pageCount > 2) {\r\n        let currPosition = this.Panzoom.content.x * -1;\r\n\r\n        // * Find closest interval\r\n        const decreasedPosition = nextPosition - elemDimWidth,\r\n          increasedPosition = nextPosition + elemDimWidth,\r\n          diff1 = Math.abs(currPosition - nextPosition),\r\n          diff2 = Math.abs(currPosition - decreasedPosition),\r\n          diff3 = Math.abs(currPosition - increasedPosition);\r\n\r\n        if (diff3 < diff1 && diff3 <= diff2) {\r\n          nextPosition = increasedPosition;\r\n          pageIndex += pageCount;\r\n        } else if (diff2 < diff1 && diff2 < diff3) {\r\n          nextPosition = decreasedPosition;\r\n          pageIndex -= pageCount;\r\n        }\r\n      }\r\n    } else {\r\n      page = pageIndex = Math.max(0, Math.min(pageIndex, pageCount - 1));\r\n\r\n      nextPosition = this.pages.length ? this.pages[page].left : 0;\r\n    }\r\n\r\n    this.page = page;\r\n    this.pageIndex = pageIndex;\r\n\r\n    if (prevPage !== null && page !== prevPage) {\r\n      this.prevPage = prevPage;\r\n      this.prevPageIndex = prevPageIndex;\r\n\r\n      this.trigger(\"change\", page, prevPage);\r\n    }\r\n\r\n    return nextPosition;\r\n  }\r\n\r\n  /**\r\n   * Clean up\r\n   */\r\n  destroy() {\r\n    this.state = \"destroy\";\r\n\r\n    this.slides.forEach((slide) => {\r\n      this.removeSlideEl(slide);\r\n    });\r\n\r\n    this.slides = [];\r\n\r\n    this.Panzoom.destroy();\r\n\r\n    this.detachPlugins();\r\n  }\r\n}\r\n\r\n// Expose version\r\nCarousel.version = \"__VERSION__\";\r\n\r\n// Static properties are a recent addition that dont work in all browsers yet\r\nCarousel.Plugins = Plugins;\r\n","export default {\r\n  NEXT: \"Next slide\",\r\n  PREV: \"Previous slide\",\r\n  GOTO: \"Go to slide #%d\",\r\n};\r\n","const defaults = {\n  // The minimum number of slides to display dots\n  minSlideCount: 2,\n};\n\nexport class Dots {\n  constructor(carousel) {\n    this.carousel = carousel;\n\n    this.$list = null;\n\n    this.events = {\n      change: this.onChange.bind(this),\n      refresh: this.onRefresh.bind(this),\n    };\n  }\n\n  /**\n   * Build wrapping DOM element containing all dots\n   */\n  buildList() {\n    if (this.carousel.pages.length < this.carousel.option(\"Dots.minSlideCount\")) {\n      return;\n    }\n\n    const $list = document.createElement(\"ol\");\n\n    $list.classList.add(\"carousel__dots\");\n\n    $list.addEventListener(\"click\", (e) => {\n      if (!(\"page\" in e.target.dataset)) {\n        return;\n      }\n\n      e.preventDefault();\n      e.stopPropagation();\n\n      const page = parseInt(e.target.dataset.page, 10);\n      const carousel = this.carousel;\n\n      if (page === carousel.page) {\n        return;\n      }\n\n      if (carousel.pages.length < 3 && carousel.option(\"infinite\")) {\n        carousel[page == 0 ? \"slidePrev\" : \"slideNext\"]();\n      } else {\n        carousel.slideTo(page);\n      }\n    });\n\n    this.$list = $list;\n\n    this.carousel.$container.appendChild($list);\n    this.carousel.$container.classList.add(\"has-dots\");\n\n    return $list;\n  }\n\n  /**\n   * Remove wrapping DOM element\n   */\n  removeList() {\n    if (this.$list) {\n      this.$list.parentNode.removeChild(this.$list);\n      this.$list = null;\n    }\n\n    this.carousel.$container.classList.remove(\"has-dots\");\n  }\n\n  /**\n   * Remove existing dots and create fresh ones\n   */\n  rebuildDots() {\n    let $list = this.$list;\n\n    const listExists = !!$list;\n    const pagesCount = this.carousel.pages.length;\n\n    if (pagesCount < 2) {\n      if (listExists) {\n        this.removeList();\n      }\n\n      return;\n    }\n\n    if (!listExists) {\n      $list = this.buildList();\n    }\n\n    // Remove existing dots\n    const dotCount = this.$list.children.length;\n\n    if (dotCount > pagesCount) {\n      for (let i = pagesCount; i < dotCount; i++) {\n        this.$list.removeChild(this.$list.lastChild);\n      }\n\n      return;\n    }\n\n    // Create fresh DOM elements (dots) for each page\n    for (let index = dotCount; index < pagesCount; index++) {\n      const $dot = document.createElement(\"li\");\n\n      $dot.classList.add(\"carousel__dot\");\n      $dot.dataset.page = index;\n\n      $dot.setAttribute(\"role\", \"button\");\n      $dot.setAttribute(\"tabindex\", \"0\");\n      $dot.setAttribute(\"title\", this.carousel.localize(\"{{GOTO}}\", [[\"%d\", index + 1]]));\n\n      $dot.addEventListener(\"keydown\", (event) => {\n        const code = event.code;\n\n        let $el;\n\n        if (code === \"Enter\" || code === \"NumpadEnter\") {\n          $el = $dot;\n        } else if (code === \"ArrowRight\") {\n          $el = $dot.nextSibling;\n        } else if (code === \"ArrowLeft\") {\n          $el = $dot.previousSibling;\n        }\n\n        $el && $el.click();\n      });\n\n      this.$list.appendChild($dot);\n    }\n\n    this.setActiveDot();\n  }\n\n  /**\n   * Mark active dot by toggling class name\n   */\n  setActiveDot() {\n    if (!this.$list) {\n      return;\n    }\n\n    this.$list.childNodes.forEach(($dot) => {\n      $dot.classList.remove(\"is-selected\");\n    });\n\n    const $activeDot = this.$list.childNodes[this.carousel.page];\n\n    if ($activeDot) {\n      $activeDot.classList.add(\"is-selected\");\n    }\n  }\n\n  /**\n   * Process carousel `change` event\n   */\n  onChange() {\n    this.setActiveDot();\n  }\n\n  /**\n   * Process carousel `refresh` event\n   */\n  onRefresh() {\n    this.rebuildDots();\n  }\n\n  attach() {\n    this.carousel.on(this.events);\n  }\n\n  detach() {\n    this.removeList();\n\n    this.carousel.off(this.events);\n    this.carousel = null;\n  }\n}\n","const defaults = {\n  prevTpl: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" tabindex=\"-1\"><path d=\"M15 3l-9 9 9 9\"/></svg>',\n  nextTpl: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" tabindex=\"-1\"><path d=\"M9 3l9 9-9 9\"/></svg>',\n\n  classNames: {\n    main: \"carousel__nav\",\n    button: \"carousel__button\",\n\n    next: \"is-next\",\n    prev: \"is-prev\",\n  },\n};\n\nexport class Navigation {\n  constructor(carousel) {\n    this.$container = null;\n\n    this.$prev = null;\n    this.$next = null;\n\n    this.carousel = carousel;\n\n    this.onRefresh = this.onRefresh.bind(this);\n  }\n\n  /**\n   * Shortcut to get option for this plugin\n   * @param {String} name option name\n   * @returns option value\n   */\n  option(name) {\n    return this.carousel.option(`Navigation.${name}`);\n  }\n\n  /**\n   * Creates and returns new button element with default class names and click event\n   * @param {String} type\n   */\n  createButton(type) {\n    const $btn = document.createElement(\"button\");\n\n    $btn.setAttribute(\"title\", this.carousel.localize(`{{${type.toUpperCase()}}}`));\n\n    const classNames = this.option(\"classNames.button\") + \" \" + this.option(`classNames.${type}`);\n\n    $btn.classList.add(...classNames.split(\" \"));\n    $btn.setAttribute(\"tabindex\", \"0\");\n    $btn.innerHTML = this.carousel.localize(this.option(`${type}Tpl`));\n\n    $btn.addEventListener(\"click\", (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this.carousel[`slide${type === \"next\" ? \"Next\" : \"Prev\"}`]();\n    });\n\n    return $btn;\n  }\n\n  /**\n   * Build necessary DOM elements\n   */\n  build() {\n    if (!this.$container) {\n      this.$container = document.createElement(\"div\");\n      this.$container.classList.add(...this.option(\"classNames.main\").split(\" \"));\n\n      this.carousel.$container.appendChild(this.$container);\n    }\n\n    if (!this.$next) {\n      this.$next = this.createButton(\"next\");\n\n      this.$container.appendChild(this.$next);\n    }\n\n    if (!this.$prev) {\n      this.$prev = this.createButton(\"prev\");\n\n      this.$container.appendChild(this.$prev);\n    }\n  }\n\n  /**\n   *  Process carousel `refresh` and `change` events to enable/disable buttons if needed\n   */\n  onRefresh() {\n    const pageCount = this.carousel.pages.length;\n\n    if (\n      pageCount <= 1 ||\n      (pageCount > 1 &&\n        this.carousel.elemDimWidth < this.carousel.wrapDimWidth &&\n        !Number.isInteger(this.carousel.option(\"slidesPerPage\")))\n    ) {\n      this.cleanup();\n\n      return;\n    }\n\n    this.build();\n\n    this.$prev.removeAttribute(\"disabled\");\n    this.$next.removeAttribute(\"disabled\");\n\n    if (this.carousel.option(\"infiniteX\", this.carousel.option(\"infinite\"))) {\n      return;\n    }\n\n    if (this.carousel.page <= 0) {\n      this.$prev.setAttribute(\"disabled\", \"\");\n    }\n\n    if (this.carousel.page >= pageCount - 1) {\n      this.$next.setAttribute(\"disabled\", \"\");\n    }\n  }\n\n  cleanup() {\n    if (this.$prev) {\n      this.$prev.remove();\n    }\n\n    this.$prev = null;\n\n    if (this.$next) {\n      this.$next.remove();\n    }\n\n    this.$next = null;\n\n    if (this.$container) {\n      this.$container.remove();\n    }\n\n    this.$container = null;\n  }\n\n  attach() {\n    this.carousel.on(\"refresh change\", this.onRefresh);\n  }\n\n  detach() {\n    this.carousel.off(\"refresh change\", this.onRefresh);\n\n    this.cleanup();\n  }\n}\n\n// Expose defaults\nNavigation.defaults = defaults;\n","const defaults = {\n  friction: 0.92,\n};\n\nexport class Sync {\n  constructor(carousel) {\n    this.carousel = carousel;\n\n    this.selectedIndex = null;\n    this.friction = 0;\n\n    this.onNavReady = this.onNavReady.bind(this);\n    this.onNavClick = this.onNavClick.bind(this);\n    this.onNavCreateSlide = this.onNavCreateSlide.bind(this);\n\n    this.onTargetChange = this.onTargetChange.bind(this);\n  }\n\n  /**\n   * Make this one as main carousel and selected carousel as navigation\n   * @param {Object} nav Carousel\n   */\n  addAsTargetFor(nav) {\n    this.target = this.carousel;\n    this.nav = nav;\n\n    this.attachEvents();\n  }\n\n  /**\n   * Make this one as navigation carousel for selected carousel\n   * @param {Object} target\n   */\n  addAsNavFor(target) {\n    this.target = target;\n    this.nav = this.carousel;\n\n    this.attachEvents();\n  }\n\n  /**\n   * Attach event listeners on both carousels\n   */\n  attachEvents() {\n    this.nav.options.initialSlide = this.target.options.initialPage;\n\n    this.nav.on(\"ready\", this.onNavReady);\n    this.nav.on(\"createSlide\", this.onNavCreateSlide);\n    this.nav.on(\"Panzoom.click\", this.onNavClick);\n\n    this.target.on(\"change\", this.onTargetChange);\n    this.target.on(\"Panzoom.afterUpdate\", this.onTargetChange);\n  }\n\n  /**\n   * Process main carousel `ready` event; bind events and set initial page\n   */\n  onNavReady() {\n    this.onTargetChange(true);\n  }\n\n  /**\n   * Process main carousel `click` event\n   * @param {Object} panzoom\n   * @param {Object} event\n   */\n  onNavClick(carousel, panzoom, event) {\n    const clickedNavSlide = event.target.closest(\".carousel__slide\");\n\n    if (!clickedNavSlide) {\n      return;\n    }\n\n    event.stopPropagation();\n\n    const selectedNavIndex = parseInt(clickedNavSlide.dataset.index, 10);\n    const selectedSyncPage = this.target.findPageForSlide(selectedNavIndex);\n\n    if (this.target.page !== selectedSyncPage) {\n      this.target.slideTo(selectedSyncPage, { friction: this.friction });\n    }\n\n    this.markSelectedSlide(selectedNavIndex);\n  }\n\n  /**\n   * Process main carousel `createSlide` event\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  onNavCreateSlide(carousel, slide) {\n    if (slide.index === this.selectedIndex) {\n      this.markSelectedSlide(slide.index);\n    }\n  }\n\n  /**\n   * Process target carousel `change` event\n   * @param {Object} target\n   */\n  onTargetChange() {\n    const targetIndex = this.target.pages[this.target.page].indexes[0];\n    const selectedNavPage = this.nav.findPageForSlide(targetIndex);\n\n    this.nav.slideTo(selectedNavPage);\n\n    this.markSelectedSlide(targetIndex);\n  }\n\n  /**\n   * Toggle classname for slides that marks currently selected slides\n   * @param {Number} selectedIndex\n   */\n  markSelectedSlide(selectedIndex) {\n    this.selectedIndex = selectedIndex;\n\n    [...this.nav.slides].filter((slide) => slide.$el && slide.$el.classList.remove(\"is-nav-selected\"));\n\n    const slide = this.nav.slides[selectedIndex];\n\n    if (slide && slide.$el) slide.$el.classList.add(\"is-nav-selected\");\n  }\n\n  attach(carousel) {\n    const sync = carousel.options.Sync;\n\n    if (!sync.target && !sync.nav) {\n      return;\n    }\n\n    if (sync.target) {\n      this.addAsNavFor(sync.target);\n    } else if (sync.nav) {\n      this.addAsTargetFor(sync.nav);\n    }\n\n    this.friction = sync.friction;\n  }\n\n  detach() {\n    if (this.nav) {\n      this.nav.off(\"ready\", this.onNavReady);\n      this.nav.off(\"Panzoom.click\", this.onNavClick);\n      this.nav.off(\"createSlide\", this.onNavCreateSlide);\n    }\n\n    if (this.target) {\n      this.target.off(\"Panzoom.afterUpdate\", this.onTargetChange);\n      this.target.off(\"change\", this.onTargetChange);\n    }\n  }\n}\n\n// Expose defaults\nSync.defaults = defaults;\n","import { Navigation } from \"./Navigation/Navigation.js\";\nimport { Dots } from \"./Dots/Dots.js\";\nimport { Sync } from \"./Sync/Sync.js\";\n\nexport const Plugins = { Navigation, Dots, Sync };\n","import { extend } from \"../shared/utils/extend.js\";\nimport { canUseDOM } from \"../shared/utils/canUseDOM.js\";\nimport { FOCUSABLE_ELEMENTS, setFocusOn } from \"../shared/utils/setFocusOn.js\";\n\nimport { Base } from \"../shared/Base/Base.js\";\n\nimport { Carousel } from \"../Carousel/Carousel.js\";\n\nimport { Plugins } from \"./plugins/index.js\";\n\n// Default language\nimport en from \"./l10n/en.js\";\n\n// Default settings\nconst defaults = {\n  // Index of active slide on the start\n  startIndex: 0,\n\n  // Number of slides to preload before and after active slide\n  preload: 1,\n\n  // Should navigation be infinite\n  infinite: true,\n\n  // Class name to be applied to the content to reveal it\n  showClass: \"fancybox-zoomInUp\", // \"fancybox-fadeIn\" | \"fancybox-zoomInUp\" | false\n\n  // Class name to be applied to the content to hide it\n  hideClass: \"fancybox-fadeOut\", // \"fancybox-fadeOut\" | \"fancybox-zoomOutDown\" | false\n\n  // Should backdrop and UI elements fade in/out on start/close\n  animated: true,\n\n  // If browser scrollbar should be hidden\n  hideScrollbar: true,\n\n  // Element containing main structure\n  parentEl: null,\n\n  // Custom class name or multiple space-separated class names for the container\n  mainClass: null,\n\n  // Set focus on first focusable element after displaying content\n  autoFocus: true,\n\n  // Trap focus inside Fancybox\n  trapFocus: true,\n\n  // Set focus back to trigger element after closing Fancybox\n  placeFocusBack: true,\n\n  // Action to take when the user clicks on the backdrop\n  click: \"close\", // \"close\" | \"next\" | null\n\n  // Position of the close button - over the content or at top right corner of viewport\n  closeButton: \"inside\", // \"inside\" | \"outside\"\n\n  // Allow user to drag content up/down to close instance\n  dragToClose: true,\n\n  // Enable keyboard navigation\n  keyboard: {\n    Escape: \"close\",\n    Delete: \"close\",\n    Backspace: \"close\",\n    PageUp: \"next\",\n    PageDown: \"prev\",\n    ArrowUp: \"next\",\n    ArrowDown: \"prev\",\n    ArrowRight: \"next\",\n    ArrowLeft: \"prev\",\n  },\n\n  // HTML templates for various elements\n  template: {\n    // Close button icon\n    closeButton:\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" tabindex=\"-1\"><path d=\"M20 20L4 4m16 0L4 20\"/></svg>',\n    // Loading indicator icon\n    spinner:\n      '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"50\" height=\"50\" viewBox=\"25 25 50 50\" tabindex=\"-1\"><circle cx=\"50\" cy=\"50\" r=\"20\"/></svg>',\n\n    // Main container element\n    main: null,\n  },\n\n  /* Note: If the `template.main` option is not provided, the structure is generated as follows by default:\n  <div class=\"fancybox__container\" role=\"dialog\" aria-modal=\"true\" aria-hidden=\"true\" aria-label=\"{{MODAL}}\" tabindex=\"-1\">\n    <div class=\"fancybox__backdrop\"></div>\n    <div class=\"fancybox__carousel\"></div>\n  </div>\n  */\n\n  // Localization of strings\n  l10n: en,\n};\n\n// Object that contains all active instances of Fancybox\nconst instances = new Map();\n\n// Number of Fancybox instances created, it is used to generate new instance \"id\"\nlet called = 0;\n\nclass Fancybox extends Base {\n  /**\n   * Fancybox constructor\n   * @constructs Fancybox\n   * @param {Object} [options] - Options for Fancybox\n   */\n  constructor(items, options = {}) {\n    // Quick hack to fix variable naming collision\n    items = items.map((item) => {\n      if (item.width) item._width = item.width;\n      if (item.height) item._height = item.height;\n\n      return item;\n    });\n\n    super(extend(true, {}, defaults, options));\n\n    this.bindHandlers();\n\n    this.state = \"init\";\n\n    this.setItems(items);\n\n    this.attachPlugins(Fancybox.Plugins);\n\n    // \"init\" event marks the start of initialization and is available to plugins\n    this.trigger(\"init\");\n\n    if (this.option(\"hideScrollbar\") === true) {\n      this.hideScrollbar();\n    }\n\n    this.initLayout();\n\n    this.initCarousel();\n\n    this.attachEvents();\n\n    instances.set(this.id, this);\n\n    // \"prepare\" event will trigger the creation of additional layout elements, such as thumbnails and toolbar\n    this.trigger(\"prepare\");\n\n    this.state = \"ready\";\n\n    // \"ready\" event will trigger the content to load\n    this.trigger(\"ready\");\n\n    // Reveal container\n    this.$container.setAttribute(\"aria-hidden\", \"false\");\n\n    // Set focus on the first focusable element inside this instance\n    if (this.option(\"trapFocus\")) {\n      this.focus();\n    }\n  }\n\n  /**\n   * Override `option` method to get value from the current slide\n   * @param {String} name option name\n   * @param  {...any} rest optional extra parameters\n   * @returns {any}\n   */\n  option(name, ...rest) {\n    const slide = this.getSlide();\n\n    let value = slide ? slide[name] : undefined;\n\n    if (value !== undefined) {\n      if (typeof value === \"function\") {\n        value = value.call(this, this, ...rest);\n      }\n\n      return value;\n    }\n\n    return super.option(name, ...rest);\n  }\n\n  /**\n   * Bind event handlers for referencability\n   */\n  bindHandlers() {\n    for (const methodName of [\n      \"onMousedown\",\n      \"onKeydown\",\n      \"onClick\",\n\n      \"onFocus\",\n\n      \"onCreateSlide\",\n      \"onSettle\",\n\n      \"onTouchMove\",\n      \"onTouchEnd\",\n\n      \"onTransform\",\n    ]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n  }\n\n  /**\n   * Set up a functions that will be called whenever the specified event is delivered\n   */\n  attachEvents() {\n    document.addEventListener(\"mousedown\", this.onMousedown);\n    document.addEventListener(\"keydown\", this.onKeydown, true);\n\n    // Trap keyboard focus inside of the modal\n    if (this.option(\"trapFocus\")) {\n      document.addEventListener(\"focus\", this.onFocus, true);\n    }\n\n    this.$container.addEventListener(\"click\", this.onClick);\n  }\n\n  /**\n   * Removes previously registered event listeners\n   */\n  detachEvents() {\n    document.removeEventListener(\"mousedown\", this.onMousedown);\n    document.removeEventListener(\"keydown\", this.onKeydown, true);\n\n    document.removeEventListener(\"focus\", this.onFocus, true);\n\n    this.$container.removeEventListener(\"click\", this.onClick);\n  }\n\n  /**\n   * Initialize layout; create main container, backdrop nd layout for main carousel\n   */\n  initLayout() {\n    this.$root = this.option(\"parentEl\") || document.body;\n\n    // Container\n    let mainTemplate = this.option(\"template.main\");\n\n    if (mainTemplate) {\n      this.$root.insertAdjacentHTML(\"beforeend\", this.localize(mainTemplate));\n\n      this.$container = this.$root.querySelector(\".fancybox__container\");\n    }\n\n    if (!this.$container) {\n      this.$container = document.createElement(\"div\");\n      this.$root.appendChild(this.$container);\n    }\n\n    // Normally we would not need this, but Safari does not support `preventScroll:false` option for `focus` method\n    // and that causes layout issues\n    this.$container.onscroll = () => {\n      this.$container.scrollLeft = 0;\n      return false;\n    };\n\n    Object.entries({\n      class: \"fancybox__container\",\n      role: \"dialog\",\n      tabIndex: \"-1\",\n      \"aria-modal\": \"true\",\n      \"aria-hidden\": \"true\",\n      \"aria-label\": this.localize(\"{{MODAL}}\"),\n    }).forEach((args) => this.$container.setAttribute(...args));\n\n    if (this.option(\"animated\")) {\n      this.$container.classList.add(\"is-animated\");\n    }\n\n    // Backdrop\n    this.$backdrop = this.$container.querySelector(\".fancybox__backdrop\");\n\n    if (!this.$backdrop) {\n      this.$backdrop = document.createElement(\"div\");\n      this.$backdrop.classList.add(\"fancybox__backdrop\");\n\n      this.$container.appendChild(this.$backdrop);\n    }\n\n    // Carousel\n    this.$carousel = this.$container.querySelector(\".fancybox__carousel\");\n\n    if (!this.$carousel) {\n      this.$carousel = document.createElement(\"div\");\n      this.$carousel.classList.add(\"fancybox__carousel\");\n\n      this.$container.appendChild(this.$carousel);\n    }\n\n    // Make instance reference accessible\n    this.$container.Fancybox = this;\n\n    // Make sure the container has an ID\n    this.id = this.$container.getAttribute(\"id\");\n\n    if (!this.id) {\n      this.id = this.options.id || ++called;\n      this.$container.setAttribute(\"id\", \"fancybox-\" + this.id);\n    }\n\n    // Add custom class name to main element\n    const mainClass = this.option(\"mainClass\");\n\n    if (mainClass) {\n      this.$container.classList.add(...mainClass.split(\" \"));\n    }\n\n    // Add class name for <html> element\n    document.documentElement.classList.add(\"with-fancybox\");\n\n    this.trigger(\"initLayout\");\n\n    return this;\n  }\n\n  /**\n   * Prepares slides for the corousel\n   * @returns {Array} Slides\n   */\n  setItems(items) {\n    const slides = [];\n\n    for (const slide of items) {\n      const $trigger = slide.$trigger;\n\n      if ($trigger) {\n        const dataset = $trigger.dataset || {};\n\n        slide.src = dataset.src || $trigger.getAttribute(\"href\") || slide.src;\n        slide.type = dataset.type || slide.type;\n\n        // Support items without `src`, e.g., when `data-fancybox` attribute added directly to `<img>` element\n        if (!slide.src && $trigger instanceof HTMLImageElement) {\n          slide.src = $trigger.currentSrc || slide.$trigger.src;\n        }\n      }\n\n      // Check for thumbnail element\n      let $thumb = slide.$thumb;\n\n      if (!$thumb) {\n        let origTarget = slide.$trigger && slide.$trigger.origTarget;\n\n        if (origTarget) {\n          if (origTarget instanceof HTMLImageElement) {\n            $thumb = origTarget;\n          } else {\n            $thumb = origTarget.querySelector(\"img:not([aria-hidden])\");\n          }\n        }\n\n        if (!$thumb && slide.$trigger) {\n          $thumb =\n            slide.$trigger instanceof HTMLImageElement\n              ? slide.$trigger\n              : slide.$trigger.querySelector(\"img:not([aria-hidden])\");\n        }\n      }\n\n      slide.$thumb = $thumb || null;\n\n      // Get thumbnail image source\n      let thumb = slide.thumb;\n\n      if (!thumb && $thumb) {\n        thumb = $thumb.currentSrc || $thumb.src;\n\n        if (!thumb && $thumb.dataset) {\n          thumb = $thumb.dataset.lazySrc || $thumb.dataset.src;\n        }\n      }\n\n      // Assume we have image, then use it as thumbnail\n      if (!thumb && slide.type === \"image\") {\n        thumb = slide.src;\n      }\n\n      slide.thumb = thumb || null;\n\n      // Add empty caption to make things simpler\n      slide.caption = slide.caption || \"\";\n\n      slides.push(slide);\n    }\n\n    this.items = slides;\n  }\n\n  /**\n   * Initialize main Carousel that will be used to display the content\n   * @param {Array} slides\n   */\n  initCarousel() {\n    this.Carousel = new Carousel(\n      this.$carousel,\n      extend(\n        true,\n        {},\n        {\n          prefix: \"\",\n\n          classNames: {\n            viewport: \"fancybox__viewport\",\n            track: \"fancybox__track\",\n            slide: \"fancybox__slide\",\n          },\n\n          textSelection: true,\n          preload: this.option(\"preload\"),\n\n          friction: 0.88,\n\n          slides: this.items,\n          initialPage: this.options.startIndex,\n          slidesPerPage: 1,\n\n          infiniteX: this.option(\"infinite\"),\n          infiniteY: true,\n\n          l10n: this.option(\"l10n\"),\n\n          Dots: false,\n          Navigation: {\n            classNames: {\n              main: \"fancybox__nav\",\n              button: \"carousel__button\",\n\n              next: \"is-next\",\n              prev: \"is-prev\",\n            },\n          },\n\n          Panzoom: {\n            textSelection: true,\n\n            panOnlyZoomed: () => {\n              return (\n                this.Carousel && this.Carousel.pages && this.Carousel.pages.length < 2 && !this.option(\"dragToClose\")\n              );\n            },\n\n            lockAxis: () => {\n              if (this.Carousel) {\n                let rez = \"x\";\n\n                if (this.option(\"dragToClose\")) {\n                  rez += \"y\";\n                }\n\n                return rez;\n              }\n            },\n          },\n\n          on: {\n            \"*\": (name, ...details) => this.trigger(`Carousel.${name}`, ...details),\n            init: (carousel) => (this.Carousel = carousel),\n            createSlide: this.onCreateSlide,\n            settle: this.onSettle,\n          },\n        },\n\n        this.option(\"Carousel\")\n      )\n    );\n\n    if (this.option(\"dragToClose\")) {\n      this.Carousel.Panzoom.on({\n        // Stop further touch event handling if content is scaled\n        touchMove: this.onTouchMove,\n\n        // Update backdrop opacity depending on vertical distance\n        afterTransform: this.onTransform,\n\n        // Close instance if drag distance exceeds limit\n        touchEnd: this.onTouchEnd,\n      });\n    }\n\n    this.trigger(\"initCarousel\");\n\n    return this;\n  }\n\n  /**\n   * Process `createSlide` event to create caption element inside new slide\n   */\n  onCreateSlide(carousel, slide) {\n    let caption = slide.caption || \"\";\n\n    if (typeof this.options.caption === \"function\") {\n      caption = this.options.caption.call(this, this, this.Carousel, slide);\n    }\n\n    if (typeof caption === \"string\" && caption.length) {\n      const $caption = document.createElement(\"div\");\n      const id = `fancybox__caption_${this.id}_${slide.index}`;\n\n      $caption.className = \"fancybox__caption\";\n      $caption.innerHTML = caption;\n      $caption.setAttribute(\"id\", id);\n\n      slide.$caption = slide.$el.appendChild($caption);\n\n      slide.$el.classList.add(\"has-caption\");\n      slide.$el.setAttribute(\"aria-labelledby\", id);\n    }\n  }\n\n  /**\n   * Handle Carousel `settle` event\n   */\n  onSettle() {\n    if (this.option(\"autoFocus\")) {\n      this.focus();\n    }\n  }\n\n  /**\n   * Handle focus event\n   * @param {Event} event - Focus event\n   */\n  onFocus(event) {\n    this.focus(event);\n  }\n\n  /**\n   * Handle click event on the container\n   * @param {Event} event - Click event\n   */\n  onClick(event) {\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    let eventTarget = event.composedPath()[0];\n\n    if (eventTarget.matches(\"[data-fancybox-close]\")) {\n      event.preventDefault();\n      Fancybox.close(false, event);\n\n      return;\n    }\n\n    if (eventTarget.matches(\"[data-fancybox-next]\")) {\n      event.preventDefault();\n      Fancybox.next();\n\n      return;\n    }\n\n    if (eventTarget.matches(\"[data-fancybox-prev]\")) {\n      event.preventDefault();\n      Fancybox.prev();\n\n      return;\n    }\n\n    const activeElement = document.activeElement;\n\n    if (activeElement) {\n      if (activeElement.closest(\"[contenteditable]\")) {\n        return;\n      }\n\n      if (!eventTarget.matches(FOCUSABLE_ELEMENTS)) {\n        activeElement.blur();\n      }\n    }\n\n    // Skip if clicked inside content area\n    if (eventTarget.closest(\".fancybox__content\")) {\n      return;\n    }\n\n    // Skip if text is selected\n    if (getSelection().toString().length) {\n      return;\n    }\n\n    if (this.trigger(\"click\", event) === false) {\n      return;\n    }\n\n    const action = this.option(\"click\");\n\n    switch (action) {\n      case \"close\":\n        this.close();\n        break;\n      case \"next\":\n        this.next();\n        break;\n    }\n  }\n\n  /**\n   * Handle panzoom `touchMove` event; Disable dragging if content of current slide is scaled\n   */\n  onTouchMove() {\n    const panzoom = this.getSlide().Panzoom;\n\n    return panzoom && panzoom.content.scale !== 1 ? false : true;\n  }\n\n  /**\n   * Handle panzoom `touchEnd` event; close when quick flick up/down is detected\n   * @param {Object} panzoom - Panzoom instance\n   */\n  onTouchEnd(panzoom) {\n    const distanceY = panzoom.dragOffset.y;\n\n    if (Math.abs(distanceY) >= 150 || (Math.abs(distanceY) >= 35 && panzoom.dragOffset.time < 350)) {\n      if (this.option(\"hideClass\")) {\n        this.getSlide().hideClass = `fancybox-throwOut${panzoom.content.y < 0 ? \"Up\" : \"Down\"}`;\n      }\n\n      this.close();\n    } else if (panzoom.lockAxis === \"y\") {\n      panzoom.panTo({ y: 0 });\n    }\n  }\n\n  /**\n   * Handle `afterTransform` event; change backdrop opacity based on current y position of panzoom\n   * @param {Object} panzoom - Panzoom instance\n   */\n  onTransform(panzoom) {\n    const $backdrop = this.$backdrop;\n\n    if ($backdrop) {\n      const yPos = Math.abs(panzoom.content.y);\n      const opacity = yPos < 1 ? \"\" : Math.max(0.33, Math.min(1, 1 - (yPos / panzoom.content.fitHeight) * 1.5));\n\n      this.$container.style.setProperty(\"--fancybox-ts\", opacity ? \"0s\" : \"\");\n      this.$container.style.setProperty(\"--fancybox-opacity\", opacity);\n    }\n  }\n\n  /**\n   * Handle `mousedown` event to mark that the mouse is in use\n   */\n  onMousedown() {\n    if (this.state === \"ready\") {\n      document.body.classList.add(\"is-using-mouse\");\n    }\n  }\n\n  /**\n   * Handle `keydown` event; trap focus\n   * @param {Event} event Keydown event\n   */\n  onKeydown(event) {\n    if (Fancybox.getInstance().id !== this.id) {\n      return;\n    }\n\n    document.body.classList.remove(\"is-using-mouse\");\n\n    const key = event.key;\n    const keyboard = this.option(\"keyboard\");\n\n    if (!keyboard || event.ctrlKey || event.altKey || event.shiftKey) {\n      return;\n    }\n\n    const target = event.composedPath()[0];\n\n    const classList = document.activeElement && document.activeElement.classList;\n    const isUIElement = classList && classList.contains(\"carousel__button\");\n\n    // Allow to close using Escape button\n    if (key !== \"Escape\" && !isUIElement) {\n      let ignoreElements =\n        event.target.isContentEditable ||\n        [\"BUTTON\", \"TEXTAREA\", \"OPTION\", \"INPUT\", \"SELECT\", \"VIDEO\"].indexOf(target.nodeName) !== -1;\n\n      if (ignoreElements) {\n        return;\n      }\n    }\n\n    if (this.trigger(\"keydown\", key, event) === false) {\n      return;\n    }\n\n    const action = keyboard[key];\n\n    if (typeof this[action] === \"function\") {\n      this[action]();\n    }\n  }\n\n  /**\n   * Get the active slide. This will be the first slide from the current page of the main carousel.\n   */\n  getSlide() {\n    const carousel = this.Carousel;\n\n    if (!carousel) return null;\n\n    const page = carousel.page === null ? carousel.option(\"initialPage\") : carousel.page;\n    const pages = carousel.pages || [];\n\n    if (pages.length && pages[page]) {\n      return pages[page].slides[0];\n    }\n\n    return null;\n  }\n\n  /**\n   * Place focus on the first focusable element inside current slide\n   * @param {Event} [event] - Focus event\n   */\n  focus(event) {\n    if (Fancybox.ignoreFocusChange) {\n      return;\n    }\n\n    if ([\"init\", \"closing\", \"customClosing\", \"destroy\"].indexOf(this.state) > -1) {\n      return;\n    }\n\n    const $container = this.$container;\n    const currentSlide = this.getSlide();\n    const $currentSlide = currentSlide.state === \"done\" ? currentSlide.$el : null;\n\n    // Skip if the DOM element that is currently in focus is already inside the current slide\n    if ($currentSlide && $currentSlide.contains(document.activeElement)) {\n      return;\n    }\n\n    if (event) {\n      event.preventDefault();\n    }\n\n    Fancybox.ignoreFocusChange = true;\n\n    const allFocusableElems = Array.from($container.querySelectorAll(FOCUSABLE_ELEMENTS));\n\n    let enabledElems = [];\n    let $firstEl;\n\n    for (let node of allFocusableElems) {\n      // Enable element if it's visible and\n      // is inside the current slide or is outside main carousel (for example, inside the toolbar)\n      const isNodeVisible = node.offsetParent;\n      const isNodeInsideCurrentSlide = $currentSlide && $currentSlide.contains(node);\n      const isNodeOutsideCarousel = !this.Carousel.$viewport.contains(node);\n\n      if (isNodeVisible && (isNodeInsideCurrentSlide || isNodeOutsideCarousel)) {\n        enabledElems.push(node);\n\n        if (node.dataset.origTabindex !== undefined) {\n          node.tabIndex = node.dataset.origTabindex;\n          node.removeAttribute(\"data-orig-tabindex\");\n        }\n\n        if (\n          node.hasAttribute(\"autoFocus\") ||\n          (!$firstEl && isNodeInsideCurrentSlide && !node.classList.contains(\"carousel__button\"))\n        ) {\n          $firstEl = node;\n        }\n      } else {\n        // Element is either hidden or is inside preloaded slide (e.g., not inside current slide, but next/prev)\n        node.dataset.origTabindex =\n          node.dataset.origTabindex === undefined ? node.getAttribute(\"tabindex\") : node.dataset.origTabindex;\n\n        node.tabIndex = -1;\n      }\n    }\n\n    if (!event) {\n      if (this.option(\"autoFocus\") && $firstEl) {\n        setFocusOn($firstEl);\n      } else if (enabledElems.indexOf(document.activeElement) < 0) {\n        setFocusOn($container);\n      }\n    } else {\n      if (enabledElems.indexOf(event.target) > -1) {\n        this.lastFocus = event.target;\n      } else {\n        if (this.lastFocus === $container) {\n          setFocusOn(enabledElems[enabledElems.length - 1]);\n        } else {\n          setFocusOn($container);\n        }\n      }\n    }\n\n    this.lastFocus = document.activeElement;\n\n    Fancybox.ignoreFocusChange = false;\n  }\n\n  /**\n   * Hide vertical page scrollbar and adjust right padding value of `body` element to prevent content from shifting\n   * (otherwise the `body` element may become wider and the content may expand horizontally).\n   */\n  hideScrollbar() {\n    if (!canUseDOM) {\n      return;\n    }\n\n    const scrollbarWidth = window.innerWidth - document.documentElement.getBoundingClientRect().width;\n    const id = \"fancybox-style-noscroll\";\n\n    let $style = document.getElementById(id);\n\n    if ($style) {\n      return;\n    }\n\n    if (scrollbarWidth > 0) {\n      $style = document.createElement(\"style\");\n\n      $style.id = id;\n      $style.type = \"text/css\";\n      $style.innerHTML = `.compensate-for-scrollbar {padding-right: ${scrollbarWidth}px;}`;\n\n      document.getElementsByTagName(\"head\")[0].appendChild($style);\n\n      document.body.classList.add(\"compensate-for-scrollbar\");\n    }\n  }\n\n  /**\n   * Stop hiding vertical page scrollbar\n   */\n  revealScrollbar() {\n    document.body.classList.remove(\"compensate-for-scrollbar\");\n\n    const el = document.getElementById(\"fancybox-style-noscroll\");\n\n    if (el) {\n      el.remove();\n    }\n  }\n\n  /**\n   * Remove content for given slide\n   * @param {Object} slide - Carousel slide\n   */\n  clearContent(slide) {\n    // * Clear previously added content and class name\n    this.Carousel.trigger(\"removeSlide\", slide);\n\n    if (slide.$content) {\n      slide.$content.remove();\n      slide.$content = null;\n    }\n\n    if (slide.$closeButton) {\n      slide.$closeButton.remove();\n      slide.$closeButton = null;\n    }\n\n    if (slide._className) {\n      slide.$el.classList.remove(slide._className);\n    }\n  }\n\n  /**\n   * Set new content for given slide\n   * @param {Object} slide - Carousel slide\n   * @param {HTMLElement|String} html - HTML element or string containing HTML code\n   * @param {Object} [opts] - Options\n   */\n  setContent(slide, html, opts = {}) {\n    let $content;\n\n    const $el = slide.$el;\n\n    if (html instanceof HTMLElement) {\n      if ([\"img\", \"iframe\", \"video\", \"audio\"].indexOf(html.nodeName.toLowerCase()) > -1) {\n        $content = document.createElement(\"div\");\n        $content.appendChild(html);\n      } else {\n        $content = html;\n      }\n    } else {\n      const $fragment = document.createRange().createContextualFragment(html);\n\n      $content = document.createElement(\"div\");\n      $content.appendChild($fragment);\n    }\n\n    if (slide.filter && !slide.error) {\n      $content = $content.querySelector(slide.filter);\n    }\n\n    if (!($content instanceof Element)) {\n      this.setError(slide, \"{{ELEMENT_NOT_FOUND}}\");\n\n      return;\n    }\n\n    // * Add class name indicating content type, for example `has-image`\n    slide._className = `has-${opts.suffix || slide.type || \"unknown\"}`;\n\n    $el.classList.add(slide._className);\n\n    // * Set content\n    $content.classList.add(\"fancybox__content\");\n\n    // Make sure that content is not hidden and will be visible\n    if ($content.style.display === \"none\" || getComputedStyle($content).getPropertyValue(\"display\") === \"none\") {\n      $content.style.display = slide.display || this.option(\"defaultDisplay\") || \"flex\";\n    }\n\n    if (slide.id) {\n      $content.setAttribute(\"id\", slide.id);\n    }\n\n    slide.$content = $content;\n\n    $el.prepend($content);\n\n    this.manageCloseButton(slide);\n\n    if (slide.state !== \"loading\") {\n      this.revealContent(slide);\n    }\n\n    return $content;\n  }\n\n  /**\n   * Create close button if needed\n   * @param {Object} slide\n   */\n  manageCloseButton(slide) {\n    const position = slide.closeButton === undefined ? this.option(\"closeButton\") : slide.closeButton;\n\n    if (!position || (position === \"top\" && this.$closeButton)) {\n      return;\n    }\n\n    const $btn = document.createElement(\"button\");\n\n    $btn.classList.add(\"carousel__button\", \"is-close\");\n    $btn.setAttribute(\"title\", this.options.l10n.CLOSE);\n    $btn.innerHTML = this.option(\"template.closeButton\");\n\n    $btn.addEventListener(\"click\", (e) => this.close(e));\n\n    if (position === \"inside\") {\n      // Remove existing one to avoid scope issues\n      if (slide.$closeButton) {\n        slide.$closeButton.remove();\n      }\n\n      slide.$closeButton = slide.$content.appendChild($btn);\n    } else {\n      this.$closeButton = this.$container.insertBefore($btn, this.$container.firstChild);\n    }\n  }\n\n  /**\n   * Make content visible for given slide and optionally start CSS animation\n   * @param {Object} slide - Carousel slide\n   */\n  revealContent(slide) {\n    this.trigger(\"reveal\", slide);\n\n    slide.$content.style.visibility = \"\";\n\n    // Add CSS class name that reveals content (default animation is \"fadeIn\")\n    let showClass = false;\n\n    if (\n      !(\n        slide.error ||\n        slide.state === \"loading\" ||\n        this.Carousel.prevPage !== null ||\n        slide.index !== this.options.startIndex\n      )\n    ) {\n      showClass = slide.showClass === undefined ? this.option(\"showClass\") : slide.showClass;\n    }\n\n    if (!showClass) {\n      this.done(slide);\n\n      return;\n    }\n\n    slide.state = \"animating\";\n\n    this.animateCSS(slide.$content, showClass, () => {\n      this.done(slide);\n    });\n  }\n\n  /**\n   * Add class name to given HTML element and wait for `animationend` event to execute callback\n   * @param {HTMLElement} $el\n   * @param {String} className\n   * @param {Function} callback - A callback to run\n   */\n  animateCSS($element, className, callback) {\n    if ($element) {\n      $element.dispatchEvent(new CustomEvent(\"animationend\", { bubbles: true, cancelable: true }));\n    }\n\n    if (!$element || !className) {\n      if (typeof callback === \"function\") {\n        callback();\n      }\n\n      return;\n    }\n\n    const handleAnimationEnd = function (event) {\n      if (event.currentTarget === this) {\n        $element.removeEventListener(\"animationend\", handleAnimationEnd);\n\n        if (callback) {\n          callback();\n        }\n\n        $element.classList.remove(className);\n      }\n    };\n\n    $element.addEventListener(\"animationend\", handleAnimationEnd);\n    $element.classList.add(className);\n  }\n\n  /**\n   * Mark given slide as `done`, e.g., content is loaded and displayed completely\n   * @param {Object} slide - Carousel slide\n   */\n  done(slide) {\n    slide.state = \"done\";\n\n    this.trigger(\"done\", slide);\n\n    // Trigger focus for current slide (and ignore preloaded slides)\n    const currentSlide = this.getSlide();\n\n    if (currentSlide && slide.index === currentSlide.index && this.option(\"autoFocus\")) {\n      this.focus();\n    }\n  }\n\n  /**\n   * Set error message as slide content\n   * @param {Object} slide - Carousel slide\n   * @param {String} message - Error message, can contain HTML code and template variables\n   */\n  setError(slide, message) {\n    slide.error = message;\n\n    this.hideLoading(slide);\n    this.clearContent(slide);\n\n    // Create new content\n    const div = document.createElement(\"div\");\n    div.classList.add(\"fancybox-error\");\n    div.innerHTML = this.localize(message || \"<p>{{ERROR}}</p>\");\n\n    this.setContent(slide, div, { suffix: \"error\" });\n  }\n\n  /**\n   * Create loading indicator inside given slide\n   * @param {Object} slide - Carousel slide\n   */\n  showLoading(slide) {\n    slide.state = \"loading\";\n\n    slide.$el.classList.add(\"is-loading\");\n\n    let $spinner = slide.$el.querySelector(\".fancybox__spinner\");\n\n    if ($spinner) {\n      return;\n    }\n\n    $spinner = document.createElement(\"div\");\n\n    $spinner.classList.add(\"fancybox__spinner\");\n    $spinner.innerHTML = this.option(\"template.spinner\");\n\n    $spinner.addEventListener(\"click\", () => {\n      if (!this.Carousel.Panzoom.velocity) this.close();\n    });\n\n    slide.$el.prepend($spinner);\n  }\n\n  /**\n   * Remove loading indicator from given slide\n   * @param {Object} slide - Carousel slide\n   */\n  hideLoading(slide) {\n    const $spinner = slide.$el && slide.$el.querySelector(\".fancybox__spinner\");\n\n    if ($spinner) {\n      $spinner.remove();\n\n      slide.$el.classList.remove(\"is-loading\");\n    }\n\n    if (slide.state === \"loading\") {\n      this.trigger(\"load\", slide);\n\n      slide.state = \"ready\";\n    }\n  }\n\n  /**\n   * Slide carousel to next page\n   */\n  next() {\n    const carousel = this.Carousel;\n\n    if (carousel && carousel.pages.length > 1) {\n      carousel.slideNext();\n    }\n  }\n\n  /**\n   * Slide carousel to previous page\n   */\n  prev() {\n    const carousel = this.Carousel;\n\n    if (carousel && carousel.pages.length > 1) {\n      carousel.slidePrev();\n    }\n  }\n\n  /**\n   * Slide carousel to selected page with optional parameters\n   * Examples:\n   *    Fancybox.getInstance().jumpTo(2);\n   *    Fancybox.getInstance().jumpTo(3, {friction: 0})\n   * @param  {...any} args - Arguments for Carousel `slideTo` method\n   */\n  jumpTo(...args) {\n    if (this.Carousel) this.Carousel.slideTo(...args);\n  }\n\n  /**\n   * Start closing the current instance\n   * @param {Event} [event] - Optional click event\n   */\n  close(event) {\n    if (event) event.preventDefault();\n\n    // First, stop further execution if this instance is already closing\n    // (this can happen if, for example, user clicks close button multiple times really fast)\n    if ([\"closing\", \"customClosing\", \"destroy\"].includes(this.state)) {\n      return;\n    }\n\n    // Allow callbacks and/or plugins to prevent closing\n    if (this.trigger(\"shouldClose\", event) === false) {\n      return;\n    }\n\n    this.state = \"closing\";\n\n    this.Carousel.Panzoom.destroy();\n\n    this.detachEvents();\n\n    this.trigger(\"closing\", event);\n\n    if (this.state === \"destroy\") {\n      return;\n    }\n\n    // Trigger default CSS closing animation for backdrop and interface elements\n    this.$container.setAttribute(\"aria-hidden\", \"true\");\n\n    this.$container.classList.add(\"is-closing\");\n\n    // Clear inactive slides\n    const currentSlide = this.getSlide();\n\n    this.Carousel.slides.forEach((slide) => {\n      if (slide.$content && slide.index !== currentSlide.index) {\n        this.Carousel.trigger(\"removeSlide\", slide);\n      }\n    });\n\n    // Start default closing animation\n    if (this.state === \"closing\") {\n      const hideClass = currentSlide.hideClass === undefined ? this.option(\"hideClass\") : currentSlide.hideClass;\n\n      this.animateCSS(\n        currentSlide.$content,\n        hideClass,\n        () => {\n          this.destroy();\n        },\n        true\n      );\n    }\n  }\n\n  /**\n   * Clean up after closing fancybox\n   */\n  destroy() {\n    if (this.state === \"destroy\") {\n      return;\n    }\n\n    this.state = \"destroy\";\n\n    this.trigger(\"destroy\");\n\n    const $trigger = this.option(\"placeFocusBack\") ? this.getSlide().$trigger : null;\n\n    // Destroy Carousel and then detach plugins;\n    // * Note: this order allows plugins to receive `removeSlide` event\n    this.Carousel.destroy();\n\n    this.detachPlugins();\n\n    this.Carousel = null;\n\n    this.options = {};\n    this.events = {};\n\n    this.$container.remove();\n\n    this.$container = this.$backdrop = this.$carousel = null;\n\n    if ($trigger) {\n      setFocusOn($trigger);\n    }\n\n    instances.delete(this.id);\n\n    const nextInstance = Fancybox.getInstance();\n\n    if (nextInstance) {\n      nextInstance.focus();\n      return;\n    }\n\n    document.documentElement.classList.remove(\"with-fancybox\");\n    document.body.classList.remove(\"is-using-mouse\");\n\n    this.revealScrollbar();\n  }\n\n  /**\n   * Create new Fancybox instance with provided options\n   * Example:\n   *   Fancybox.show([{ src : 'https://lipsum.app/id/1/300x225' }]);\n   * @param {Array} items - Gallery items\n   * @param {Object} [options] - Optional custom options\n   * @returns {Object} Fancybox instance\n   */\n  static show(items, options = {}) {\n    return new Fancybox(items, options);\n  }\n\n  /**\n   * Starts Fancybox if event target matches any opener or target is `trigger element`\n   * @param {Event} event - Click event\n   * @param {Object} [options] - Optional custom options\n   */\n  static fromEvent(event, options = {}) {\n    //  Allow other scripts to prevent starting fancybox on click\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    // Don't run if right-click\n    if (event.button && event.button !== 0) {\n      return;\n    }\n\n    // Ignore command/control + click\n    if (event.ctrlKey || event.metaKey || event.shiftKey) {\n      return;\n    }\n\n    const origTarget = event.composedPath()[0];\n\n    let eventTarget = origTarget;\n\n    // Support `trigger` element, e.g., start fancybox from different DOM element, for example,\n    // to have one preview image for hidden image gallery\n    let triggerGroupName;\n\n    if (\n      eventTarget.matches(\"[data-fancybox-trigger]\") ||\n      (eventTarget = eventTarget.closest(\"[data-fancybox-trigger]\"))\n    ) {\n      triggerGroupName = eventTarget && eventTarget.dataset && eventTarget.dataset.fancyboxTrigger;\n    }\n\n    if (triggerGroupName) {\n      const triggerItems = document.querySelectorAll(`[data-fancybox=\"${triggerGroupName}\"]`);\n      const triggerIndex = parseInt(eventTarget.dataset.fancyboxIndex, 10) || 0;\n\n      eventTarget = triggerItems.length ? triggerItems[triggerIndex] : eventTarget;\n    }\n\n    if (!eventTarget) {\n      eventTarget = origTarget;\n    }\n\n    // * Try to find matching openener\n    let matchingOpener;\n    let target;\n\n    Array.from(Fancybox.openers.keys())\n      .reverse()\n      .some((opener) => {\n        target = eventTarget;\n\n        let found = false;\n\n        try {\n          if (target instanceof Element && (typeof opener === \"string\" || opener instanceof String)) {\n            // Chain closest() to event.target to find and return the parent element,\n            // regardless if clicking on the child elements (icon, label, etc)\n            found = target.matches(opener) || (target = target.closest(opener));\n          }\n        } catch (error) {}\n\n        if (found) {\n          event.preventDefault();\n          matchingOpener = opener;\n          return true;\n        }\n\n        return false;\n      });\n\n    let rez = false;\n\n    if (matchingOpener) {\n      options.event = event;\n      options.target = target;\n\n      target.origTarget = origTarget;\n\n      rez = Fancybox.fromOpener(matchingOpener, options);\n\n      // Check if the mouse is being used\n      // Waiting for better browser support for `:focus-visible` -\n      // https://drafts.csswg.org/selectors-4/#the-focus-visible-pseudo\n      const nextInstance = Fancybox.getInstance();\n\n      if (nextInstance && nextInstance.state === \"ready\" && event.detail) {\n        document.body.classList.add(\"is-using-mouse\");\n      }\n    }\n\n    return rez;\n  }\n\n  /**\n   * Starts Fancybox using selector\n   * @param {String} opener - Valid CSS selector string\n   * @param {Object} [options] - Optional custom options\n   */\n  static fromOpener(opener, options = {}) {\n    // Callback function called once for each group element that\n    // 1) converts data attributes to boolean or JSON\n    // 2) removes values that could cause issues\n    const mapCallback = function (el) {\n      const falseValues = [\"false\", \"0\", \"no\", \"null\", \"undefined\"];\n      const trueValues = [\"true\", \"1\", \"yes\"];\n\n      const dataset = Object.assign({}, el.dataset);\n      const options = {};\n\n      for (let [key, value] of Object.entries(dataset)) {\n        if (key === \"fancybox\") {\n          continue;\n        }\n\n        if (key === \"width\" || key === \"height\") {\n          options[`_${key}`] = value;\n        } else if (typeof value === \"string\" || value instanceof String) {\n          if (falseValues.indexOf(value) > -1) {\n            options[key] = false;\n          } else if (trueValues.indexOf(options[key]) > -1) {\n            options[key] = true;\n          } else {\n            try {\n              options[key] = JSON.parse(value);\n            } catch (e) {\n              options[key] = value;\n            }\n          }\n        } else {\n          options[key] = value;\n        }\n      }\n\n      if (el instanceof Element) {\n        options.$trigger = el;\n      }\n\n      return options;\n    };\n\n    let items = [],\n      index = options.startIndex || 0,\n      target = options.target || null;\n\n    // Get options\n    // ===\n    options = extend({}, options, Fancybox.openers.get(opener));\n\n    // Get matching nodes\n    // ===\n    const groupAll = options.groupAll === undefined ? false : options.groupAll;\n\n    const groupAttr = options.groupAttr === undefined ? \"data-fancybox\" : options.groupAttr;\n    const groupValue = groupAttr && target ? target.getAttribute(`${groupAttr}`) : \"\";\n\n    if (!target || groupValue || groupAll) {\n      const $root = options.root || (target ? target.getRootNode() : document.body);\n\n      items = [].slice.call($root.querySelectorAll(opener));\n    }\n\n    if (target && !groupAll) {\n      if (groupValue) {\n        items = items.filter((el) => el.getAttribute(`${groupAttr}`) === groupValue);\n      } else {\n        items = [target];\n      }\n    }\n\n    if (!items.length) {\n      return false;\n    }\n\n    // Exit if current instance is triggered from the same element\n    // ===\n    const currentInstance = Fancybox.getInstance();\n\n    if (currentInstance && items.indexOf(currentInstance.options.$trigger) > -1) {\n      return false;\n    }\n\n    // Start Fancybox\n    // ===\n\n    // Get index of current item in the gallery\n    index = target ? items.indexOf(target) : index;\n\n    // Convert items in a format supported by fancybox\n    items = items.map(mapCallback);\n\n    // * Create new fancybox instance\n    return new Fancybox(\n      items,\n      extend({}, options, {\n        startIndex: index,\n        $trigger: target,\n      })\n    );\n  }\n\n  /**\n   * Attach a click handler function that starts Fancybox to the selected items, as well as to all future matching elements.\n   * @param {String} selector - Selector that should match trigger elements\n   * @param {Object} [options] - Custom options\n   */\n  static bind(selector, options = {}) {\n    function attachClickEvent() {\n      document.body.addEventListener(\"click\", Fancybox.fromEvent, false);\n    }\n\n    if (!canUseDOM) {\n      return;\n    }\n\n    if (!Fancybox.openers.size) {\n      if (/complete|interactive|loaded/.test(document.readyState)) {\n        attachClickEvent();\n      } else {\n        document.addEventListener(\"DOMContentLoaded\", attachClickEvent);\n      }\n    }\n\n    Fancybox.openers.set(selector, options);\n  }\n\n  /**\n   * Remove the click handler that was attached with `bind()`\n   * @param {String} selector - A selector which should match the one originally passed to .bind()\n   */\n  static unbind(selector) {\n    Fancybox.openers.delete(selector);\n\n    if (!Fancybox.openers.size) {\n      Fancybox.destroy();\n    }\n  }\n\n  /**\n   * Immediately destroy all instances (without closing animation) and clean up all bindings..\n   */\n  static destroy() {\n    let fb;\n\n    while ((fb = Fancybox.getInstance())) {\n      fb.destroy();\n    }\n\n    Fancybox.openers = new Map();\n\n    document.body.removeEventListener(\"click\", Fancybox.fromEvent, false);\n  }\n\n  /**\n   * Retrieve instance by identifier or the top most instance, if identifier is not provided\n   * @param {String|Numeric} [id] - Optional instance identifier\n   */\n  static getInstance(id) {\n    if (id) {\n      return instances.get(id);\n    }\n\n    const instance = Array.from(instances.values())\n      .reverse()\n      .find((instance) => {\n        if (![\"closing\", \"customClosing\", \"destroy\"].includes(instance.state)) {\n          return instance;\n        }\n\n        return false;\n      });\n\n    return instance || null;\n  }\n\n  /**\n   * Close all or topmost currently active instance.\n   * @param {boolean} [all] - All or only topmost active instance\n   * @param {any} [arguments] - Optional data\n   */\n  static close(all = true, args) {\n    if (all) {\n      for (const instance of instances.values()) {\n        instance.close(args);\n      }\n    } else {\n      const instance = Fancybox.getInstance();\n\n      if (instance) {\n        instance.close(args);\n      }\n    }\n  }\n\n  /**\n   * Slide topmost currently active instance to next page\n   */\n  static next() {\n    const instance = Fancybox.getInstance();\n\n    if (instance) {\n      instance.next();\n    }\n  }\n\n  /**\n   * Slide topmost currently active instance to previous page\n   */\n  static prev() {\n    const instance = Fancybox.getInstance();\n\n    if (instance) {\n      instance.prev();\n    }\n  }\n}\n\n// Expose version\nFancybox.version = \"__VERSION__\";\n\n// Expose defaults\nFancybox.defaults = defaults;\n\n// Expose openers\nFancybox.openers = new Map();\n\n// Add default plugins\nFancybox.Plugins = Plugins;\n\n// Auto init with default options\nFancybox.bind(\"[data-fancybox]\");\n\n// Prepare plugins\nfor (const [key, Plugin] of Object.entries(Fancybox.Plugins || {})) {\n  if (typeof Plugin.create === \"function\") {\n    Plugin.create(Fancybox);\n  }\n}\n\nexport { Fancybox };\n","export default {\r\n  CLOSE: \"Close\",\r\n  NEXT: \"Next\",\r\n  PREV: \"Previous\",\r\n  MODAL: \"You can close this modal content with the ESC key\",\r\n  ERROR: \"Something Went Wrong, Please Try Again Later\",\r\n  IMAGE_ERROR: \"Image Not Found\",\r\n  ELEMENT_NOT_FOUND: \"HTML Element Not Found\",\r\n  AJAX_NOT_FOUND: \"Error Loading AJAX : Not Found\",\r\n  AJAX_FORBIDDEN: \"Error Loading AJAX : Forbidden\",\r\n  IFRAME_ERROR: \"Error Loading Page\",\r\n  TOGGLE_ZOOM: \"Toggle zoom level\",\r\n  TOGGLE_THUMBS: \"Toggle thumbnails\",\r\n  TOGGLE_SLIDESHOW: \"Toggle slideshow\",\r\n  TOGGLE_FULLSCREEN: \"Toggle full-screen mode\",\r\n  DOWNLOAD: \"Download\",\r\n};\r\n","import { canUseDOM } from \"../../../shared/utils/canUseDOM.js\";\n\nexport class Hash {\n  constructor(fancybox) {\n    this.fancybox = fancybox;\n\n    for (const methodName of [\"onChange\", \"onClosing\"]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n\n    this.events = {\n      initCarousel: this.onChange,\n      \"Carousel.change\": this.onChange,\n      closing: this.onClosing,\n    };\n\n    this.hasCreatedHistory = false;\n    this.origHash = \"\";\n    this.timer = null;\n  }\n\n  /**\n   * Process `Carousel.ready` and `Carousel.change` events to update URL hash\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   */\n  onChange(fancybox) {\n    const carousel = fancybox.Carousel;\n\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    const firstRun = carousel.prevPage === null;\n    const currentSlide = fancybox.getSlide();\n\n    const currentHash = new URL(document.URL).hash;\n\n    let newHash = false;\n\n    if (currentSlide.slug) {\n      newHash = \"#\" + currentSlide.slug;\n    } else {\n      const dataset = currentSlide.$trigger && currentSlide.$trigger.dataset;\n      const slug = fancybox.option(\"slug\") || (dataset && dataset.fancybox);\n\n      if (slug && slug.length && slug !== \"true\") {\n        newHash = \"#\" + slug + (carousel.slides.length > 1 ? \"-\" + (currentSlide.index + 1) : \"\");\n      }\n    }\n\n    if (firstRun) {\n      this.origHash = currentHash !== newHash ? currentHash : \"\";\n    }\n\n    if (newHash && currentHash !== newHash) {\n      this.timer = setTimeout(() => {\n        try {\n          window.history[firstRun ? \"pushState\" : \"replaceState\"](\n            {},\n            document.title,\n            window.location.pathname + window.location.search + newHash\n          );\n\n          if (firstRun) {\n            this.hasCreatedHistory = true;\n          }\n        } catch (e) {}\n      }, 300);\n    }\n  }\n\n  /**\n   * Process `closing` event to clean up\n   */\n  onClosing() {\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n\n    // Skip if closing is triggered by pressing  browser back button or by changing hash manually\n    if (this.hasSilentClose === true) {\n      return;\n    }\n\n    // Restore original url\n    try {\n      window.history.replaceState(\n        {},\n        document.title,\n        window.location.pathname + window.location.search + (this.origHash || \"\")\n      );\n\n      return;\n    } catch (e) {}\n  }\n\n  attach(fancybox) {\n    fancybox.on(this.events);\n  }\n\n  detach(fancybox) {\n    fancybox.off(this.events);\n  }\n\n  /**\n   * Start fancybox from current URL hash,\n   * this will be called on page load OR/AND after changing URL hash\n   * @param {Class} Fancybox\n   */\n  static startFromUrl() {\n    const Fancybox = Hash.Fancybox;\n\n    if (!Fancybox || Fancybox.getInstance() || Fancybox.defaults.Hash === false) {\n      return;\n    }\n\n    const { hash, slug, index } = Hash.getParsedURL();\n\n    if (!slug) {\n      return;\n    }\n\n    // Support custom slug\n    // ===\n    let selectedElem = document.querySelector(`[data-slug=\"${hash}\"]`);\n\n    if (selectedElem) {\n      selectedElem.dispatchEvent(new CustomEvent(\"click\", { bubbles: true, cancelable: true }));\n    }\n\n    if (Fancybox.getInstance()) {\n      return;\n    }\n\n    // If elements are not found by custom slug, use URL hash value as group name\n    // ===\n    const groupElems = document.querySelectorAll(`[data-fancybox=\"${slug}\"]`);\n\n    if (!groupElems.length) {\n      return;\n    }\n\n    if (index === null && groupElems.length === 1) {\n      selectedElem = groupElems[0];\n    } else if (index) {\n      selectedElem = groupElems[index - 1];\n    }\n\n    if (selectedElem) {\n      selectedElem.dispatchEvent(new CustomEvent(\"click\", { bubbles: true, cancelable: true }));\n    }\n  }\n\n  /**\n   * Handle `hash` change, change gallery item to current index or start/close current instance\n   */\n  static onHashChange() {\n    const { slug, index } = Hash.getParsedURL();\n\n    const Fancybox = Hash.Fancybox;\n    const instance = Fancybox && Fancybox.getInstance();\n\n    if (instance && instance.plugins.Hash) {\n      // Check if hash matches currently active gallery\n      if (slug) {\n        const carousel = instance.Carousel;\n\n        /**\n         * Support manually opened gallery\n         */\n        if (slug === instance.option(\"slug\")) {\n          return carousel.slideTo(index - 1);\n        }\n\n        /**\n         * Check if URL hash matches `data-slug` value of active element\n         */\n        for (let slide of carousel.slides) {\n          if (slide.slug && slide.slug === slug) {\n            return carousel.slideTo(slide.index);\n          }\n        }\n\n        /**\n         * Check if URL hash matches `data-fancybox` value of active element\n         */\n        const slide = instance.getSlide();\n        const dataset = slide.$trigger && slide.$trigger.dataset;\n\n        if (dataset && dataset.fancybox === slug) {\n          return carousel.slideTo(index - 1);\n        }\n      }\n\n      /**\n       * Close if no matching element found\n       */\n      instance.plugins.Hash.hasSilentClose = true;\n\n      instance.close();\n    }\n\n    /**\n     * Attempt to start\n     */\n    Hash.startFromUrl();\n  }\n\n  /**\n   * Add event bindings that will start new Fancybox instance based in the current URL\n   */\n  static create(Fancybox) {\n    Hash.Fancybox = Fancybox;\n\n    function proceed() {\n      window.addEventListener(\"hashchange\", Hash.onHashChange, false);\n\n      Hash.startFromUrl();\n    }\n\n    if (canUseDOM) {\n      window.requestAnimationFrame(() => {\n        if (/complete|interactive|loaded/.test(document.readyState)) {\n          proceed();\n        } else {\n          document.addEventListener(\"DOMContentLoaded\", proceed);\n        }\n      });\n    }\n  }\n\n  static destroy() {\n    window.removeEventListener(\"hashchange\", Hash.onHashChange, false);\n  }\n\n  /**\n   * Helper method to split URL hash into useful pieces\n   */\n  static getParsedURL() {\n    const hash = window.location.hash.substr(1),\n      tmp = hash.split(\"-\"),\n      index = tmp.length > 1 && /^\\+?\\d+$/.test(tmp[tmp.length - 1]) ? parseInt(tmp.pop(-1), 10) || null : null,\n      slug = tmp.join(\"-\");\n\n    return {\n      hash,\n      slug,\n      index,\n    };\n  }\n}\n","import { extend } from \"../../../shared/utils/extend.js\";\n\nconst buildURLQuery = (src, obj) => {\n  const url = new URL(src);\n  const params = new URLSearchParams(url.search);\n\n  let rez = new URLSearchParams();\n\n  for (const [key, value] of [...params, ...Object.entries(obj)]) {\n    // Youtube\n    if (key === \"t\") {\n      rez.set(\"start\", parseInt(value));\n    } else {\n      rez.set(key, value);\n    }\n  }\n\n  // Convert to 'foo=1&bar=2&baz=3'\n  rez = rez.toString();\n\n  // Vimeo\n  // https://vimeo.zendesk.com/hc/en-us/articles/360000121668-Starting-playback-at-a-specific-timecode\n  let matches = src.match(/#t=((.*)?\\d+s)/);\n\n  if (matches) {\n    rez += `#t=${matches[1]}`;\n  }\n\n  return rez;\n};\n\nconst defaults = {\n  // General options for any video content (Youtube, Vimeo, HTML5 video)\n  video: {\n    autoplay: true,\n    ratio: 16 / 9,\n  },\n  // Youtube embed parameters\n  youtube: {\n    autohide: 1,\n    fs: 1,\n    rel: 0,\n    hd: 1,\n    wmode: \"transparent\",\n    enablejsapi: 1,\n    html5: 1,\n  },\n  // Vimeo embed parameters\n  vimeo: {\n    hd: 1,\n    show_title: 1,\n    show_byline: 1,\n    show_portrait: 0,\n    fullscreen: 1,\n  },\n  // HTML5 video parameters\n  html5video: {\n    tpl: `<video class=\"fancybox__html5video\" playsinline controls controlsList=\"nodownload\" poster=\"{{poster}}\">\n  <source src=\"{{src}}\" type=\"{{format}}\" />Sorry, your browser doesn't support embedded videos.</video>`,\n    format: \"\",\n  },\n};\n\nexport class Html {\n  constructor(fancybox) {\n    this.fancybox = fancybox;\n\n    for (const methodName of [\n      \"onInit\",\n      \"onReady\",\n\n      \"onCreateSlide\",\n      \"onRemoveSlide\",\n\n      \"onSelectSlide\",\n      \"onUnselectSlide\",\n\n      \"onRefresh\",\n\n      // For communication with iframed video (youtube/vimeo)\n      \"onMessage\",\n    ]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n\n    this.events = {\n      init: this.onInit,\n      ready: this.onReady,\n\n      \"Carousel.createSlide\": this.onCreateSlide,\n      \"Carousel.removeSlide\": this.onRemoveSlide,\n\n      \"Carousel.selectSlide\": this.onSelectSlide,\n      \"Carousel.unselectSlide\": this.onUnselectSlide,\n\n      \"Carousel.refresh\": this.onRefresh,\n    };\n  }\n\n  /**\n   * Check if each gallery item has type when fancybox starts\n   */\n  onInit() {\n    for (const slide of this.fancybox.items) {\n      this.processType(slide);\n    }\n  }\n\n  /**\n   * Set content type for the slide\n   * @param {Object} slide\n   */\n  processType(slide) {\n    // Add support for `new Fancybox({items : [{html : 'smth'}]});`\n    if (slide.html) {\n      slide.src = slide.html;\n      slide.type = \"html\";\n\n      delete slide.html;\n\n      return;\n    }\n\n    const src = slide.src || \"\";\n\n    let type = slide.type || this.fancybox.options.type,\n      rez = null;\n\n    if (src && typeof src !== \"string\") {\n      return;\n    }\n\n    if (\n      (rez = src.match(\n        /(?:youtube\\.com|youtu\\.be|youtube\\-nocookie\\.com)\\/(?:watch\\?(?:.*&)?v=|v\\/|u\\/|embed\\/?)?(videoseries\\?list=(?:.*)|[\\w-]{11}|\\?listType=(?:.*)&list=(?:.*))(?:.*)/i\n      ))\n    ) {\n      const params = buildURLQuery(src, this.fancybox.option(\"Html.youtube\"));\n      const videoId = encodeURIComponent(rez[1]);\n\n      slide.videoId = videoId;\n      slide.src = `https://www.youtube-nocookie.com/embed/${videoId}?${params}`;\n      slide.thumb = slide.thumb || `https://i.ytimg.com/vi/${videoId}/mqdefault.jpg`;\n      slide.vendor = \"youtube\";\n\n      type = \"video\";\n    } else if ((rez = src.match(/^.+vimeo.com\\/(?:\\/)?([\\d]+)(.*)?/))) {\n      const params = buildURLQuery(src, this.fancybox.option(\"Html.vimeo\"));\n      const videoId = encodeURIComponent(rez[1]);\n\n      slide.videoId = videoId;\n      slide.src = `https://player.vimeo.com/video/${videoId}?${params}`;\n      slide.vendor = \"vimeo\";\n\n      type = \"video\";\n    } else if (\n      (rez = src.match(\n        /(?:maps\\.)?google\\.([a-z]{2,3}(?:\\.[a-z]{2})?)\\/(?:(?:(?:maps\\/(?:place\\/(?:.*)\\/)?\\@(.*),(\\d+.?\\d+?)z))|(?:\\?ll=))(.*)?/i\n      ))\n    ) {\n      slide.src = `//maps.google.${rez[1]}/?ll=${(rez[2]\n        ? rez[2] + \"&z=\" + Math.floor(rez[3]) + (rez[4] ? rez[4].replace(/^\\//, \"&\") : \"\")\n        : rez[4] + \"\"\n      ).replace(/\\?/, \"&\")}&output=${rez[4] && rez[4].indexOf(\"layer=c\") > 0 ? \"svembed\" : \"embed\"}`;\n\n      type = \"map\";\n    } else if ((rez = src.match(/(?:maps\\.)?google\\.([a-z]{2,3}(?:\\.[a-z]{2})?)\\/(?:maps\\/search\\/)(.*)/i))) {\n      slide.src = `//maps.google.${rez[1]}/maps?q=${rez[2].replace(\"query=\", \"q=\").replace(\"api=1\", \"\")}&output=embed`;\n\n      type = \"map\";\n    }\n\n    // Guess content type\n    if (!type) {\n      if (src.charAt(0) === \"#\") {\n        type = \"inline\";\n      } else if ((rez = src.match(/\\.(mp4|mov|ogv|webm)((\\?|#).*)?$/i))) {\n        type = \"html5video\";\n\n        slide.format = slide.format || \"video/\" + (rez[1] === \"ogv\" ? \"ogg\" : rez[1]);\n      } else if (src.match(/(^data:image\\/[a-z0-9+\\/=]*,)|(\\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\\?|#).*)?$)/i)) {\n        type = \"image\";\n      } else if (src.match(/\\.(pdf)((\\?|#).*)?$/i)) {\n        type = \"pdf\";\n      }\n    }\n\n    slide.type = type || this.fancybox.option(\"defaultType\", \"image\");\n\n    if (type === \"html5video\" || type === \"video\") {\n      slide.video = extend({}, this.fancybox.option(\"Html.video\"), slide.video);\n\n      if (slide._width && slide._height) {\n        slide.ratio = parseFloat(slide._width) / parseFloat(slide._height);\n      } else {\n        slide.ratio = slide.ratio || slide.video.ratio || defaults.video.ratio;\n      }\n    }\n  }\n\n  /**\n   * Start loading content when Fancybox is ready\n   */\n  onReady() {\n    this.fancybox.Carousel.slides.forEach((slide) => {\n      if (slide.$el) {\n        this.setContent(slide);\n\n        if (slide.index === this.fancybox.getSlide().index) {\n          this.playVideo(slide);\n        }\n      }\n    });\n  }\n\n  /**\n   * Process `Carousel.createSlide` event to create image content\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  onCreateSlide(fancybox, carousel, slide) {\n    if (this.fancybox.state !== \"ready\") {\n      return;\n    }\n\n    this.setContent(slide);\n  }\n\n  /**\n   * Retrieve and set slide content\n   * @param {Object} slide\n   */\n  loadInlineContent(slide) {\n    let $content;\n\n    if (slide.src instanceof HTMLElement) {\n      $content = slide.src;\n    } else if (typeof slide.src === \"string\") {\n      const tmp = slide.src.split(\"#\", 2);\n      const id = tmp.length === 2 && tmp[0] === \"\" ? tmp[1] : tmp[0];\n\n      $content = document.getElementById(id);\n    }\n\n    if ($content) {\n      if (slide.type === \"clone\" || $content.$placeHolder) {\n        $content = $content.cloneNode(true);\n        let attrId = $content.getAttribute(\"id\");\n\n        attrId = attrId ? `${attrId}--clone` : `clone-${this.fancybox.id}-${slide.index}`;\n\n        $content.setAttribute(\"id\", attrId);\n      } else {\n        const $placeHolder = document.createElement(\"div\");\n        $placeHolder.classList.add(\"fancybox-placeholder\");\n        $content.parentNode.insertBefore($placeHolder, $content);\n        $content.$placeHolder = $placeHolder;\n      }\n\n      this.fancybox.setContent(slide, $content);\n    } else {\n      this.fancybox.setError(slide, \"{{ELEMENT_NOT_FOUND}}\");\n    }\n  }\n\n  /**\n   * Makes AJAX request and sets response as slide content\n   * @param {Object} slide\n   */\n  loadAjaxContent(slide) {\n    const fancybox = this.fancybox;\n    const xhr = new XMLHttpRequest();\n\n    fancybox.showLoading(slide);\n\n    xhr.onreadystatechange = function () {\n      if (xhr.readyState === XMLHttpRequest.DONE) {\n        if (fancybox.state === \"ready\") {\n          fancybox.hideLoading(slide);\n\n          if (xhr.status === 200) {\n            fancybox.setContent(slide, xhr.responseText);\n          } else {\n            fancybox.setError(slide, xhr.status === 404 ? \"{{AJAX_NOT_FOUND}}\" : \"{{AJAX_FORBIDDEN}}\");\n          }\n        }\n      }\n    };\n\n    const data = slide.ajax || null;\n\n    xhr.open(data ? \"POST\" : \"GET\", slide.src);\n    xhr.setRequestHeader(\"Content-Type\", \"application/x-www-form-urlencoded\");\n    xhr.setRequestHeader(\"X-Requested-With\", \"XMLHttpRequest\");\n    xhr.send(data);\n\n    slide.xhr = xhr;\n  }\n\n  /**\n   * Creates iframe as slide content, preloads if needed before displaying\n   * @param {Object} slide\n   */\n  loadIframeContent(slide) {\n    const fancybox = this.fancybox;\n    const $iframe = document.createElement(\"iframe\");\n\n    $iframe.className = \"fancybox__iframe\";\n\n    $iframe.setAttribute(\"id\", `fancybox__iframe_${fancybox.id}_${slide.index}`);\n\n    $iframe.setAttribute(\"allow\", \"autoplay; fullscreen\");\n    $iframe.setAttribute(\"scrolling\", \"auto\");\n\n    slide.$iframe = $iframe;\n\n    if (slide.type !== \"iframe\" || slide.preload === false) {\n      $iframe.setAttribute(\"src\", slide.src);\n\n      this.fancybox.setContent(slide, $iframe);\n\n      this.resizeIframe(slide);\n\n      return;\n    }\n\n    fancybox.showLoading(slide);\n\n    const $content = document.createElement(\"div\");\n    $content.style.visibility = \"hidden\";\n\n    this.fancybox.setContent(slide, $content);\n\n    $content.appendChild($iframe);\n\n    $iframe.onerror = () => {\n      fancybox.setError(slide, \"{{IFRAME_ERROR}}\");\n    };\n\n    $iframe.onload = () => {\n      fancybox.hideLoading(slide);\n\n      let isFirstLoad = false;\n\n      if (!$iframe.isReady) {\n        $iframe.isReady = true;\n        isFirstLoad = true;\n      }\n\n      if (!$iframe.src.length) {\n        return;\n      }\n\n      $iframe.parentNode.style.visibility = \"\";\n\n      this.resizeIframe(slide);\n\n      if (isFirstLoad) {\n        fancybox.revealContent(slide);\n      }\n    };\n\n    $iframe.setAttribute(\"src\", slide.src);\n  }\n\n  /**\n   * Set CSS max/min width/height properties of the content to have the correct aspect ratio\n   * @param {Object} slide\n   */\n  setAspectRatio(slide) {\n    const $content = slide.$content;\n    const ratio = slide.ratio;\n\n    if (!$content) {\n      return;\n    }\n\n    let width = slide._width;\n    let height = slide._height;\n\n    if (ratio || (width && height)) {\n      Object.assign($content.style, {\n        width: width && height ? \"100%\" : \"\",\n        height: width && height ? \"100%\" : \"\",\n        maxWidth: \"\",\n        maxHeight: \"\",\n      });\n\n      let maxWidth = $content.offsetWidth;\n      let maxHeight = $content.offsetHeight;\n\n      width = width || maxWidth;\n      height = height || maxHeight;\n\n      // Resize to fit\n      if (width > maxWidth || height > maxHeight) {\n        let maxRatio = Math.min(maxWidth / width, maxHeight / height);\n\n        width = width * maxRatio;\n        height = height * maxRatio;\n      }\n\n      // Recheck ratio\n      if (Math.abs(width / height - ratio) > 0.01) {\n        if (ratio < width / height) {\n          width = height * ratio;\n        } else {\n          height = width / ratio;\n        }\n      }\n\n      Object.assign($content.style, {\n        width: `${width}px`,\n        height: `${height}px`,\n      });\n    }\n  }\n\n  /**\n   * Adjust the width and height of the iframe according to the content dimensions, or defined sizes\n   * @param {Object} slide\n   */\n  resizeIframe(slide) {\n    const $iframe = slide.$iframe;\n\n    if (!$iframe) {\n      return;\n    }\n\n    let width_ = slide._width || 0;\n    let height_ = slide._height || 0;\n\n    if (width_ && height_) {\n      slide.autoSize = false;\n    }\n\n    const $parent = $iframe.parentNode;\n    const parentStyle = $parent && $parent.style;\n\n    if (slide.preload !== false && slide.autoSize !== false && parentStyle) {\n      try {\n        const compStyles = window.getComputedStyle($parent),\n          paddingX = parseFloat(compStyles.paddingLeft) + parseFloat(compStyles.paddingRight),\n          paddingY = parseFloat(compStyles.paddingTop) + parseFloat(compStyles.paddingBottom);\n\n        const document = $iframe.contentWindow.document,\n          $html = document.getElementsByTagName(\"html\")[0],\n          $body = document.body;\n\n        // Allow content to expand horizontally\n        parentStyle.width = \"\";\n\n        // Get rid of vertical scrollbar\n        $body.style.overflow = \"hidden\";\n\n        width_ = width_ || $html.scrollWidth + paddingX;\n\n        parentStyle.width = `${width_}px`;\n\n        $body.style.overflow = \"\";\n\n        parentStyle.flex = \"0 0 auto\";\n        parentStyle.height = `${$body.scrollHeight}px`;\n\n        height_ = $html.scrollHeight + paddingY;\n      } catch (error) {\n        //\n      }\n    }\n\n    if (width_ || height_) {\n      const newStyle = {\n        flex: \"0 1 auto\",\n      };\n\n      if (width_) {\n        newStyle.width = `${width_}px`;\n      }\n\n      if (height_) {\n        newStyle.height = `${height_}px`;\n      }\n\n      Object.assign(parentStyle, newStyle);\n    }\n  }\n\n  /**\n   * Process `Carousel.onRefresh` event,\n   * trigger iframe autosizing and set content aspect ratio for each slide\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   */\n  onRefresh(fancybox, carousel) {\n    carousel.slides.forEach((slide) => {\n      if (!slide.$el) {\n        return;\n      }\n\n      if (slide.$iframe) {\n        this.resizeIframe(slide);\n      }\n\n      if (slide.ratio) {\n        this.setAspectRatio(slide);\n      }\n    });\n  }\n\n  /**\n   * Process `Carousel.onCreateSlide` event to set content\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  setContent(slide) {\n    if (!slide || slide.isDom) {\n      return;\n    }\n\n    switch (slide.type) {\n      case \"html\":\n        this.fancybox.setContent(slide, slide.src);\n        break;\n\n      case \"html5video\":\n        this.fancybox.setContent(\n          slide,\n          this.fancybox\n            .option(\"Html.html5video.tpl\")\n            .replace(/\\{\\{src\\}\\}/gi, slide.src)\n            .replace(\"{{format}}\", slide.format || (slide.html5video && slide.html5video.format) || \"\")\n            .replace(\"{{poster}}\", slide.poster || slide.thumb || \"\")\n        );\n\n        break;\n\n      case \"inline\":\n      case \"clone\":\n        this.loadInlineContent(slide);\n        break;\n\n      case \"ajax\":\n        this.loadAjaxContent(slide);\n        break;\n\n      case \"pdf\":\n      case \"video\":\n      case \"map\":\n        slide.preload = false;\n\n      case \"iframe\":\n        this.loadIframeContent(slide);\n\n        break;\n    }\n\n    if (slide.ratio) {\n      this.setAspectRatio(slide);\n    }\n  }\n\n  /**\n   * Process `Carousel.onSelectSlide` event to start video\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  onSelectSlide(fancybox, carousel, slide) {\n    if (fancybox.state === \"ready\") {\n      this.playVideo(slide);\n    }\n  }\n\n  /**\n   * Attempts to begin playback of the media\n   * @param {Object} slide\n   */\n  playVideo(slide) {\n    if (slide.type === \"html5video\" && slide.video.autoplay) {\n      try {\n        const $video = slide.$el.querySelector(\"video\");\n\n        if ($video) {\n          const promise = $video.play();\n\n          if (promise !== undefined) {\n            promise\n              .then(() => {\n                // Autoplay started\n              })\n              .catch((error) => {\n                // Autoplay was prevented.\n                $video.muted = true;\n                $video.play();\n              });\n          }\n        }\n      } catch (err) {}\n    }\n\n    if (slide.type !== \"video\" || !(slide.$iframe && slide.$iframe.contentWindow)) {\n      return;\n    }\n\n    // This function will be repeatedly called to check\n    // if video iframe has been loaded to send message to start the video\n    const poller = () => {\n      if (slide.state === \"done\" && slide.$iframe && slide.$iframe.contentWindow) {\n        let command;\n\n        if (slide.$iframe.isReady) {\n          if (slide.video && slide.video.autoplay) {\n            if (slide.vendor == \"youtube\") {\n              command = {\n                event: \"command\",\n                func: \"playVideo\",\n              };\n            } else {\n              command = {\n                method: \"play\",\n                value: \"true\",\n              };\n            }\n          }\n\n          if (command) {\n            slide.$iframe.contentWindow.postMessage(JSON.stringify(command), \"*\");\n          }\n\n          return;\n        }\n\n        if (slide.vendor === \"youtube\") {\n          command = {\n            event: \"listening\",\n            id: slide.$iframe.getAttribute(\"id\"),\n          };\n\n          slide.$iframe.contentWindow.postMessage(JSON.stringify(command), \"*\");\n        }\n      }\n\n      slide.poller = setTimeout(poller, 250);\n    };\n\n    poller();\n  }\n\n  /**\n   * Process `Carousel.onUnselectSlide` event to pause video\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  onUnselectSlide(fancybox, carousel, slide) {\n    if (slide.type === \"html5video\") {\n      try {\n        slide.$el.querySelector(\"video\").pause();\n      } catch (error) {}\n\n      return;\n    }\n\n    let command = false;\n\n    if (slide.vendor == \"vimeo\") {\n      command = {\n        method: \"pause\",\n        value: \"true\",\n      };\n    } else if (slide.vendor === \"youtube\") {\n      command = {\n        event: \"command\",\n        func: \"pauseVideo\",\n      };\n    }\n\n    if (command && slide.$iframe && slide.$iframe.contentWindow) {\n      slide.$iframe.contentWindow.postMessage(JSON.stringify(command), \"*\");\n    }\n\n    clearTimeout(slide.poller);\n  }\n\n  /**\n   * Process `Carousel.onRemoveSlide` event to do clean up\n   * @param {Object} fancybox\n   * @param {Object} carousel\n   * @param {Object} slide\n   */\n  onRemoveSlide(fancybox, carousel, slide) {\n    // Abort ajax request if exists\n    if (slide.xhr) {\n      slide.xhr.abort();\n      slide.xhr = null;\n    }\n\n    // Unload iframe content if exists\n    if (slide.$iframe) {\n      slide.$iframe.onload = slide.$iframe.onerror = null;\n\n      slide.$iframe.src = \"//about:blank\";\n      slide.$iframe = null;\n    }\n\n    // Clear inline content\n    const $content = slide.$content;\n\n    if (slide.type === \"inline\" && $content) {\n      $content.classList.remove(\"fancybox__content\");\n\n      if ($content.style.display !== \"none\") {\n        $content.style.display = \"none\";\n      }\n    }\n\n    if (slide.$closeButton) {\n      slide.$closeButton.remove();\n      slide.$closeButton = null;\n    }\n\n    const $placeHolder = $content && $content.$placeHolder;\n\n    if ($placeHolder) {\n      $placeHolder.parentNode.insertBefore($content, $placeHolder);\n      $placeHolder.remove();\n      $content.$placeHolder = null;\n    }\n  }\n\n  /**\n   * Process `window.message` event to mark video iframe element as `ready`\n   * @param {Object} e - Event\n   */\n  onMessage(e) {\n    try {\n      let data = JSON.parse(e.data);\n\n      if (e.origin === \"https://player.vimeo.com\") {\n        if (data.event === \"ready\") {\n          for (let $iframe of document.getElementsByClassName(\"fancybox__iframe\")) {\n            if ($iframe.contentWindow === e.source) {\n              $iframe.isReady = 1;\n            }\n          }\n        }\n      } else if (e.origin === \"https://www.youtube-nocookie.com\") {\n        if (data.event === \"onReady\") {\n          document.getElementById(data.id).isReady = 1;\n        }\n      }\n    } catch (ex) {}\n  }\n\n  attach() {\n    this.fancybox.on(this.events);\n\n    window.addEventListener(\"message\", this.onMessage, false);\n  }\n\n  detach() {\n    this.fancybox.off(this.events);\n\n    window.removeEventListener(\"message\", this.onMessage, false);\n  }\n}\n\n// Expose defaults\nHtml.defaults = defaults;\n","import { extend } from \"../../../shared/utils/extend.js\";\r\n\r\nimport { Panzoom } from \"../../../Panzoom/Panzoom.js\";\r\n\r\nconst defaults = {\r\n  // Class name for slide element indicating that content can be zoomed in\r\n  canZoomInClass: \"can-zoom_in\",\r\n\r\n  // Class name for slide element indicating that content can be zoomed out\r\n  canZoomOutClass: \"can-zoom_out\",\r\n\r\n  // Do zoom animation from thumbnail image when starting or closing fancybox\r\n  zoom: true,\r\n\r\n  // Animate opacity while zooming\r\n  zoomOpacity: \"auto\", // \"auto\" | true | false,\r\n\r\n  // Zoom animation friction\r\n  zoomFriction: 0.82,\r\n\r\n  // Disable zoom animation if thumbnail is visible only partly\r\n  ignoreCoveredThumbnail: false,\r\n\r\n  // Enable guestures\r\n  touch: true,\r\n\r\n  // Action to be performed when user clicks on the image\r\n  click: \"toggleZoom\", // \"toggleZoom\" | \"next\" | \"close\" | null\r\n\r\n  // Action to be performed when double-click event is detected on the image\r\n  doubleClick: null, // \"toggleZoom\" | null\r\n\r\n  // Action to be performed when user rotates a wheel button on a pointing device\r\n  wheel: \"zoom\", // \"zoom\" | \"slide\" | \"close\" | null\r\n\r\n  // How image should be resized to fit its container\r\n  fit: \"contain\", // \"contain\" | \"contain-w\" | \"cover\"\r\n\r\n  // Should create wrapping element around the image\r\n  wrap: false,\r\n\r\n  // Custom Panzoom options\r\n  Panzoom: {\r\n    ratio: 1,\r\n  },\r\n};\r\n\r\nexport class Image {\r\n  constructor(fancybox) {\r\n    this.fancybox = fancybox;\r\n\r\n    for (const methodName of [\r\n      // Fancybox\r\n      \"onReady\",\r\n      \"onClosing\",\r\n      \"onDone\",\r\n\r\n      // Fancybox.Carousel\r\n      \"onPageChange\",\r\n      \"onCreateSlide\",\r\n      \"onRemoveSlide\",\r\n\r\n      // Image load/error\r\n      \"onImageStatusChange\",\r\n    ]) {\r\n      this[methodName] = this[methodName].bind(this);\r\n    }\r\n\r\n    this.events = {\r\n      ready: this.onReady,\r\n      closing: this.onClosing,\r\n      done: this.onDone,\r\n\r\n      \"Carousel.change\": this.onPageChange,\r\n      \"Carousel.createSlide\": this.onCreateSlide,\r\n      \"Carousel.removeSlide\": this.onRemoveSlide,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Handle `ready` event to start loading content\r\n   */\r\n  onReady() {\r\n    this.fancybox.Carousel.slides.forEach((slide) => {\r\n      if (slide.$el) {\r\n        this.setContent(slide);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Handle `done` event to update cursor\r\n   * @param {Object} fancybox\r\n   * @param {Object} slide\r\n   */\r\n  onDone(fancybox, slide) {\r\n    this.handleCursor(slide);\r\n  }\r\n\r\n  /**\r\n   * Handle `closing` event to clean up all slides and to start zoom-out animation\r\n   * @param {Object} fancybox\r\n   */\r\n  onClosing(fancybox) {\r\n    clearTimeout(this.clickTimer);\r\n    this.clickTimer = null;\r\n\r\n    // Remove events\r\n    fancybox.Carousel.slides.forEach((slide) => {\r\n      if (slide.$image) {\r\n        slide.state = \"destroy\";\r\n      }\r\n\r\n      if (slide.Panzoom) {\r\n        slide.Panzoom.detachEvents();\r\n      }\r\n    });\r\n\r\n    // If possible, start the zoom animation, it will interrupt the default closing process\r\n    if (this.fancybox.state === \"closing\" && this.canZoom(fancybox.getSlide())) {\r\n      this.zoomOut();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Process `Carousel.createSlide` event to create image content\r\n   * @param {Object} fancybox\r\n   * @param {Object} carousel\r\n   * @param {Object} slide\r\n   */\r\n  onCreateSlide(fancybox, carousel, slide) {\r\n    if (this.fancybox.state !== \"ready\") {\r\n      return;\r\n    }\r\n\r\n    this.setContent(slide);\r\n  }\r\n\r\n  /**\r\n   * Handle `Carousel.removeSlide` event to do clean up the slide\r\n   * @param {Object} fancybox\r\n   * @param {Object} carousel\r\n   * @param {Object} slide\r\n   */\r\n  onRemoveSlide(fancybox, carousel, slide) {\r\n    if (slide.$image) {\r\n      slide.$el.classList.remove(fancybox.option(\"Image.canZoomInClass\"));\r\n\r\n      slide.$image.remove();\r\n      slide.$image = null;\r\n    }\r\n\r\n    if (slide.Panzoom) {\r\n      slide.Panzoom.destroy();\r\n      slide.Panzoom = null;\r\n    }\r\n\r\n    if (slide.$el && slide.$el.dataset) {\r\n      delete slide.$el.dataset.imageFit;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Build DOM elements and add event listeners\r\n   * @param {Object} slide\r\n   */\r\n  setContent(slide) {\r\n    // Check if this slide should contain an image\r\n    if (slide.isDom || slide.html || (slide.type && slide.type !== \"image\")) {\r\n      return;\r\n    }\r\n\r\n    if (slide.$image) {\r\n      return;\r\n    }\r\n\r\n    slide.type = \"image\";\r\n    slide.state = \"loading\";\r\n\r\n    // * Build layout\r\n    // Container\r\n    const $content = document.createElement(\"div\");\r\n    $content.style.visibility = \"hidden\";\r\n\r\n    // Image element\r\n    const $image = document.createElement(\"img\");\r\n\r\n    $image.addEventListener(\"load\", (event) => {\r\n      event.stopImmediatePropagation();\r\n\r\n      this.onImageStatusChange(slide);\r\n    });\r\n\r\n    $image.addEventListener(\"error\", () => {\r\n      this.onImageStatusChange(slide);\r\n    });\r\n\r\n    $image.src = slide.src;\r\n    $image.alt = \"\";\r\n    $image.draggable = false;\r\n\r\n    $image.classList.add(\"fancybox__image\");\r\n\r\n    if (slide.srcset) {\r\n      $image.setAttribute(\"srcset\", slide.srcset);\r\n    }\r\n\r\n    if (slide.sizes) {\r\n      $image.setAttribute(\"sizes\", slide.sizes);\r\n    }\r\n\r\n    slide.$image = $image;\r\n\r\n    const shouldWrap = this.fancybox.option(\"Image.wrap\");\r\n\r\n    if (shouldWrap) {\r\n      const $wrap = document.createElement(\"div\");\r\n      $wrap.classList.add(typeof shouldWrap === \"string\" ? shouldWrap : \"fancybox__image-wrap\");\r\n\r\n      $wrap.appendChild($image);\r\n\r\n      $content.appendChild($wrap);\r\n\r\n      slide.$wrap = $wrap;\r\n    } else {\r\n      $content.appendChild($image);\r\n    }\r\n\r\n    // Set data attribute if other that default\r\n    // for example, set `[data-image-fit=\"contain-w\"]`\r\n    slide.$el.dataset.imageFit = this.fancybox.option(\"Image.fit\");\r\n\r\n    // Append content\r\n    this.fancybox.setContent(slide, $content);\r\n\r\n    // Display loading icon\r\n    if ($image.complete || $image.error) {\r\n      this.onImageStatusChange(slide);\r\n    } else {\r\n      this.fancybox.showLoading(slide);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle image state change, display error or start revealing image\r\n   * @param {Object} slide\r\n   */\r\n  onImageStatusChange(slide) {\r\n    const $image = slide.$image;\r\n\r\n    if (!$image || slide.state !== \"loading\") {\r\n      return;\r\n    }\r\n\r\n    if (!($image.complete && $image.naturalWidth && $image.naturalHeight)) {\r\n      this.fancybox.setError(slide, \"{{IMAGE_ERROR}}\");\r\n\r\n      return;\r\n    }\r\n\r\n    this.fancybox.hideLoading(slide);\r\n\r\n    if (this.fancybox.option(\"Image.fit\") === \"contain\") {\r\n      this.initSlidePanzoom(slide);\r\n    }\r\n\r\n    // Add `wheel` and `click` event handler\r\n    slide.$el.addEventListener(\"wheel\", (event) => this.onWheel(slide, event), { passive: false });\r\n    slide.$content.addEventListener(\"click\", (event) => this.onClick(slide, event), { passive: false });\r\n\r\n    this.revealContent(slide);\r\n  }\r\n\r\n  /**\r\n   * Make image zoomable and draggable using Panzoom\r\n   * @param {Object} slide\r\n   */\r\n  initSlidePanzoom(slide) {\r\n    if (slide.Panzoom) {\r\n      return;\r\n    }\r\n\r\n    //* Initialize Panzoom\r\n    slide.Panzoom = new Panzoom(\r\n      slide.$el,\r\n      extend(true, this.fancybox.option(\"Image.Panzoom\", {}), {\r\n        viewport: slide.$wrap,\r\n        content: slide.$image,\r\n\r\n        width: slide._width,\r\n        height: slide._height,\r\n\r\n        wrapInner: false,\r\n\r\n        // Allow to select caption text\r\n        textSelection: true,\r\n\r\n        // Toggle gestures\r\n        touch: this.fancybox.option(\"Image.touch\"),\r\n\r\n        // This will prevent click conflict with fancybox main carousel\r\n        panOnlyZoomed: true,\r\n\r\n        // Disable default click / wheel events as custom event listeners will replace them,\r\n        // because click and wheel events should work without Panzoom\r\n        click: false,\r\n        wheel: false,\r\n      })\r\n    );\r\n\r\n    slide.Panzoom.on(\"startAnimation\", () => {\r\n      this.fancybox.trigger(\"Image.startAnimation\", slide);\r\n    });\r\n\r\n    slide.Panzoom.on(\"endAnimation\", () => {\r\n      if (slide.state === \"zoomIn\") {\r\n        this.fancybox.done(slide);\r\n      }\r\n\r\n      this.handleCursor(slide);\r\n\r\n      this.fancybox.trigger(\"Image.endAnimation\", slide);\r\n    });\r\n\r\n    slide.Panzoom.on(\"afterUpdate\", () => {\r\n      this.handleCursor(slide);\r\n\r\n      this.fancybox.trigger(\"Image.afterUpdate\", slide);\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Start zoom-in animation if possible, or simply reveal content\r\n   * @param {Object} slide\r\n   */\r\n  revealContent(slide) {\r\n    // Animate only on first run\r\n    if (\r\n      this.fancybox.Carousel.prevPage === null &&\r\n      slide.index === this.fancybox.options.startIndex &&\r\n      this.canZoom(slide)\r\n    ) {\r\n      this.zoomIn();\r\n    } else {\r\n      this.fancybox.revealContent(slide);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get zoom info for selected slide\r\n   * @param {Object} slide\r\n   */\r\n  getZoomInfo(slide) {\r\n    const $thumb = slide.$thumb,\r\n      thumbRect = $thumb.getBoundingClientRect(),\r\n      thumbWidth = thumbRect.width,\r\n      thumbHeight = thumbRect.height,\r\n      //\r\n      contentRect = slide.$content.getBoundingClientRect(),\r\n      contentWidth = contentRect.width,\r\n      contentHeight = contentRect.height,\r\n      //\r\n      shiftedTop = contentRect.top - thumbRect.top,\r\n      shiftedLeft = contentRect.left - thumbRect.left;\r\n\r\n    // Check if need to update opacity\r\n    let opacity = this.fancybox.option(\"Image.zoomOpacity\");\r\n\r\n    if (opacity === \"auto\") {\r\n      opacity = Math.abs(thumbWidth / thumbHeight - contentWidth / contentHeight) > 0.1;\r\n    }\r\n\r\n    return {\r\n      top: shiftedTop,\r\n      left: shiftedLeft,\r\n      scale: contentWidth && thumbWidth ? thumbWidth / contentWidth : 1,\r\n      opacity: opacity,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Determine if it is possible to do zoom-in animation\r\n   */\r\n  canZoom(slide) {\r\n    const fancybox = this.fancybox,\r\n      $container = fancybox.$container;\r\n\r\n    if (window.visualViewport && window.visualViewport.scale !== 1) {\r\n      return false;\r\n    }\r\n\r\n    if (slide.Panzoom && !slide.Panzoom.content.width) {\r\n      return false;\r\n    }\r\n\r\n    if (!fancybox.option(\"Image.zoom\") || fancybox.option(\"Image.fit\") !== \"contain\") {\r\n      return false;\r\n    }\r\n\r\n    const $thumb = slide.$thumb;\r\n\r\n    if (!$thumb || slide.state === \"loading\") {\r\n      return false;\r\n    }\r\n\r\n    // * Check if thumbnail image is really visible\r\n    $container.classList.add(\"fancybox__no-click\");\r\n\r\n    const rect = $thumb.getBoundingClientRect();\r\n\r\n    let rez;\r\n\r\n    // Check if thumbnail image is actually visible on the screen\r\n    if (this.fancybox.option(\"Image.ignoreCoveredThumbnail\")) {\r\n      const visibleTopLeft = document.elementFromPoint(rect.left + 1, rect.top + 1) === $thumb;\r\n      const visibleBottomRight = document.elementFromPoint(rect.right - 1, rect.bottom - 1) === $thumb;\r\n\r\n      rez = visibleTopLeft && visibleBottomRight;\r\n    } else {\r\n      rez = document.elementFromPoint(rect.left + rect.width * 0.5, rect.top + rect.height * 0.5) === $thumb;\r\n    }\r\n\r\n    $container.classList.remove(\"fancybox__no-click\");\r\n\r\n    return rez;\r\n  }\r\n\r\n  /**\r\n   * Perform zoom-in animation\r\n   */\r\n  zoomIn() {\r\n    const fancybox = this.fancybox,\r\n      slide = fancybox.getSlide(),\r\n      Panzoom = slide.Panzoom;\r\n\r\n    const { top, left, scale, opacity } = this.getZoomInfo(slide);\r\n\r\n    fancybox.trigger(\"reveal\", slide);\r\n\r\n    // Scale and move to start position\r\n    Panzoom.panTo({\r\n      x: left * -1,\r\n      y: top * -1,\r\n      scale: scale,\r\n      friction: 0,\r\n      ignoreBounds: true,\r\n    });\r\n\r\n    slide.$content.style.visibility = \"\";\r\n\r\n    slide.state = \"zoomIn\";\r\n\r\n    if (opacity === true) {\r\n      Panzoom.on(\"afterTransform\", (panzoom) => {\r\n        if (slide.state === \"zoomIn\" || slide.state === \"zoomOut\") {\r\n          panzoom.$content.style.opacity = Math.min(1, 1 - (1 - panzoom.content.scale) / (1 - scale));\r\n        }\r\n      });\r\n    }\r\n\r\n    // Animate back to original position\r\n    Panzoom.panTo({\r\n      x: 0,\r\n      y: 0,\r\n      scale: 1,\r\n      friction: this.fancybox.option(\"Image.zoomFriction\"),\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Perform zoom-out animation\r\n   */\r\n  zoomOut() {\r\n    const fancybox = this.fancybox,\r\n      slide = fancybox.getSlide(),\r\n      Panzoom = slide.Panzoom;\r\n\r\n    if (!Panzoom) {\r\n      return;\r\n    }\r\n\r\n    slide.state = \"zoomOut\";\r\n    fancybox.state = \"customClosing\";\r\n\r\n    if (slide.$caption) {\r\n      slide.$caption.style.visibility = \"hidden\";\r\n    }\r\n\r\n    let friction = this.fancybox.option(\"Image.zoomFriction\");\r\n\r\n    const animatePosition = (event) => {\r\n      const { top, left, scale, opacity } = this.getZoomInfo(slide);\r\n\r\n      // Increase speed on the first run if opacity is not animated\r\n      if (!event && !opacity) {\r\n        friction *= 0.82;\r\n      }\r\n\r\n      Panzoom.panTo({\r\n        x: left * -1,\r\n        y: top * -1,\r\n        scale,\r\n        friction,\r\n        ignoreBounds: true,\r\n      });\r\n\r\n      // Gradually increase speed\r\n      friction *= 0.98;\r\n    };\r\n\r\n    // Page scrolling will cause thumbnail to change position on the display,\r\n    // therefore animation end position has to be recalculated after each page scroll\r\n    window.addEventListener(\"scroll\", animatePosition);\r\n\r\n    Panzoom.once(\"endAnimation\", () => {\r\n      window.removeEventListener(\"scroll\", animatePosition);\r\n      fancybox.destroy();\r\n    });\r\n\r\n    animatePosition();\r\n  }\r\n\r\n  /**\r\n   * Set the type of mouse cursor to indicate if content is zoomable\r\n   * @param {Object} slide\r\n   */\r\n  handleCursor(slide) {\r\n    if (slide.type !== \"image\" || !slide.$el) {\r\n      return;\r\n    }\r\n\r\n    const panzoom = slide.Panzoom;\r\n    const clickAction = this.fancybox.option(\"Image.click\", false, slide);\r\n    const touchIsEnabled = this.fancybox.option(\"Image.touch\");\r\n\r\n    const classList = slide.$el.classList;\r\n\r\n    const zoomInClass = this.fancybox.option(\"Image.canZoomInClass\");\r\n    const zoomOutClass = this.fancybox.option(\"Image.canZoomOutClass\");\r\n\r\n    classList.remove(zoomOutClass);\r\n    classList.remove(zoomInClass);\r\n\r\n    if (panzoom && clickAction === \"toggleZoom\") {\r\n      const canZoomIn =\r\n        panzoom && panzoom.content.scale === 1 && panzoom.option(\"maxScale\") - panzoom.content.scale > 0.01;\r\n\r\n      if (canZoomIn) {\r\n        classList.add(zoomInClass);\r\n      } else if (panzoom.content.scale > 1 && !touchIsEnabled) {\r\n        classList.add(zoomOutClass);\r\n      }\r\n    } else if (clickAction === \"close\") {\r\n      classList.add(zoomOutClass);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle `wheel` event\r\n   * @param {Object} slide\r\n   * @param {Object} event\r\n   */\r\n  onWheel(slide, event) {\r\n    if (this.fancybox.state !== \"ready\") {\r\n      return;\r\n    }\r\n\r\n    if (this.fancybox.trigger(\"Image.wheel\", event) === false) {\r\n      return;\r\n    }\r\n\r\n    switch (this.fancybox.option(\"Image.wheel\")) {\r\n      case \"zoom\":\r\n        if (slide.state === \"done\") {\r\n          slide.Panzoom && slide.Panzoom.zoomWithWheel(event);\r\n        }\r\n\r\n        break;\r\n\r\n      case \"close\":\r\n        this.fancybox.close();\r\n\r\n        break;\r\n\r\n      case \"slide\":\r\n        this.fancybox[event.deltaY < 0 ? \"prev\" : \"next\"]();\r\n\r\n        break;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle `click` and `dblclick` events\r\n   * @param {Object} slide\r\n   * @param {Object} event\r\n   */\r\n  onClick(slide, event) {\r\n    // Check that clicks should be allowed\r\n    if (this.fancybox.state !== \"ready\") {\r\n      return;\r\n    }\r\n\r\n    const panzoom = slide.Panzoom;\r\n\r\n    if (\r\n      panzoom &&\r\n      (panzoom.dragPosition.midPoint ||\r\n        panzoom.dragOffset.x !== 0 ||\r\n        panzoom.dragOffset.y !== 0 ||\r\n        panzoom.dragOffset.scale !== 1)\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    if (this.fancybox.Carousel.Panzoom.lockAxis) {\r\n      return false;\r\n    }\r\n\r\n    const process = (action) => {\r\n      switch (action) {\r\n        case \"toggleZoom\":\r\n          event.stopPropagation();\r\n\r\n          slide.Panzoom && slide.Panzoom.zoomWithClick(event);\r\n\r\n          break;\r\n\r\n        case \"close\":\r\n          this.fancybox.close();\r\n\r\n          break;\r\n\r\n        case \"next\":\r\n          event.stopPropagation();\r\n\r\n          this.fancybox.next();\r\n\r\n          break;\r\n      }\r\n    };\r\n\r\n    const clickAction = this.fancybox.option(\"Image.click\");\r\n    const dblclickAction = this.fancybox.option(\"Image.doubleClick\");\r\n\r\n    if (dblclickAction) {\r\n      if (this.clickTimer) {\r\n        clearTimeout(this.clickTimer);\r\n        this.clickTimer = null;\r\n\r\n        process(dblclickAction);\r\n      } else {\r\n        this.clickTimer = setTimeout(() => {\r\n          this.clickTimer = null;\r\n          process(clickAction);\r\n        }, 300);\r\n      }\r\n    } else {\r\n      process(clickAction);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Handle `Carousel.change` event to reset zoom level for any zoomed in/out content\r\n   * and to revel content of the current page\r\n   * @param {Object} fancybox\r\n   * @param {Object} carousel\r\n   */\r\n  onPageChange(fancybox, carousel) {\r\n    const currSlide = fancybox.getSlide();\r\n\r\n    carousel.slides.forEach((slide) => {\r\n      if (!slide.Panzoom || slide.state !== \"done\") {\r\n        return;\r\n      }\r\n\r\n      if (slide.index !== currSlide.index) {\r\n        slide.Panzoom.panTo({\r\n          x: 0,\r\n          y: 0,\r\n          scale: 1,\r\n          friction: 0.8,\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  attach() {\r\n    this.fancybox.on(this.events);\r\n  }\r\n\r\n  detach() {\r\n    this.fancybox.off(this.events);\r\n  }\r\n}\r\n\r\n// Expose defaults\r\nImage.defaults = defaults;\r\n","import { isScrollable } from \"../../../../src/shared/utils/isScrollable.js\";\n\nexport class ScrollLock {\n  constructor(fancybox) {\n    this.fancybox = fancybox;\n    this.viewport = null;\n\n    this.pendingUpdate = null;\n\n    for (const methodName of [\"onReady\", \"onResize\", \"onTouchstart\", \"onTouchmove\"]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n  }\n\n  /**\n   * Process `initLayout` event to attach event listeners and resize viewport if needed\n   */\n  onReady() {\n    //* Support Visual Viewport API\n    // https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API\n    const viewport = window.visualViewport;\n\n    if (viewport) {\n      this.viewport = viewport;\n      this.startY = 0;\n\n      viewport.addEventListener(\"resize\", this.onResize);\n\n      this.updateViewport();\n    }\n\n    //* Prevent bouncing while scrolling on mobile devices\n    window.addEventListener(\"touchstart\", this.onTouchstart, { passive: false });\n    window.addEventListener(\"touchmove\", this.onTouchmove, { passive: false });\n\n    //* Prevent window scrolling with mouse wheel\n    window.addEventListener(\"wheel\", this.onWheel, { passive: false });\n  }\n\n  /**\n   * Handle `resize` event to call `updateViewport`\n   */\n  onResize() {\n    this.updateViewport();\n  }\n\n  /**\n   * Scale $container proportionally to actually fit inside browser,\n   * e.g., disable viewport zooming\n   */\n  updateViewport() {\n    const fancybox = this.fancybox,\n      viewport = this.viewport,\n      scale = viewport.scale || 1,\n      $container = fancybox.$container;\n\n    if (!$container) {\n      return;\n    }\n\n    let width = \"\",\n      height = \"\",\n      transform = \"\";\n\n    if (scale - 1 > 0.1) {\n      width = `${viewport.width * scale}px`;\n      height = `${viewport.height * scale}px`;\n      transform = `translate3d(${viewport.offsetLeft}px, ${viewport.offsetTop}px, 0) scale(${1 / scale})`;\n    }\n\n    $container.style.width = width;\n    $container.style.height = height;\n    $container.style.transform = transform;\n  }\n\n  /**\n   * Handle `touchstart` event to mark drag start position\n   * @param {Object} event\n   */\n  onTouchstart(event) {\n    this.startY = event.touches ? event.touches[0].screenY : event.screenY;\n  }\n\n  /**\n   * Handle `touchmove` event to fix scrolling on mobile devices (iOS)\n   * @param {Object} event\n   */\n  onTouchmove(event) {\n    const startY = this.startY;\n    const zoom = window.innerWidth / window.document.documentElement.clientWidth;\n\n    if (!event.cancelable) {\n      return;\n    }\n\n    if (event.touches.length > 1 || zoom !== 1) {\n      return;\n    }\n\n    const el = isScrollable(event.composedPath()[0]);\n\n    if (!el) {\n      event.preventDefault();\n      return;\n    }\n\n    const style = window.getComputedStyle(el);\n    const height = parseInt(style.getPropertyValue(\"height\"), 10);\n\n    const curY = event.touches ? event.touches[0].screenY : event.screenY;\n\n    const isAtTop = startY <= curY && el.scrollTop === 0;\n    const isAtBottom = startY >= curY && el.scrollHeight - el.scrollTop === height;\n\n    if (isAtTop || isAtBottom) {\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * Handle `wheel` event\n   */\n  onWheel(event) {\n    if (!isScrollable(event.composedPath()[0])) {\n      event.preventDefault();\n    }\n  }\n\n  /**\n   * Clean everything up\n   */\n  cleanup() {\n    if (this.pendingUpdate) {\n      cancelAnimationFrame(this.pendingUpdate);\n      this.pendingUpdate = null;\n    }\n\n    const viewport = this.viewport;\n\n    if (viewport) {\n      viewport.removeEventListener(\"resize\", this.onResize);\n      this.viewport = null;\n    }\n\n    window.removeEventListener(\"touchstart\", this.onTouchstart, false);\n    window.removeEventListener(\"touchmove\", this.onTouchmove, false);\n\n    window.removeEventListener(\"wheel\", this.onWheel, { passive: false });\n  }\n\n  attach() {\n    this.fancybox.on(\"initLayout\", this.onReady);\n  }\n\n  detach() {\n    this.fancybox.off(\"initLayout\", this.onReady);\n\n    this.cleanup();\n  }\n}\n","import { extend } from \"../../../shared/utils/extend.js\";\nimport { Carousel } from \"../../../Carousel/Carousel.js\";\n\nconst defaults = {\n  // The minimum number of images in the gallery to display thumbnails\n  minSlideCount: 2,\n\n  // Minimum screen height to display thumbnails\n  minScreenHeight: 500,\n\n  // Automatically show thumbnails when opened\n  autoStart: true,\n\n  // Keyboard shortcut to toggle thumbnail container\n  key: \"t\",\n\n  // Customize Carousel instance\n  Carousel: {},\n};\n\nexport class Thumbs {\n  constructor(fancybox) {\n    this.fancybox = fancybox;\n\n    this.$container = null;\n    this.state = \"init\";\n\n    for (const methodName of [\"onPrepare\", \"onClosing\", \"onKeydown\"]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n\n    this.events = {\n      prepare: this.onPrepare,\n      closing: this.onClosing,\n      keydown: this.onKeydown,\n    };\n  }\n\n  /**\n   * Process `prepare` event to build the layout\n   */\n  onPrepare() {\n    // Get slides, skip if the total number is less than the minimum\n    const slides = this.getSlides();\n\n    if (slides.length < this.fancybox.option(\"Thumbs.minSlideCount\")) {\n      this.state = \"disabled\";\n      return;\n    }\n\n    if (\n      this.fancybox.option(\"Thumbs.autoStart\") === true &&\n      this.fancybox.Carousel.Panzoom.content.height >= this.fancybox.option(\"Thumbs.minScreenHeight\")\n    ) {\n      this.build();\n    }\n  }\n\n  /**\n   * Process `closing` event to disable all events\n   */\n  onClosing() {\n    if (this.Carousel) {\n      this.Carousel.Panzoom.detachEvents();\n    }\n  }\n\n  /**\n   * Process `keydown` event to enable thumbnail list toggling using keyboard key\n   * @param {Object} fancybox\n   * @param {String} key\n   */\n  onKeydown(fancybox, key) {\n    if (key === fancybox.option(\"Thumbs.key\")) {\n      this.toggle();\n    }\n  }\n\n  /**\n   * Build layout and init thumbnail Carousel\n   */\n  build() {\n    if (this.$container) {\n      return;\n    }\n\n    // Create wrapping element and append to layout\n    const $container = document.createElement(\"div\");\n\n    $container.classList.add(\"fancybox__thumbs\");\n\n    this.fancybox.$carousel.parentNode.insertBefore($container, this.fancybox.$carousel.nextSibling);\n\n    // Initialise thumbnail carousel with all slides\n    this.Carousel = new Carousel(\n      $container,\n      extend(\n        true,\n        {\n          Dots: false,\n          Navigation: false,\n          Sync: {\n            friction: 0,\n          },\n          infinite: false,\n          center: true,\n          fill: true,\n          dragFree: true,\n          slidesPerPage: 1,\n          preload: 1,\n        },\n        this.fancybox.option(\"Thumbs.Carousel\"),\n        {\n          Sync: {\n            target: this.fancybox.Carousel,\n          },\n          slides: this.getSlides(),\n        }\n      )\n    );\n\n    // Slide carousel on wheel event\n    this.Carousel.Panzoom.on(\"wheel\", (panzoom, event) => {\n      event.preventDefault();\n\n      this.fancybox[event.deltaY < 0 ? \"prev\" : \"next\"]();\n    });\n\n    this.$container = $container;\n\n    this.state = \"visible\";\n  }\n\n  /**\n   * Process all fancybox slides to get all thumbnail images\n   */\n  getSlides() {\n    const slides = [];\n\n    for (const slide of this.fancybox.items) {\n      const thumb = slide.thumb;\n\n      if (thumb) {\n        slides.push({\n          html: `<div class=\"fancybox__thumb\" style=\"background-image:url('${thumb}')\"></div>`,\n          customClass: `has-thumb has-${slide.type || \"image\"}`,\n        });\n      }\n    }\n\n    return slides;\n  }\n\n  /**\n   * Toggle visibility of thumbnail list\n   * Tip: you can use `Fancybox.getInstance().plugins.Thumbs.toggle()` from anywhere in your code\n   */\n  toggle() {\n    if (this.state === \"visible\") {\n      this.hide();\n    } else if (this.state === \"hidden\") {\n      this.show();\n    } else {\n      this.build();\n    }\n  }\n\n  /**\n   * Show thumbnail list\n   */\n  show() {\n    if (this.state === \"hidden\") {\n      this.$container.style.display = \"\";\n\n      this.Carousel.Panzoom.attachEvents();\n\n      this.state = \"visible\";\n    }\n  }\n\n  /**\n   * Hide thumbnail list\n   */\n  hide() {\n    if (this.state === \"visible\") {\n      this.Carousel.Panzoom.detachEvents();\n\n      this.$container.style.display = \"none\";\n\n      this.state = \"hidden\";\n    }\n  }\n\n  /**\n   * Reset the state\n   */\n  cleanup() {\n    if (this.Carousel) {\n      this.Carousel.destroy();\n      this.Carousel = null;\n    }\n\n    if (this.$container) {\n      this.$container.remove();\n      this.$container = null;\n    }\n\n    this.state = \"init\";\n  }\n\n  attach() {\n    this.fancybox.on(this.events);\n  }\n\n  detach() {\n    this.fancybox.off(this.events);\n\n    this.cleanup();\n  }\n}\n\n// Expose defaults\nThumbs.defaults = defaults;\n","import { isPlainObject } from \"../../../shared/utils/isPlainObject.js\";\r\nimport { extend } from \"../../../shared/utils/extend.js\";\r\n\r\nimport { Fullscreen } from \"../../../shared/utils/Fullscreen.js\";\r\nimport { Slideshow } from \"../../../shared/utils/Slideshow.js\";\r\n\r\nconst defaults = {\r\n  // What toolbar items to display\r\n  display: [\r\n    \"counter\",\r\n    //\"prev\",\r\n    //\"next\",\r\n    //\"download\",\r\n    \"zoom\",\r\n    \"slideshow\",\r\n    \"fullscreen\",\r\n    \"thumbs\",\r\n    \"close\",\r\n  ],\r\n\r\n  // Only create a toolbar item if there is at least one image in the group\r\n  autoEnable: true,\r\n\r\n  // Toolbar items; can be links, buttons or `div` elements\r\n  items: {\r\n    counter: {\r\n      position: \"left\",\r\n      type: \"div\",\r\n      class: \"fancybox__counter\",\r\n      html: '<span data-fancybox-index=\"\"></span>&nbsp;/&nbsp;<span data-fancybox-count=\"\"></span>',\r\n      attr: { tabindex: -1 },\r\n    },\r\n    prev: {\r\n      type: \"button\",\r\n      class: \"fancybox__button--prev\",\r\n      label: \"PREV\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><path d=\"M15 4l-8 8 8 8\"/></svg>',\r\n      attr: { \"data-fancybox-prev\": \"\" },\r\n    },\r\n    next: {\r\n      type: \"button\",\r\n      class: \"fancybox__button--next\",\r\n      label: \"NEXT\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><path d=\"M8 4l8 8-8 8\"/></svg>',\r\n      attr: { \"data-fancybox-next\": \"\" },\r\n    },\r\n    fullscreen: {\r\n      type: \"button\",\r\n      class: \"fancybox__button--fullscreen\",\r\n      label: \"TOGGLE_FULLSCREEN\",\r\n      html: `<svg viewBox=\"0 0 24 24\">\r\n                <g><path d=\"M3 8 V3h5\"></path><path d=\"M21 8V3h-5\"></path><path d=\"M8 21H3v-5\"></path><path d=\"M16 21h5v-5\"></path></g>\r\n                <g><path d=\"M7 2v5H2M17 2v5h5M2 17h5v5M22 17h-5v5\"/></g>\r\n            </svg>`,\r\n      click: function (event) {\r\n        event.preventDefault();\r\n\r\n        if (Fullscreen.element()) {\r\n          Fullscreen.deactivate();\r\n        } else {\r\n          Fullscreen.activate(this.fancybox.$container);\r\n        }\r\n      },\r\n    },\r\n    slideshow: {\r\n      type: \"button\",\r\n      class: \"fancybox__button--slideshow\",\r\n      label: \"TOGGLE_SLIDESHOW\",\r\n      html: `<svg viewBox=\"0 0 24 24\">\r\n                <g><path d=\"M6 4v16\"/><path d=\"M20 12L6 20\"/><path d=\"M20 12L6 4\"/></g>\r\n                <g><path d=\"M7 4v15M17 4v15\"/></g>\r\n            </svg>`,\r\n      click: function (event) {\r\n        event.preventDefault();\r\n\r\n        this.Slideshow.toggle();\r\n      },\r\n    },\r\n    zoom: {\r\n      type: \"button\",\r\n      class: \"fancybox__button--zoom\",\r\n      label: \"TOGGLE_ZOOM\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><circle cx=\"10\" cy=\"10\" r=\"7\"></circle><path d=\"M16 16 L21 21\"></svg>',\r\n      click: function (event) {\r\n        event.preventDefault();\r\n\r\n        const panzoom = this.fancybox.getSlide().Panzoom;\r\n\r\n        if (panzoom) {\r\n          panzoom.toggleZoom();\r\n        }\r\n      },\r\n    },\r\n    download: {\r\n      type: \"link\",\r\n      label: \"DOWNLOAD\",\r\n      class: \"fancybox__button--download\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><path d=\"M12 15V3m0 12l-4-4m4 4l4-4M2 17l.62 2.48A2 2 0 004.56 21h14.88a2 2 0 001.94-1.51L22 17\"/></svg>',\r\n      click: function (event) {\r\n        event.stopPropagation();\r\n      },\r\n    },\r\n    thumbs: {\r\n      type: \"button\",\r\n      label: \"TOGGLE_THUMBS\",\r\n      class: \"fancybox__button--thumbs\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><circle cx=\"4\" cy=\"4\" r=\"1\" /><circle cx=\"12\" cy=\"4\" r=\"1\" transform=\"rotate(90 12 4)\"/><circle cx=\"20\" cy=\"4\" r=\"1\" transform=\"rotate(90 20 4)\"/><circle cx=\"4\" cy=\"12\" r=\"1\" transform=\"rotate(90 4 12)\"/><circle cx=\"12\" cy=\"12\" r=\"1\" transform=\"rotate(90 12 12)\"/><circle cx=\"20\" cy=\"12\" r=\"1\" transform=\"rotate(90 20 12)\"/><circle cx=\"4\" cy=\"20\" r=\"1\" transform=\"rotate(90 4 20)\"/><circle cx=\"12\" cy=\"20\" r=\"1\" transform=\"rotate(90 12 20)\"/><circle cx=\"20\" cy=\"20\" r=\"1\" transform=\"rotate(90 20 20)\"/></svg>',\r\n      click: function (event) {\r\n        event.stopPropagation();\r\n\r\n        const thumbs = this.fancybox.plugins.Thumbs;\r\n\r\n        if (thumbs) {\r\n          thumbs.toggle();\r\n        }\r\n      },\r\n    },\r\n    close: {\r\n      type: \"button\",\r\n      label: \"CLOSE\",\r\n      class: \"fancybox__button--close\",\r\n      html: '<svg viewBox=\"0 0 24 24\"><path d=\"M20 20L4 4m16 0L4 20\"></path></svg>',\r\n      attr: { \"data-fancybox-close\": \"\", tabindex: 0 },\r\n    },\r\n  },\r\n};\r\n\r\nexport class Toolbar {\r\n  constructor(fancybox) {\r\n    this.fancybox = fancybox;\r\n\r\n    this.$container = null;\r\n    this.state = \"init\";\r\n\r\n    for (const methodName of [\r\n      \"onInit\",\r\n      \"onPrepare\",\r\n      \"onDone\",\r\n      \"onKeydown\",\r\n      \"onClosing\",\r\n      \"onChange\",\r\n      \"onSettle\",\r\n      \"onRefresh\",\r\n    ]) {\r\n      this[methodName] = this[methodName].bind(this);\r\n    }\r\n\r\n    this.events = {\r\n      init: this.onInit,\r\n      prepare: this.onPrepare,\r\n      done: this.onDone,\r\n      keydown: this.onKeydown,\r\n      closing: this.onClosing,\r\n\r\n      // Clear Slideshow when user strts to change current slide\r\n      \"Carousel.change\": this.onChange,\r\n\r\n      // Set timer after carousel changes current slide; deactive if last slide is reached\r\n      \"Carousel.settle\": this.onSettle,\r\n\r\n      // Deactivate Slideshow on user interaction\r\n      \"Carousel.Panzoom.touchStart\": () => this.onRefresh(),\r\n\r\n      \"Image.startAnimation\": (fancybox, slide) => this.onRefresh(slide),\r\n      \"Image.afterUpdate\": (fancybox, slide) => this.onRefresh(slide),\r\n    };\r\n  }\r\n\r\n  onInit() {\r\n    // Disable self if current group does not contain at least one image\r\n    if (this.fancybox.option(\"Toolbar.autoEnable\")) {\r\n      let hasImage = false;\r\n\r\n      for (const item of this.fancybox.items) {\r\n        if (item.type === \"image\") {\r\n          hasImage = true;\r\n          break;\r\n        }\r\n      }\r\n\r\n      if (!hasImage) {\r\n        this.state = \"disabled\";\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Disable the creation of a close button, if one exists in the toolbar\r\n    for (const key of this.fancybox.option(\"Toolbar.display\")) {\r\n      const id = isPlainObject(key) ? key.id : key;\r\n\r\n      if (id === \"close\") {\r\n        this.fancybox.options.closeButton = false;\r\n\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  onPrepare() {\r\n    const fancybox = this.fancybox;\r\n    // Skip if disabled\r\n    if (this.state !== \"init\") {\r\n      return;\r\n    }\r\n\r\n    this.build();\r\n\r\n    this.update();\r\n\r\n    this.Slideshow = new Slideshow(fancybox);\r\n\r\n    if (!fancybox.Carousel.prevPage) {\r\n      if (fancybox.option(\"slideshow.autoStart\")) {\r\n        this.Slideshow.activate();\r\n      }\r\n\r\n      if (fancybox.option(\"fullscreen.autoStart\") && !Fullscreen.element()) {\r\n        try {\r\n          Fullscreen.activate(fancybox.$container);\r\n        } catch (error) {}\r\n      }\r\n    }\r\n  }\r\n\r\n  onFsChange() {\r\n    window.scrollTo(Fullscreen.pageXOffset, Fullscreen.pageYOffset);\r\n  }\r\n\r\n  onSettle() {\r\n    const fancybox = this.fancybox;\r\n    const slideshow = this.Slideshow;\r\n\r\n    if (slideshow && slideshow.isActive()) {\r\n      if (fancybox.getSlide().index === fancybox.Carousel.slides.length - 1 && !fancybox.option(\"infinite\")) {\r\n        slideshow.deactivate();\r\n      } else if (fancybox.getSlide().state === \"done\") {\r\n        slideshow.setTimer();\r\n      }\r\n    }\r\n  }\r\n\r\n  onChange() {\r\n    this.update();\r\n\r\n    if (this.Slideshow && this.Slideshow.isActive()) {\r\n      this.Slideshow.clearTimer();\r\n    }\r\n  }\r\n\r\n  onDone(fancybox, slide) {\r\n    const slideshow = this.Slideshow;\r\n\r\n    if (slide.index === fancybox.getSlide().index) {\r\n      this.update();\r\n\r\n      if (slideshow && slideshow.isActive()) {\r\n        if (!fancybox.option(\"infinite\") && slide.index === fancybox.Carousel.slides.length - 1) {\r\n          slideshow.deactivate();\r\n        } else {\r\n          slideshow.setTimer();\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  onRefresh(slide) {\r\n    if (!slide || slide.index === this.fancybox.getSlide().index) {\r\n      this.update();\r\n\r\n      if (this.Slideshow && this.Slideshow.isActive() && (!slide || slide.state === \"done\")) {\r\n        this.Slideshow.deactivate();\r\n      }\r\n    }\r\n  }\r\n\r\n  onKeydown(fancybox, key, event) {\r\n    if (key === \" \" && this.Slideshow) {\r\n      this.Slideshow.toggle();\r\n\r\n      event.preventDefault();\r\n    }\r\n  }\r\n\r\n  onClosing() {\r\n    if (this.Slideshow) {\r\n      this.Slideshow.deactivate();\r\n    }\r\n\r\n    document.removeEventListener(\"fullscreenchange\", this.onFsChange);\r\n  }\r\n\r\n  /**\r\n   * Create link, button or `div` element for the toolbar\r\n   * @param {Object} obj\r\n   * @returns HTMLElement\r\n   */\r\n  createElement(obj) {\r\n    let $el;\r\n\r\n    if (obj.type === \"div\") {\r\n      $el = document.createElement(\"div\");\r\n    } else {\r\n      $el = document.createElement(obj.type === \"link\" ? \"a\" : \"button\");\r\n      $el.classList.add(\"carousel__button\");\r\n    }\r\n\r\n    $el.innerHTML = obj.html;\r\n\r\n    $el.setAttribute(\"tabindex\", obj.tabindex || 0);\r\n\r\n    if (obj.class) {\r\n      $el.classList.add(...obj.class.split(\" \"));\r\n    }\r\n\r\n    for (const prop in obj.attr) {\r\n      $el.setAttribute(prop, obj.attr[prop]);\r\n    }\r\n\r\n    if (obj.label) {\r\n      $el.setAttribute(\"title\", this.fancybox.localize(`{{${obj.label}}}`));\r\n    }\r\n\r\n    if (obj.click) {\r\n      $el.addEventListener(\"click\", obj.click.bind(this));\r\n    }\r\n\r\n    if (obj.id === \"prev\") {\r\n      $el.setAttribute(\"data-fancybox-prev\", \"\");\r\n    }\r\n\r\n    if (obj.id === \"next\") {\r\n      $el.setAttribute(\"data-fancybox-next\", \"\");\r\n    }\r\n\r\n    const $svg = $el.querySelector(\"svg\");\r\n\r\n    if ($svg) {\r\n      $svg.setAttribute(\"role\", \"img\");\r\n      $svg.setAttribute(\"tabindex\", \"-1\");\r\n      $svg.setAttribute(\"xmlns\", \"http://www.w3.org/2000/svg\");\r\n    }\r\n\r\n    return $el;\r\n  }\r\n\r\n  /**\r\n   * Create all DOM elements\r\n   */\r\n  build() {\r\n    this.cleanup();\r\n\r\n    const all_items = this.fancybox.option(\"Toolbar.items\");\r\n    const all_groups = [\r\n      {\r\n        position: \"left\",\r\n        items: [],\r\n      },\r\n      {\r\n        position: \"center\",\r\n        items: [],\r\n      },\r\n      {\r\n        position: \"right\",\r\n        items: [],\r\n      },\r\n    ];\r\n\r\n    const thumbs = this.fancybox.plugins.Thumbs;\r\n\r\n    // 1st step - group toolbar elements by position\r\n    for (const key of this.fancybox.option(\"Toolbar.display\")) {\r\n      let id, item;\r\n\r\n      if (isPlainObject(key)) {\r\n        id = key.id;\r\n        item = extend({}, all_items[id], key);\r\n      } else {\r\n        id = key;\r\n        item = all_items[id];\r\n      }\r\n\r\n      if ([\"counter\", \"next\", \"prev\", \"slideshow\"].includes(id) && this.fancybox.items.length < 2) {\r\n        continue;\r\n      }\r\n\r\n      if (id === \"fullscreen\") {\r\n        if (!document.fullscreenEnabled || window.fullScreen) {\r\n          continue;\r\n        }\r\n\r\n        document.addEventListener(\"fullscreenchange\", this.onFsChange);\r\n      }\r\n\r\n      if (id === \"thumbs\" && (!thumbs || thumbs.state === \"disabled\")) {\r\n        continue;\r\n      }\r\n\r\n      if (!item) {\r\n        continue;\r\n      }\r\n\r\n      let position = item.position || \"right\";\r\n\r\n      let group = all_groups.find((obj) => obj.position === position);\r\n\r\n      if (group) {\r\n        group.items.push(item);\r\n      }\r\n    }\r\n\r\n    // 2st step - create DOM elements\r\n    const $container = document.createElement(\"div\");\r\n    $container.classList.add(\"fancybox__toolbar\");\r\n\r\n    for (const group of all_groups) {\r\n      if (group.items.length) {\r\n        const $wrap = document.createElement(\"div\");\r\n        $wrap.classList.add(\"fancybox__toolbar__items\");\r\n        $wrap.classList.add(`fancybox__toolbar__items--${group.position}`);\r\n\r\n        for (const obj of group.items) {\r\n          $wrap.appendChild(this.createElement(obj));\r\n        }\r\n\r\n        $container.appendChild($wrap);\r\n      }\r\n    }\r\n\r\n    // Add toolbar container to DOM\r\n    this.fancybox.$carousel.parentNode.insertBefore($container, this.fancybox.$carousel);\r\n\r\n    this.$container = $container;\r\n  }\r\n\r\n  /**\r\n   * Update element state depending on index of current slide\r\n   */\r\n  update() {\r\n    const slide = this.fancybox.getSlide();\r\n    const idx = slide.index;\r\n    const cnt = this.fancybox.items.length;\r\n\r\n    // Download links\r\n    // ====\r\n    const src = slide.downloadSrc || (slide.type === \"image\" && !slide.error ? slide.src : null);\r\n\r\n    for (const $el of this.fancybox.$container.querySelectorAll(\"a.fancybox__button--download\")) {\r\n      if (src) {\r\n        $el.removeAttribute(\"disabled\");\r\n        $el.removeAttribute(\"tabindex\");\r\n\r\n        $el.setAttribute(\"href\", src);\r\n        $el.setAttribute(\"download\", src);\r\n        $el.setAttribute(\"target\", \"_blank\");\r\n      } else {\r\n        $el.setAttribute(\"disabled\", \"\");\r\n        $el.setAttribute(\"tabindex\", -1);\r\n\r\n        $el.removeAttribute(\"href\");\r\n        $el.removeAttribute(\"download\");\r\n      }\r\n    }\r\n\r\n    // Zoom button\r\n    // ===\r\n    const panzoom = slide.Panzoom;\r\n    const canZoom = panzoom && panzoom.option(\"maxScale\") > panzoom.option(\"baseScale\");\r\n\r\n    for (const $el of this.fancybox.$container.querySelectorAll(\".fancybox__button--zoom\")) {\r\n      if (canZoom) {\r\n        $el.removeAttribute(\"disabled\");\r\n      } else {\r\n        $el.setAttribute(\"disabled\", \"\");\r\n      }\r\n    }\r\n\r\n    // Counter\r\n    // ====\r\n    for (const $el of this.fancybox.$container.querySelectorAll(\"[data-fancybox-index]\")) {\r\n      $el.innerHTML = slide.index + 1;\r\n    }\r\n\r\n    for (const $el of this.fancybox.$container.querySelectorAll(\"[data-fancybox-count]\")) {\r\n      $el.innerHTML = cnt;\r\n    }\r\n\r\n    // Disable previous/next links if gallery is not infinite and has reached start/end\r\n    // ===\r\n    if (!this.fancybox.option(\"infinite\")) {\r\n      for (const $el of this.fancybox.$container.querySelectorAll(\"[data-fancybox-prev]\")) {\r\n        if (idx === 0) {\r\n          $el.setAttribute(\"disabled\", \"\");\r\n        } else {\r\n          $el.removeAttribute(\"disabled\");\r\n        }\r\n      }\r\n\r\n      for (const $el of this.fancybox.$container.querySelectorAll(\"[data-fancybox-next]\")) {\r\n        if (idx === cnt - 1) {\r\n          $el.setAttribute(\"disabled\", \"\");\r\n        } else {\r\n          $el.removeAttribute(\"disabled\");\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  cleanup() {\r\n    if (this.Slideshow && this.Slideshow.isActive()) {\r\n      this.Slideshow.clearTimer();\r\n    }\r\n\r\n    if (this.$container) {\r\n      this.$container.remove();\r\n    }\r\n\r\n    this.$container = null;\r\n  }\r\n\r\n  attach() {\r\n    this.fancybox.on(this.events);\r\n  }\r\n\r\n  detach() {\r\n    this.fancybox.off(this.events);\r\n\r\n    this.cleanup();\r\n  }\r\n}\r\n\r\n// Expose defaults\r\nToolbar.defaults = defaults;\r\n","import { ScrollLock } from \"./ScrollLock/ScrollLock.js\";\nimport { Thumbs } from \"./Thumbs/Thumbs.js\";\nimport { Html } from \"./Html/Html.js\";\nimport { Image } from \"./Image/Image.js\";\nimport { Hash } from \"./Hash/Hash.js\";\nimport { Toolbar } from \"./Toolbar/Toolbar.js\";\n\nexport const Plugins = {\n  ScrollLock,\n  Thumbs,\n  Html,\n  Toolbar,\n  Image,\n  Hash,\n};\n","import { extend } from \"../shared/utils/extend.js\";\nimport { round } from \"../shared/utils/round.js\";\nimport { isScrollable } from \"../shared/utils/isScrollable.js\";\n\nimport { ResizeObserver } from \"../shared/utils/ResizeObserver.js\";\nimport { PointerTracker, getMidpoint, getDistance } from \"../shared/utils/PointerTracker.js\";\n\nimport { getTextNodeFromPoint } from \"../shared/utils/getTextNodeFromPoint.js\";\n\nimport { getFullWidth, getFullHeight, calculateAspectRatioFit } from \"../shared/utils/getDimensions.js\";\n\nimport { Base } from \"../shared/Base/Base.js\";\n\nimport { Plugins } from \"./plugins/index.js\";\n\nconst defaults = {\n  // Enable touch guestures\n  touch: true,\n\n  // Enable zooming\n  zoom: true,\n\n  // Enable pinch gesture to zoom in/out using two fingers\n  pinchToZoom: true,\n\n  // Disable dragging if scale level is equal to value of `baseScale` option\n  panOnlyZoomed: false,\n\n  // Lock axis while dragging,\n  // possible values: false | \"x\" | \"y\" | \"xy\"\n  lockAxis: false,\n\n  // * All friction values are inside [0, 1) interval,\n  // * where 0 would change instantly, but 0.99 would update extremely slowly\n\n  // Friction while panning/dragging\n  friction: 0.64,\n\n  // Friction while decelerating after drag end\n  decelFriction: 0.88,\n\n  // Friction while scaling\n  zoomFriction: 0.74,\n\n  // Bounciness after hitting the edge\n  bounceForce: 0.2,\n\n  // Initial scale level\n  baseScale: 1,\n\n  // Minimum scale level\n  minScale: 1,\n\n  // Maximum scale level\n  maxScale: 2,\n\n  // Default scale step while zooming\n  step: 0.5,\n\n  // Allow to select text,\n  // if enabled, dragging will be disabled when text selection is detected\n  textSelection: false,\n\n  // Add `click` event listener,\n  // possible values: true | false | function | \"toggleZoom\"\n  click: \"toggleZoom\",\n\n  // Add `wheel` event listener,\n  // possible values: true | false | function |  \"zoom\"\n  wheel: \"zoom\",\n\n  // Value for zoom on mouse wheel\n  wheelFactor: 42,\n\n  // Number of wheel events after which it should stop preventing default behaviour of mouse wheel\n  wheelLimit: 5,\n\n  // Class name added to `$viewport` element to indicate if content is draggable\n  draggableClass: \"is-draggable\",\n\n  // Class name added to `$viewport` element to indicate that user is currently dragging\n  draggingClass: \"is-dragging\",\n\n  // Content will be scaled by this number,\n  // this can also be a function which should return a number, for example:\n  // ratio: function() { return 1 / (window.devicePixelRatio || 1) }\n  ratio: 1,\n};\n\nexport class Panzoom extends Base {\n  /**\n   * Panzoom constructor\n   * @constructs Panzoom\n   * @param {HTMLElement} $viewport Panzoom container\n   * @param {Object} [options] Options for Panzoom\n   */\n  constructor($container, options = {}) {\n    super(extend(true, {}, defaults, options));\n\n    this.state = \"init\";\n\n    this.$container = $container;\n\n    // Bind event handlers for referencability\n    for (const methodName of [\"onLoad\", \"onWheel\", \"onClick\"]) {\n      this[methodName] = this[methodName].bind(this);\n    }\n\n    this.initLayout();\n\n    this.resetValues();\n\n    this.attachPlugins(Panzoom.Plugins);\n\n    this.trigger(\"init\");\n\n    this.updateMetrics();\n\n    this.attachEvents();\n\n    this.trigger(\"ready\");\n\n    if (this.option(\"centerOnStart\") === false) {\n      this.state = \"ready\";\n    } else {\n      this.panTo({\n        friction: 0,\n      });\n    }\n\n    $container.__Panzoom = this;\n  }\n\n  /**\n   * Create references to container, viewport and content elements\n   */\n  initLayout() {\n    const $container = this.$container;\n\n    // Make sure content element exists\n    if (!($container instanceof HTMLElement)) {\n      throw new Error(\"Panzoom: Container not found\");\n    }\n\n    const $content = this.option(\"content\") || $container.querySelector(\".panzoom__content\");\n\n    // Make sure content element exists\n    if (!$content) {\n      throw new Error(\"Panzoom: Content not found\");\n    }\n\n    this.$content = $content;\n\n    let $viewport = this.option(\"viewport\") || $container.querySelector(\".panzoom__viewport\");\n\n    if (!$viewport && this.option(\"wrapInner\") !== false) {\n      $viewport = document.createElement(\"div\");\n      $viewport.classList.add(\"panzoom__viewport\");\n\n      $viewport.append(...$container.childNodes);\n\n      $container.appendChild($viewport);\n    }\n\n    this.$viewport = $viewport || $content.parentNode;\n  }\n\n  /**\n   * Restore instance variables to default values\n   */\n  resetValues() {\n    this.updateRate = this.option(\"updateRate\", /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) ? 250 : 24);\n\n    this.container = {\n      width: 0,\n      height: 0,\n    };\n\n    this.viewport = {\n      width: 0,\n      height: 0,\n    };\n\n    this.content = {\n      // Full content dimensions (naturalWidth/naturalHeight for images)\n      origWidth: 0,\n      origHeight: 0,\n\n      // Current dimensions of the content\n      width: 0,\n      height: 0,\n\n      // Current position; these values reflect CSS `transform` value\n      x: this.option(\"x\", 0),\n      y: this.option(\"y\", 0),\n\n      // Current scale; does not reflect CSS `transform` value\n      scale: this.option(\"baseScale\"),\n    };\n\n    // End values of current pan / zoom animation\n    this.transform = {\n      x: 0,\n      y: 0,\n      scale: 1,\n    };\n\n    this.resetDragPosition();\n  }\n\n  /**\n   * Handle `load` event\n   * @param {Event} event\n   */\n  onLoad(event) {\n    this.updateMetrics();\n\n    this.panTo({ scale: this.option(\"baseScale\"), friction: 0 });\n\n    this.trigger(\"load\", event);\n  }\n\n  /**\n   * Handle `click` event\n   * @param {Event} event\n   */\n  onClick(event) {\n    if (event.defaultPrevented) {\n      return;\n    }\n\n    if (document.activeElement && document.activeElement.closest(\"[contenteditable]\")) {\n      return;\n    }\n\n    // Skip if text is selected\n    if (\n      this.option(\"textSelection\") &&\n      window.getSelection().toString().length &&\n      !(event.target && event.target.hasAttribute(\"data-fancybox-close\"))\n    ) {\n      event.stopPropagation();\n      return;\n    }\n\n    const rect = this.$content.getClientRects()[0];\n\n    // Check if container has changed position (for example, when current instance is inside another one)\n    if (this.state !== \"ready\") {\n      if (\n        this.dragPosition.midPoint ||\n        Math.abs(rect.top - this.dragStart.rect.top) > 1 ||\n        Math.abs(rect.left - this.dragStart.rect.left) > 1\n      ) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        return;\n      }\n    }\n\n    if (this.trigger(\"click\", event) === false) {\n      return;\n    }\n\n    if (this.option(\"zoom\") && this.option(\"click\") === \"toggleZoom\") {\n      event.preventDefault();\n      event.stopPropagation();\n\n      this.zoomWithClick(event);\n    }\n  }\n\n  /**\n   * Handle `wheel` event\n   * @param {Event} event\n   */\n  onWheel(event) {\n    if (this.trigger(\"wheel\", event) === false) {\n      return;\n    }\n\n    if (this.option(\"zoom\") && this.option(\"wheel\")) {\n      this.zoomWithWheel(event);\n    }\n  }\n\n  /**\n   * Change zoom level depending on scroll direction\n   * @param {Event} event `wheel` event\n   */\n  zoomWithWheel(event) {\n    if (this.changedDelta === undefined) {\n      this.changedDelta = 0;\n    }\n\n    const delta = Math.max(-1, Math.min(1, -event.deltaY || -event.deltaX || event.wheelDelta || -event.detail));\n    const scale = this.content.scale;\n\n    let newScale = (scale * (100 + delta * this.option(\"wheelFactor\"))) / 100;\n\n    if (\n      (delta < 0 && Math.abs(scale - this.option(\"minScale\")) < 0.01) ||\n      (delta > 0 && Math.abs(scale - this.option(\"maxScale\")) < 0.01)\n    ) {\n      this.changedDelta += Math.abs(delta);\n      newScale = scale;\n    } else {\n      this.changedDelta = 0;\n      newScale = Math.max(Math.min(newScale, this.option(\"maxScale\")), this.option(\"minScale\"));\n    }\n\n    if (this.changedDelta > this.option(\"wheelLimit\")) {\n      return;\n    }\n\n    event.preventDefault();\n\n    if (newScale === scale) {\n      return;\n    }\n\n    const rect = this.$content.getBoundingClientRect();\n\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n\n    this.zoomTo(newScale, { x, y });\n  }\n\n  /**\n   * Change zoom level depending on click coordinates\n   * @param {Event} event `click` event\n   */\n  zoomWithClick(event) {\n    const rect = this.$content.getClientRects()[0];\n\n    const x = event.clientX - rect.left;\n    const y = event.clientY - rect.top;\n\n    this.toggleZoom({ x, y });\n  }\n\n  /**\n   * Attach load, wheel and click event listeners, initialize `resizeObserver` and `PointerTracker`\n   */\n  attachEvents() {\n    this.$content.addEventListener(\"load\", this.onLoad);\n\n    this.$container.addEventListener(\"wheel\", this.onWheel, { passive: false });\n    this.$container.addEventListener(\"click\", this.onClick, { passive: false });\n\n    this.initObserver();\n\n    const pointerTracker = new PointerTracker(this.$container, {\n      start: (pointer, event) => {\n        if (!this.option(\"touch\")) {\n          return false;\n        }\n\n        if (this.velocity.scale < 0) {\n          return false;\n        }\n\n        const target = event.composedPath()[0];\n\n        if (!pointerTracker.currentPointers.length) {\n          const ignoreClickedElement =\n            [\"BUTTON\", \"TEXTAREA\", \"OPTION\", \"INPUT\", \"SELECT\", \"VIDEO\"].indexOf(target.nodeName) !== -1;\n\n          if (ignoreClickedElement) {\n            return false;\n          }\n\n          // Allow text selection\n          if (this.option(\"textSelection\") && getTextNodeFromPoint(target, pointer.clientX, pointer.clientY)) {\n            return false;\n          }\n        }\n\n        if (isScrollable(target)) {\n          return false;\n        }\n\n        if (this.trigger(\"touchStart\", event) === false) {\n          return false;\n        }\n\n        if (event.type === \"mousedown\") {\n          event.preventDefault();\n        }\n\n        this.state = \"pointerdown\";\n\n        this.resetDragPosition();\n\n        this.dragPosition.midPoint = null;\n        this.dragPosition.time = Date.now();\n\n        return true;\n      },\n      move: (previousPointers, currentPointers, event) => {\n        if (this.state !== \"pointerdown\") {\n          return;\n        }\n\n        if (this.trigger(\"touchMove\", event) === false) {\n          event.preventDefault();\n          return;\n        }\n\n        // Disable touch action if current zoom level is below base level\n        if (\n          currentPointers.length < 2 &&\n          this.option(\"panOnlyZoomed\") === true &&\n          this.content.width <= this.viewport.width &&\n          this.content.height <= this.viewport.height &&\n          this.transform.scale <= this.option(\"baseScale\")\n        ) {\n          return;\n        }\n\n        if (currentPointers.length > 1 && (!this.option(\"zoom\") || this.option(\"pinchToZoom\") === false)) {\n          return;\n        }\n\n        const prevMidpoint = getMidpoint(previousPointers[0], previousPointers[1]);\n        const newMidpoint = getMidpoint(currentPointers[0], currentPointers[1]);\n\n        const panX = newMidpoint.clientX - prevMidpoint.clientX;\n        const panY = newMidpoint.clientY - prevMidpoint.clientY;\n\n        const prevDistance = getDistance(previousPointers[0], previousPointers[1]);\n        const newDistance = getDistance(currentPointers[0], currentPointers[1]);\n\n        const scaleDiff = prevDistance && newDistance ? newDistance / prevDistance : 1;\n\n        this.dragOffset.x += panX;\n        this.dragOffset.y += panY;\n\n        this.dragOffset.scale *= scaleDiff;\n\n        this.dragOffset.time = Date.now() - this.dragPosition.time;\n\n        const axisToLock = this.dragStart.scale === 1 && this.option(\"lockAxis\");\n\n        if (axisToLock && !this.lockAxis) {\n          if (Math.abs(this.dragOffset.x) < 6 && Math.abs(this.dragOffset.y) < 6) {\n            event.preventDefault();\n            return;\n          }\n\n          const angle = Math.abs((Math.atan2(this.dragOffset.y, this.dragOffset.x) * 180) / Math.PI);\n\n          this.lockAxis = angle > 45 && angle < 135 ? \"y\" : \"x\";\n        }\n\n        if (axisToLock !== \"xy\" && this.lockAxis === \"y\") {\n          return;\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n\n        event.stopImmediatePropagation();\n\n        if (this.lockAxis) {\n          this.dragOffset[this.lockAxis === \"x\" ? \"y\" : \"x\"] = 0;\n        }\n\n        this.$container.classList.add(this.option(\"draggingClass\"));\n\n        if (!(this.transform.scale === this.option(\"baseScale\") && this.lockAxis === \"y\")) {\n          this.dragPosition.x = this.dragStart.x + this.dragOffset.x;\n        }\n\n        if (!(this.transform.scale === this.option(\"baseScale\") && this.lockAxis === \"x\")) {\n          this.dragPosition.y = this.dragStart.y + this.dragOffset.y;\n        }\n\n        this.dragPosition.scale = this.dragStart.scale * this.dragOffset.scale;\n\n        if (currentPointers.length > 1) {\n          const startPoint = getMidpoint(pointerTracker.startPointers[0], pointerTracker.startPointers[1]);\n\n          const xPos = startPoint.clientX - this.dragStart.rect.x;\n          const yPos = startPoint.clientY - this.dragStart.rect.y;\n\n          const { deltaX, deltaY } = this.getZoomDelta(this.content.scale * this.dragOffset.scale, xPos, yPos);\n\n          this.dragPosition.x -= deltaX;\n          this.dragPosition.y -= deltaY;\n\n          this.dragPosition.midPoint = newMidpoint;\n        } else {\n          this.setDragResistance();\n        }\n\n        // Update final position\n        this.transform = {\n          x: this.dragPosition.x,\n          y: this.dragPosition.y,\n          scale: this.dragPosition.scale,\n        };\n\n        this.startAnimation();\n      },\n      end: (pointer, event) => {\n        if (this.state !== \"pointerdown\") {\n          return;\n        }\n\n        this._dragOffset = { ...this.dragOffset };\n\n        if (pointerTracker.currentPointers.length) {\n          this.resetDragPosition();\n\n          return;\n        }\n\n        this.state = \"decel\";\n        this.friction = this.option(\"decelFriction\");\n\n        this.recalculateTransform();\n\n        this.$container.classList.remove(this.option(\"draggingClass\"));\n\n        if (this.trigger(\"touchEnd\", event) === false) {\n          return;\n        }\n\n        if (this.state !== \"decel\") {\n          return;\n        }\n\n        // * Check if scaled content past limits\n\n        // Below minimum\n        const minScale = this.option(\"minScale\");\n\n        if (this.transform.scale < minScale) {\n          this.zoomTo(minScale, { friction: 0.64 });\n\n          return;\n        }\n\n        // Exceed maximum\n        const maxScale = this.option(\"maxScale\");\n\n        if (this.transform.scale - maxScale > 0.01) {\n          const last = this.dragPosition.midPoint || pointer;\n          const rect = this.$content.getClientRects()[0];\n\n          this.zoomTo(maxScale, {\n            friction: 0.64,\n            x: last.clientX - rect.left,\n            y: last.clientY - rect.top,\n          });\n\n          return;\n        }\n      },\n    });\n\n    this.pointerTracker = pointerTracker;\n  }\n\n  initObserver() {\n    if (this.resizeObserver) {\n      return;\n    }\n\n    this.resizeObserver = new ResizeObserver(() => {\n      if (this.updateTimer) {\n        return;\n      }\n\n      this.updateTimer = setTimeout(() => {\n        const rect = this.$container.getBoundingClientRect();\n\n        if (!(rect.width && rect.height)) {\n          this.updateTimer = null;\n          return;\n        }\n\n        // Check to see if there are any changes\n        if (Math.abs(rect.width - this.container.width) > 1 || Math.abs(rect.height - this.container.height) > 1) {\n          if (this.isAnimating()) {\n            this.endAnimation(true);\n          }\n\n          this.updateMetrics();\n\n          this.panTo({\n            x: this.content.x,\n            y: this.content.y,\n            scale: this.option(\"baseScale\"),\n            friction: 0,\n          });\n        }\n\n        this.updateTimer = null;\n      }, this.updateRate);\n    });\n\n    this.resizeObserver.observe(this.$container);\n  }\n\n  /**\n   * Restore drag related variables to default values\n   */\n  resetDragPosition() {\n    this.lockAxis = null;\n    this.friction = this.option(\"friction\");\n\n    this.velocity = {\n      x: 0,\n      y: 0,\n      scale: 0,\n    };\n\n    const { x, y, scale } = this.content;\n\n    this.dragStart = {\n      rect: this.$content.getBoundingClientRect(),\n      x,\n      y,\n      scale,\n    };\n\n    this.dragPosition = {\n      ...this.dragPosition,\n      x,\n      y,\n      scale,\n    };\n\n    this.dragOffset = {\n      x: 0,\n      y: 0,\n      scale: 1,\n      time: 0,\n    };\n  }\n\n  /**\n   * Trigger update events before/after resizing content and viewport\n   * @param {Boolean} silently Should trigger `afterUpdate` event at the end\n   */\n  updateMetrics(silently) {\n    if (silently !== true) {\n      this.trigger(\"beforeUpdate\");\n    }\n\n    const $container = this.$container;\n    const $content = this.$content;\n    const $viewport = this.$viewport;\n\n    const contentIsImage = $content instanceof HTMLImageElement;\n    const contentIsZoomable = this.option(\"zoom\");\n    const shouldResizeParent = this.option(\"resizeParent\", contentIsZoomable);\n\n    let width = this.option(\"width\");\n    let height = this.option(\"height\");\n\n    let origWidth = width || getFullWidth($content);\n    let origHeight = height || getFullHeight($content);\n\n    Object.assign($content.style, {\n      width: width ? `${width}px` : \"\",\n      height: height ? `${height}px` : \"\",\n      maxWidth: \"\",\n      maxHeight: \"\",\n    });\n\n    if (shouldResizeParent) {\n      Object.assign($viewport.style, { width: \"\", height: \"\" });\n    }\n\n    const ratio = this.option(\"ratio\");\n\n    origWidth = round(origWidth * ratio);\n    origHeight = round(origHeight * ratio);\n\n    width = origWidth;\n    height = origHeight;\n\n    const contentRect = $content.getBoundingClientRect();\n    const viewportRect = $viewport.getBoundingClientRect();\n\n    const containerRect = $viewport == $container ? viewportRect : $container.getBoundingClientRect();\n\n    let viewportWidth = Math.max($viewport.offsetWidth, round(viewportRect.width));\n    let viewportHeight = Math.max($viewport.offsetHeight, round(viewportRect.height));\n\n    let viewportStyles = window.getComputedStyle($viewport);\n    viewportWidth -= parseFloat(viewportStyles.paddingLeft) + parseFloat(viewportStyles.paddingRight);\n    viewportHeight -= parseFloat(viewportStyles.paddingTop) + parseFloat(viewportStyles.paddingBottom);\n\n    this.viewport.width = viewportWidth;\n    this.viewport.height = viewportHeight;\n\n    if (contentIsZoomable) {\n      if (Math.abs(origWidth - contentRect.width) > 0.1 || Math.abs(origHeight - contentRect.height) > 0.1) {\n        const rez = calculateAspectRatioFit(\n          origWidth,\n          origHeight,\n          Math.min(origWidth, contentRect.width),\n          Math.min(origHeight, contentRect.height)\n        );\n\n        width = round(rez.width);\n        height = round(rez.height);\n      }\n\n      Object.assign($content.style, {\n        width: `${width}px`,\n        height: `${height}px`,\n        transform: \"\",\n      });\n    }\n\n    if (shouldResizeParent) {\n      Object.assign($viewport.style, { width: `${width}px`, height: `${height}px` });\n\n      this.viewport = { ...this.viewport, width, height };\n    }\n\n    if (contentIsImage && contentIsZoomable && typeof this.options.maxScale !== \"function\") {\n      const maxScale = this.option(\"maxScale\");\n\n      this.options.maxScale = function () {\n        return this.content.origWidth > 0 && this.content.fitWidth > 0\n          ? this.content.origWidth / this.content.fitWidth\n          : maxScale;\n      };\n    }\n\n    this.content = {\n      ...this.content,\n      origWidth,\n      origHeight,\n      fitWidth: width,\n      fitHeight: height,\n      width,\n      height,\n      scale: 1,\n      isZoomable: contentIsZoomable,\n    };\n\n    this.container = { width: containerRect.width, height: containerRect.height };\n\n    if (silently !== true) {\n      this.trigger(\"afterUpdate\");\n    }\n  }\n\n  /**\n   * Increase zoom level\n   * @param {Number} [step] Zoom ratio; `0.5` would increase scale from 1 to 1.5\n   */\n  zoomIn(step) {\n    this.zoomTo(this.content.scale + (step || this.option(\"step\")));\n  }\n\n  /**\n   * Decrease zoom level\n   * @param {Number} [step] Zoom ratio; `0.5` would decrease scale from 1.5 to 1\n   */\n  zoomOut(step) {\n    this.zoomTo(this.content.scale - (step || this.option(\"step\")));\n  }\n\n  /**\n   * Toggles zoom level between max and base levels\n   * @param {Object} [options] Additional options\n   */\n  toggleZoom(props = {}) {\n    const maxScale = this.option(\"maxScale\");\n    const baseScale = this.option(\"baseScale\");\n\n    const scale = this.content.scale > baseScale + (maxScale - baseScale) * 0.5 ? baseScale : maxScale;\n\n    this.zoomTo(scale, props);\n  }\n\n  /**\n   * Animate to given zoom level\n   * @param {Number} scale New zoom level\n   * @param {Object} [options] Additional options\n   */\n  zoomTo(scale = this.option(\"baseScale\"), { x = null, y = null } = {}) {\n    scale = Math.max(Math.min(scale, this.option(\"maxScale\")), this.option(\"minScale\"));\n\n    // Adjust zoom position\n    const currentScale = round(this.content.scale / (this.content.width / this.content.fitWidth), 10000000);\n\n    if (x === null) {\n      x = this.content.width * currentScale * 0.5;\n    }\n\n    if (y === null) {\n      y = this.content.height * currentScale * 0.5;\n    }\n\n    const { deltaX, deltaY } = this.getZoomDelta(scale, x, y);\n\n    x = this.content.x - deltaX;\n    y = this.content.y - deltaY;\n\n    this.panTo({ x, y, scale, friction: this.option(\"zoomFriction\") });\n  }\n\n  /**\n   * Calculate difference for top/left values if content would scale at given coordinates\n   * @param {Number} scale\n   * @param {Number} x\n   * @param {Number} y\n   * @returns {Object}\n   */\n  getZoomDelta(scale, x = 0, y = 0) {\n    const currentWidth = this.content.fitWidth * this.content.scale;\n    const currentHeight = this.content.fitHeight * this.content.scale;\n\n    const percentXInCurrentBox = x > 0 && currentWidth ? x / currentWidth : 0;\n    const percentYInCurrentBox = y > 0 && currentHeight ? y / currentHeight : 0;\n\n    const nextWidth = this.content.fitWidth * scale;\n    const nextHeight = this.content.fitHeight * scale;\n\n    const deltaX = (nextWidth - currentWidth) * percentXInCurrentBox;\n    const deltaY = (nextHeight - currentHeight) * percentYInCurrentBox;\n\n    return { deltaX, deltaY };\n  }\n\n  /**\n   * Animate to given positon and/or zoom level\n   * @param {Object} [options] Additional options\n   */\n  panTo({\n    x = this.content.x,\n    y = this.content.y,\n    scale,\n    friction = this.option(\"friction\"),\n    ignoreBounds = false,\n  } = {}) {\n    scale = scale || this.content.scale || 1;\n\n    if (!ignoreBounds) {\n      const { boundX, boundY } = this.getBounds(scale);\n\n      if (boundX) {\n        x = Math.max(Math.min(x, boundX.to), boundX.from);\n      }\n\n      if (boundY) {\n        y = Math.max(Math.min(y, boundY.to), boundY.from);\n      }\n    }\n\n    this.friction = friction;\n\n    this.transform = {\n      ...this.transform,\n      x,\n      y,\n      scale,\n    };\n\n    if (friction) {\n      this.state = \"panning\";\n\n      this.velocity = {\n        x: (1 / this.friction - 1) * (x - this.content.x),\n        y: (1 / this.friction - 1) * (y - this.content.y),\n        scale: (1 / this.friction - 1) * (scale - this.content.scale),\n      };\n\n      this.startAnimation();\n    } else {\n      this.endAnimation();\n    }\n  }\n\n  /**\n   * Start animation loop\n   */\n  startAnimation() {\n    if (!this.rAF) {\n      this.trigger(\"startAnimation\");\n    } else {\n      cancelAnimationFrame(this.rAF);\n    }\n\n    this.rAF = requestAnimationFrame(() => this.animate());\n  }\n\n  /**\n   * Process animation frame\n   */\n  animate() {\n    this.setEdgeForce();\n    this.setDragForce();\n\n    this.velocity.x *= this.friction;\n    this.velocity.y *= this.friction;\n\n    this.velocity.scale *= this.friction;\n\n    this.content.x += this.velocity.x;\n    this.content.y += this.velocity.y;\n\n    this.content.scale += this.velocity.scale;\n\n    if (this.isAnimating()) {\n      this.setTransform();\n    } else if (this.state !== \"pointerdown\") {\n      this.endAnimation();\n\n      return;\n    }\n\n    this.rAF = requestAnimationFrame(() => this.animate());\n  }\n\n  /**\n   * Calculate boundaries\n   */\n  getBounds(scale) {\n    let boundX = this.boundX;\n    let boundY = this.boundY;\n\n    if (boundX !== undefined && boundY !== undefined) {\n      return { boundX, boundY };\n    }\n\n    boundX = { from: 0, to: 0 };\n    boundY = { from: 0, to: 0 };\n\n    scale = scale || this.transform.scale;\n\n    const width = this.content.fitWidth * scale;\n    const height = this.content.fitHeight * scale;\n\n    const viewportWidth = this.viewport.width;\n    const viewportHeight = this.viewport.height;\n\n    if (width < viewportWidth) {\n      const deltaX = round((viewportWidth - width) * 0.5);\n\n      boundX.from = deltaX;\n      boundX.to = deltaX;\n    } else {\n      boundX.from = round(viewportWidth - width);\n    }\n\n    if (height < viewportHeight) {\n      const deltaY = (viewportHeight - height) * 0.5;\n\n      boundY.from = deltaY;\n      boundY.to = deltaY;\n    } else {\n      boundY.from = round(viewportHeight - height);\n    }\n\n    return { boundX, boundY };\n  }\n\n  /**\n   * Change animation velocity if boundary is reached\n   */\n  setEdgeForce() {\n    if (this.state !== \"decel\") {\n      return;\n    }\n\n    const bounceForce = this.option(\"bounceForce\");\n\n    const { boundX, boundY } = this.getBounds(Math.max(this.transform.scale, this.content.scale));\n\n    let pastLeft, pastRight, pastTop, pastBottom;\n\n    if (boundX) {\n      pastLeft = this.content.x < boundX.from;\n      pastRight = this.content.x > boundX.to;\n    }\n\n    if (boundY) {\n      pastTop = this.content.y < boundY.from;\n      pastBottom = this.content.y > boundY.to;\n    }\n\n    if (pastLeft || pastRight) {\n      const bound = pastLeft ? boundX.from : boundX.to;\n      const distance = bound - this.content.x;\n\n      let force = distance * bounceForce;\n\n      const restX = this.content.x + (this.velocity.x + force) / this.friction;\n\n      if (restX >= boundX.from && restX <= boundX.to) {\n        force += this.velocity.x;\n      }\n\n      this.velocity.x = force;\n\n      this.recalculateTransform();\n    }\n\n    if (pastTop || pastBottom) {\n      const bound = pastTop ? boundY.from : boundY.to;\n      const distance = bound - this.content.y;\n\n      let force = distance * bounceForce;\n\n      const restY = this.content.y + (force + this.velocity.y) / this.friction;\n\n      if (restY >= boundY.from && restY <= boundY.to) {\n        force += this.velocity.y;\n      }\n\n      this.velocity.y = force;\n\n      this.recalculateTransform();\n    }\n  }\n\n  /**\n   * Change dragging position if boundary is reached\n   */\n  setDragResistance() {\n    if (this.state !== \"pointerdown\") {\n      return;\n    }\n\n    const { boundX, boundY } = this.getBounds(this.dragPosition.scale);\n\n    let pastLeft, pastRight, pastTop, pastBottom;\n\n    if (boundX) {\n      pastLeft = this.dragPosition.x < boundX.from;\n      pastRight = this.dragPosition.x > boundX.to;\n    }\n\n    if (boundY) {\n      pastTop = this.dragPosition.y < boundY.from;\n      pastBottom = this.dragPosition.y > boundY.to;\n    }\n\n    if ((pastLeft || pastRight) && !(pastLeft && pastRight)) {\n      const bound = pastLeft ? boundX.from : boundX.to;\n      const distance = bound - this.dragPosition.x;\n\n      this.dragPosition.x = bound - distance * 0.3;\n    }\n\n    if ((pastTop || pastBottom) && !(pastTop && pastBottom)) {\n      const bound = pastTop ? boundY.from : boundY.to;\n      const distance = bound - this.dragPosition.y;\n\n      this.dragPosition.y = bound - distance * 0.3;\n    }\n  }\n\n  /**\n   * Set velocity to move content to drag position\n   */\n  setDragForce() {\n    if (this.state === \"pointerdown\") {\n      this.velocity.x = this.dragPosition.x - this.content.x;\n      this.velocity.y = this.dragPosition.y - this.content.y;\n      this.velocity.scale = this.dragPosition.scale - this.content.scale;\n    }\n  }\n\n  /**\n   * Update end values based on current velocity and friction;\n   */\n  recalculateTransform() {\n    this.transform.x = this.content.x + this.velocity.x / (1 / this.friction - 1);\n    this.transform.y = this.content.y + this.velocity.y / (1 / this.friction - 1);\n    this.transform.scale = this.content.scale + this.velocity.scale / (1 / this.friction - 1);\n  }\n\n  /**\n   * Check if content is currently animating\n   * @returns {Boolean}\n   */\n  isAnimating() {\n    return !!(\n      this.friction &&\n      (Math.abs(this.velocity.x) > 0.05 || Math.abs(this.velocity.y) > 0.05 || Math.abs(this.velocity.scale) > 0.05)\n    );\n  }\n\n  /**\n   * Set content `style.transform` value based on current animation frame\n   */\n  setTransform(final) {\n    let x, y, scale;\n\n    if (final) {\n      x = round(this.transform.x);\n      y = round(this.transform.y);\n\n      scale = this.transform.scale;\n\n      this.content = { ...this.content, x, y, scale };\n    } else {\n      x = round(this.content.x);\n      y = round(this.content.y);\n\n      scale = this.content.scale / (this.content.width / this.content.fitWidth);\n\n      this.content = { ...this.content, x, y };\n    }\n\n    this.trigger(\"beforeTransform\");\n\n    x = round(this.content.x);\n    y = round(this.content.y);\n\n    if (final && this.option(\"zoom\")) {\n      let width;\n      let height;\n\n      width = round(this.content.fitWidth * scale);\n      height = round(this.content.fitHeight * scale);\n\n      this.content.width = width;\n      this.content.height = height;\n\n      this.transform = { ...this.transform, width, height, scale };\n\n      Object.assign(this.$content.style, {\n        width: `${width}px`,\n        height: `${height}px`,\n        maxWidth: \"none\",\n        maxHeight: \"none\",\n        transform: `translate3d(${x}px, ${y}px, 0) scale(1)`,\n      });\n    } else {\n      this.$content.style.transform = `translate3d(${x}px, ${y}px, 0) scale(${scale})`;\n    }\n\n    this.trigger(\"afterTransform\");\n  }\n\n  /**\n   * Stop animation loop\n   */\n  endAnimation(silently) {\n    cancelAnimationFrame(this.rAF);\n    this.rAF = null;\n\n    this.velocity = {\n      x: 0,\n      y: 0,\n      scale: 0,\n    };\n\n    this.setTransform(true);\n\n    this.state = \"ready\";\n\n    this.handleCursor();\n\n    if (silently !== true) {\n      this.trigger(\"endAnimation\");\n    }\n  }\n\n  /**\n   * Update the class name depending on whether the content is scaled\n   */\n  handleCursor() {\n    const draggableClass = this.option(\"draggableClass\");\n\n    if (!draggableClass || !this.option(\"touch\")) {\n      return;\n    }\n\n    if (\n      this.option(\"panOnlyZoomed\") == true &&\n      this.content.width <= this.viewport.width &&\n      this.content.height <= this.viewport.height &&\n      this.transform.scale <= this.option(\"baseScale\")\n    ) {\n      this.$container.classList.remove(draggableClass);\n    } else {\n      this.$container.classList.add(draggableClass);\n    }\n  }\n\n  /**\n   * Remove observation and detach event listeners\n   */\n  detachEvents() {\n    this.$content.removeEventListener(\"load\", this.onLoad);\n\n    this.$container.removeEventListener(\"wheel\", this.onWheel, { passive: false });\n    this.$container.removeEventListener(\"click\", this.onClick, { passive: false });\n\n    if (this.pointerTracker) {\n      this.pointerTracker.stop();\n      this.pointerTracker = null;\n    }\n\n    if (this.resizeObserver) {\n      this.resizeObserver.disconnect();\n      this.resizeObserver = null;\n    }\n  }\n\n  /**\n   * Clean up\n   */\n  destroy() {\n    if (this.state === \"destroy\") {\n      return;\n    }\n\n    this.state = \"destroy\";\n\n    clearTimeout(this.updateTimer);\n    this.updateTimer = null;\n\n    cancelAnimationFrame(this.rAF);\n    this.rAF = null;\n\n    this.detachEvents();\n\n    this.detachPlugins();\n\n    this.resetDragPosition();\n  }\n}\n\n// Expose version\nPanzoom.version = \"__VERSION__\";\n\n// Static properties are a recent addition that dont work in all browsers yet\nPanzoom.Plugins = Plugins;\n","export const Plugins = {};\n","import { extend } from \"../utils/extend.js\";\nimport { resolve } from \"../utils/resolve.js\";\nimport { isPlainObject } from \"../utils/isPlainObject.js\";\n\n/**\n * Base class, all components inherit from this class\n */\nexport class Base {\n  /**\n   * Base constructor\n   * @param {Object} [options] - Options as `key: value` pairs\n   */\n  constructor(options = {}) {\n    this.options = extend(true, {}, options);\n\n    this.plugins = [];\n    this.events = {};\n\n    // * Prefill with initial events\n    for (const type of [\"on\", \"once\"]) {\n      for (const args of Object.entries(this.options[type] || {})) {\n        this[type](...args);\n      }\n    }\n  }\n\n  /**\n   * Retrieve option value by key, supports subkeys\n   * @param {String} key Option name\n   * @param {*} [fallback] Fallback value for non-existing key\n   * @returns {*}\n   */\n  option(key, fallback, ...rest) {\n    // Make sure it is string\n    key = String(key);\n\n    let value = resolve(key, this.options);\n\n    // Allow to have functions as options\n    if (typeof value === \"function\") {\n      value = value.call(this, this, ...rest);\n    }\n\n    return value === undefined ? fallback : value;\n  }\n\n  /**\n   * Simple l10n support - replaces object keys\n   * found in template with corresponding values\n   * @param {String} str String containing values to localize\n   * @param {Array} params Substitute parameters\n   * @returns {String}\n   */\n  localize(str, params = []) {\n    str = String(str).replace(/\\{\\{(\\w+).?(\\w+)?\\}\\}/g, (match, key, subkey) => {\n      let rez = \"\";\n\n      // Plugins have `Plugin.l10n.KEY`\n      if (subkey) {\n        rez = this.option(`${key[0] + key.toLowerCase().substring(1)}.l10n.${subkey}`);\n      } else if (key) {\n        rez = this.option(`l10n.${key}`);\n      }\n\n      if (!rez) {\n        rez = match;\n      }\n\n      for (let index = 0; index < params.length; index++) {\n        rez = rez.split(params[index][0]).join(params[index][1]);\n      }\n\n      return rez;\n    });\n\n    str = str.replace(/\\{\\{(.*)\\}\\}/, (match, key) => {\n      return key;\n    });\n\n    return str;\n  }\n\n  /**\n   * Subscribe to an event\n   * @param {String} name\n   * @param {Function} callback\n   * @returns {Object}\n   */\n  on(name, callback) {\n    if (isPlainObject(name)) {\n      for (const args of Object.entries(name)) {\n        this.on(...args);\n      }\n\n      return this;\n    }\n\n    String(name)\n      .split(\" \")\n      .forEach((item) => {\n        const listeners = (this.events[item] = this.events[item] || []);\n\n        if (listeners.indexOf(callback) == -1) {\n          listeners.push(callback);\n        }\n      });\n\n    return this;\n  }\n\n  /**\n   * Subscribe to an event only once\n   * @param {String} name\n   * @param {Function} callback\n   * @returns {Object}\n   */\n  once(name, callback) {\n    if (isPlainObject(name)) {\n      for (const args of Object.entries(name)) {\n        this.once(...args);\n      }\n\n      return this;\n    }\n\n    String(name)\n      .split(\" \")\n      .forEach((item) => {\n        const listener = (...details) => {\n          this.off(item, listener);\n          callback.call(this, this, ...details);\n        };\n\n        listener._ = callback;\n\n        this.on(item, listener);\n      });\n\n    return this;\n  }\n\n  /**\n   * Unsubscribe event with name and callback\n   * @param {String} name\n   * @param {Function} callback\n   * @returns {Object}\n   */\n  off(name, callback) {\n    if (isPlainObject(name)) {\n      for (const args of Object.entries(name)) {\n        this.off(...args);\n      }\n\n      return;\n    }\n\n    name.split(\" \").forEach((item) => {\n      const listeners = this.events[item];\n\n      if (!listeners || !listeners.length) {\n        return this;\n      }\n\n      let index = -1;\n\n      for (let i = 0, len = listeners.length; i < len; i++) {\n        const listener = listeners[i];\n\n        if (listener && (listener === callback || listener._ === callback)) {\n          index = i;\n          break;\n        }\n      }\n\n      if (index != -1) {\n        listeners.splice(index, 1);\n      }\n    });\n\n    return this;\n  }\n\n  /**\n   * Emit an event.\n   * If present, `\"*\"` handlers are invoked after name-matched handlers.\n   * @param {String} name\n   * @param  {...any} details\n   * @returns {Boolean}\n   */\n  trigger(name, ...details) {\n    for (const listener of [...(this.events[name] || [])].slice()) {\n      if (listener && listener.call(this, this, ...details) === false) {\n        return false;\n      }\n    }\n\n    // A wildcard \"*\" event type\n    for (const listener of [...(this.events[\"*\"] || [])].slice()) {\n      if (listener && listener.call(this, name, this, ...details) === false) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Add given plugins to this instance,\n   * this will end up calling `attach` method of each plugin\n   * @param {Object} Plugins\n   * @returns {Object}\n   */\n  attachPlugins(plugins) {\n    const newPlugins = {};\n\n    for (const [key, Plugin] of Object.entries(plugins || {})) {\n      // Check if this plugin is not disabled by option\n      if (this.options[key] !== false && !this.plugins[key]) {\n        // Populate options with defaults from the plugin\n        this.options[key] = extend({}, Plugin.defaults || {}, this.options[key]);\n\n        // Initialise plugin\n        newPlugins[key] = new Plugin(this);\n      }\n    }\n\n    for (const [key, plugin] of Object.entries(newPlugins)) {\n      plugin.attach(this);\n    }\n\n    this.plugins = Object.assign({}, this.plugins, newPlugins);\n\n    return this;\n  }\n\n  /**\n   * Remove all plugin instances from this instance,\n   * this will end up calling `detach` method of each plugin\n   * @returns {Object}\n   */\n  detachPlugins() {\n    for (const key in this.plugins) {\n      let plugin;\n\n      if ((plugin = this.plugins[key]) && typeof plugin.detach === \"function\") {\n        plugin.detach(this);\n      }\n    }\n\n    this.plugins = {};\n\n    return this;\n  }\n}\n","export const Fullscreen = {\r\n  pageXOffset: 0,\r\n  pageYOffset: 0,\r\n\r\n  element() {\r\n    return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement;\r\n  },\r\n\r\n  activate(element) {\r\n    Fullscreen.pageXOffset = window.pageXOffset;\r\n    Fullscreen.pageYOffset = window.pageYOffset;\r\n\r\n    if (element.requestFullscreen) {\r\n      element.requestFullscreen(); // W3C spec\r\n    } else if (element.mozRequestFullScreen) {\r\n      element.mozRequestFullScreen(); // Firefox\r\n    } else if (element.webkitRequestFullscreen) {\r\n      element.webkitRequestFullscreen(); // Safari\r\n    } else if (element.msRequestFullscreen) {\r\n      element.msRequestFullscreen(); // IE/Edge\r\n    }\r\n  },\r\n\r\n  deactivate() {\r\n    if (document.exitFullscreen) {\r\n      document.exitFullscreen();\r\n    } else if (document.mozCancelFullScreen) {\r\n      document.mozCancelFullScreen();\r\n    } else if (document.webkitExitFullscreen) {\r\n      document.webkitExitFullscreen();\r\n    }\r\n  },\r\n};\r\n","class Pointer {\r\n  constructor(nativePointer) {\r\n    this.id = self.Touch && nativePointer instanceof Touch ? nativePointer.identifier : -1;\r\n\r\n    this.pageX = nativePointer.pageX;\r\n    this.pageY = nativePointer.pageY;\r\n\r\n    this.clientX = nativePointer.clientX;\r\n    this.clientY = nativePointer.clientY;\r\n  }\r\n}\r\n\r\nconst getDistance = (a, b) => {\r\n  if (!b) {\r\n    return 0;\r\n  }\r\n\r\n  return Math.sqrt((b.clientX - a.clientX) ** 2 + (b.clientY - a.clientY) ** 2);\r\n};\r\n\r\nconst getMidpoint = (a, b) => {\r\n  if (!b) {\r\n    return a;\r\n  }\r\n\r\n  return {\r\n    clientX: (a.clientX + b.clientX) / 2,\r\n    clientY: (a.clientY + b.clientY) / 2,\r\n  };\r\n};\r\n\r\nconst isTouchEvent = (event) => \"changedTouches\" in event;\r\n\r\nclass PointerTracker {\r\n  constructor(_element, { start = () => true, move = () => {}, end = () => {} } = {}) {\r\n    this._element = _element;\r\n\r\n    this.startPointers = [];\r\n    this.currentPointers = [];\r\n\r\n    this._pointerStart = (event) => {\r\n      if (event.buttons > 0 && event.button !== 0) {\r\n        return;\r\n      }\r\n\r\n      const pointer = new Pointer(event);\r\n\r\n      if (this.currentPointers.some((p) => p.id === pointer.id)) {\r\n        return;\r\n      }\r\n\r\n      if (!this._triggerPointerStart(pointer, event)) {\r\n        return;\r\n      }\r\n\r\n      window.addEventListener(\"mousemove\", this._move);\r\n      window.addEventListener(\"mouseup\", this._pointerEnd);\r\n    };\r\n\r\n    this._touchStart = (event) => {\r\n      for (const touch of Array.from(event.changedTouches || [])) {\r\n        this._triggerPointerStart(new Pointer(touch), event);\r\n      }\r\n    };\r\n\r\n    this._move = (event) => {\r\n      const previousPointers = this.currentPointers.slice();\r\n      const changedPointers = isTouchEvent(event)\r\n        ? Array.from(event.changedTouches).map((t) => new Pointer(t))\r\n        : [new Pointer(event)];\r\n\r\n      const trackedChangedPointers = [];\r\n\r\n      for (const pointer of changedPointers) {\r\n        const index = this.currentPointers.findIndex((p) => p.id === pointer.id);\r\n\r\n        if (index < 0) {\r\n          continue;\r\n        }\r\n\r\n        trackedChangedPointers.push(pointer);\r\n\r\n        this.currentPointers[index] = pointer;\r\n      }\r\n\r\n      this._moveCallback(previousPointers, this.currentPointers.slice(), event);\r\n    };\r\n\r\n    this._triggerPointerEnd = (pointer, event) => {\r\n      const index = this.currentPointers.findIndex((p) => p.id === pointer.id);\r\n\r\n      if (index < 0) {\r\n        return false;\r\n      }\r\n\r\n      this.currentPointers.splice(index, 1);\r\n      this.startPointers.splice(index, 1);\r\n\r\n      this._endCallback(pointer, event);\r\n\r\n      return true;\r\n    };\r\n\r\n    this._pointerEnd = (event) => {\r\n      if (event.buttons > 0 && event.button !== 0) {\r\n        return;\r\n      }\r\n\r\n      if (!this._triggerPointerEnd(new Pointer(event), event)) {\r\n        return;\r\n      }\r\n\r\n      window.removeEventListener(\"mousemove\", this._move, { passive: false });\r\n      window.removeEventListener(\"mouseup\", this._pointerEnd, { passive: false });\r\n    };\r\n\r\n    this._touchEnd = (event) => {\r\n      for (const touch of Array.from(event.changedTouches || [])) {\r\n        this._triggerPointerEnd(new Pointer(touch), event);\r\n      }\r\n    };\r\n\r\n    this._startCallback = start;\r\n    this._moveCallback = move;\r\n    this._endCallback = end;\r\n\r\n    this._element.addEventListener(\"mousedown\", this._pointerStart, { passive: false });\r\n    this._element.addEventListener(\"touchstart\", this._touchStart, { passive: false });\r\n    this._element.addEventListener(\"touchmove\", this._move, { passive: false });\r\n    this._element.addEventListener(\"touchend\", this._touchEnd);\r\n    this._element.addEventListener(\"touchcancel\", this._touchEnd);\r\n  }\r\n\r\n  stop() {\r\n    this._element.removeEventListener(\"mousedown\", this._pointerStart, { passive: false });\r\n    this._element.removeEventListener(\"touchstart\", this._touchStart, { passive: false });\r\n    this._element.removeEventListener(\"touchmove\", this._move, { passive: false });\r\n    this._element.removeEventListener(\"touchend\", this._touchEnd);\r\n    this._element.removeEventListener(\"touchcancel\", this._touchEnd);\r\n\r\n    window.removeEventListener(\"mousemove\", this._move);\r\n    window.removeEventListener(\"mouseup\", this._pointerEnd);\r\n  }\r\n\r\n  _triggerPointerStart(pointer, event) {\r\n    if (!this._startCallback(pointer, event)) {\r\n      return false;\r\n    }\r\n\r\n    this.currentPointers.push(pointer);\r\n    this.startPointers.push(pointer);\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\nexport { PointerTracker, getDistance, getMidpoint };\r\n","/**\n * ResizeObserver Polyfill\n */\nexport const ResizeObserver =\n  (typeof window !== \"undefined\" && window.ResizeObserver) ||\n  class {\n    constructor(callback) {\n      this.observables = [];\n      // Array of observed elements that looks like this:\n      // [{\n      //   el: domNode,\n      //   size: {height: x, width: y}\n      // }]\n      this.boundCheck = this.check.bind(this);\n      this.boundCheck();\n      this.callback = callback;\n    }\n\n    observe(el) {\n      if (this.observables.some((observable) => observable.el === el)) {\n        return;\n      }\n\n      const newObservable = {\n        el: el,\n        size: {\n          height: el.clientHeight,\n          width: el.clientWidth,\n        },\n      };\n\n      this.observables.push(newObservable);\n    }\n\n    unobserve(el) {\n      this.observables = this.observables.filter((obj) => obj.el !== el);\n    }\n\n    disconnect() {\n      this.observables = [];\n    }\n\n    check() {\n      const changedEntries = this.observables\n        .filter((obj) => {\n          const currentHeight = obj.el.clientHeight;\n          const currentWidth = obj.el.clientWidth;\n          if (obj.size.height !== currentHeight || obj.size.width !== currentWidth) {\n            obj.size.height = currentHeight;\n            obj.size.width = currentWidth;\n            return true;\n          }\n        })\n        .map((obj) => obj.el);\n\n      if (changedEntries.length > 0) {\n        this.callback(changedEntries);\n      }\n\n      window.requestAnimationFrame(this.boundCheck);\n    }\n  };\n","export class Slideshow {\r\n  constructor(fancybox) {\r\n    this.fancybox = fancybox;\r\n    this.active = false;\r\n\r\n    this.handleVisibilityChange = this.handleVisibilityChange.bind(this);\r\n  }\r\n\r\n  isActive() {\r\n    return this.active;\r\n  }\r\n\r\n  setTimer() {\r\n    if (!this.active || this.timer) {\r\n      return;\r\n    }\r\n\r\n    const delay = this.fancybox.option(\"slideshow.delay\", 3000);\r\n\r\n    this.timer = setTimeout(() => {\r\n      this.timer = null;\r\n\r\n      if (\r\n        !this.fancybox.option(\"infinite\") &&\r\n        this.fancybox.getSlide().index === this.fancybox.Carousel.slides.length - 1\r\n      ) {\r\n        this.fancybox.jumpTo(0, { friction: 0 });\r\n      } else {\r\n        this.fancybox.next();\r\n      }\r\n    }, delay);\r\n\r\n    let $progress = this.$progress;\r\n\r\n    if (!$progress) {\r\n      $progress = document.createElement(\"div\");\r\n      $progress.classList.add(\"fancybox__progress\");\r\n\r\n      this.fancybox.$carousel.parentNode.insertBefore($progress, this.fancybox.$carousel);\r\n\r\n      this.$progress = $progress;\r\n\r\n      $progress.offsetHeight; /* trigger reflow */\r\n    }\r\n\r\n    $progress.style.transitionDuration = `${delay}ms`;\r\n    $progress.style.transform = \"scaleX(1)\";\r\n  }\r\n\r\n  clearTimer() {\r\n    clearTimeout(this.timer);\r\n    this.timer = null;\r\n\r\n    if (this.$progress) {\r\n      this.$progress.style.transitionDuration = \"\";\r\n      this.$progress.style.transform = \"\";\r\n\r\n      this.$progress.offsetHeight; /* trigger reflow */\r\n    }\r\n  }\r\n\r\n  activate() {\r\n    if (this.active) {\r\n      return;\r\n    }\r\n\r\n    this.active = true;\r\n    this.fancybox.$container.classList.add(\"has-slideshow\");\r\n\r\n    if (this.fancybox.getSlide().state === \"done\") {\r\n      this.setTimer();\r\n    }\r\n\r\n    document.addEventListener(\"visibilitychange\", this.handleVisibilityChange, false);\r\n  }\r\n\r\n  handleVisibilityChange() {\r\n    this.deactivate();\r\n  }\r\n\r\n  deactivate() {\r\n    this.active = false;\r\n\r\n    this.clearTimer();\r\n\r\n    this.fancybox.$container.classList.remove(\"has-slideshow\");\r\n\r\n    document.removeEventListener(\"visibilitychange\", this.handleVisibilityChange, false);\r\n  }\r\n\r\n  toggle() {\r\n    if (this.active) {\r\n      this.deactivate();\r\n    } else if (this.fancybox.Carousel.slides.length > 1) {\r\n      this.activate();\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Detect if rendering from the client or the server\r\n */\r\nexport const canUseDOM = !!(typeof window !== \"undefined\" && window.document && window.document.createElement);\r\n","import { isPlainObject } from \"./isPlainObject.js\";\n\n/**\n * Merge the contents of two or more objects together into the first object.\n * If passing \"true\" for first argument, the merge becomes recursive (aka. deep copy).\n * @param  {...any} args\n * @returns {Object}\n */\nexport const extend = (...args) => {\n  let deep = false;\n\n  if (typeof args[0] == \"boolean\") {\n    deep = args.shift();\n  }\n\n  let result = args[0];\n\n  if (!result || typeof result !== \"object\") {\n    throw new Error(\"extendee must be an object\");\n  }\n\n  const extenders = args.slice(1);\n  const len = extenders.length;\n\n  for (let i = 0; i < len; i++) {\n    const extender = extenders[i];\n\n    for (let key in extender) {\n      if (extender.hasOwnProperty(key)) {\n        const value = extender[key];\n\n        if (deep && (Array.isArray(value) || isPlainObject(value))) {\n          const base = Array.isArray(value) ? [] : {};\n\n          result[key] = extend(true, result.hasOwnProperty(key) ? result[key] : base, value);\n        } else {\n          result[key] = value;\n        }\n      }\n    }\n  }\n\n  return result;\n};\n","/**\n * Get actual width of the element, regardless of how much of content is currently visible\n * @param {Element} elem\n * @returns {Integer}\n */\nexport const getFullWidth = (elem) => {\n  return Math.max(\n    parseFloat(elem.naturalWidth || 0),\n    parseFloat((elem.width && elem.width.baseVal && elem.width.baseVal.value) || 0),\n    parseFloat(elem.offsetWidth || 0),\n    parseFloat(elem.scrollWidth || 0)\n  );\n};\n\n/**\n * Get actual height of the element, regardless of how much of content is currently visible\n * @param {Element} elem\n * @returns {Integer}\n */\nexport const getFullHeight = (elem) => {\n  return Math.max(\n    parseFloat(elem.naturalHeight || 0),\n    parseFloat((elem.height && elem.height.baseVal && elem.height.baseVal.value) || 0),\n    parseFloat(elem.offsetHeight || 0),\n    parseFloat(elem.scrollHeight || 0)\n  );\n};\n\n/**\n * Calculate bounding size to fit dimensions while preserving aspect ratio\n * @param {Number} srcWidth\n * @param {Number} srcHeight\n * @param {Number} maxWidth\n * @param {Number} maxHeight\n * @returns {Object}\n */\nexport const calculateAspectRatioFit = (srcWidth, srcHeight, maxWidth, maxHeight) => {\n  const ratio = Math.min(maxWidth / srcWidth || 0, maxHeight / srcHeight);\n\n  return { width: srcWidth * ratio || 0, height: srcHeight * ratio || 0 };\n};\n","/**\n * Get element child node at the given coordinates\n * @param {Element} HTML element\n * @param {Float|Integer} x\n * @param {Float|Integer} y\n * @returns {Node|Boolean}}\n */\nexport const getTextNodeFromPoint = (element, x, y) => {\n  const nodes = element.childNodes;\n  const range = document.createRange();\n\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n\n    if (node.nodeType !== Node.TEXT_NODE) {\n      continue;\n    }\n\n    range.selectNodeContents(node);\n\n    const rect = range.getBoundingClientRect();\n\n    if (x >= rect.left && y >= rect.top && x <= rect.right && y <= rect.bottom) {\n      return node;\n    }\n  }\n\n  return false;\n};\n","/**\n * Check to see if an object is a plain object (created using \"{}\" or \"new Object\").\n * @param {*} obj Variable of any type\n * @returns {Boolean}\n */\nexport const isPlainObject = (obj) => {\n  return (\n    // separate from primitives\n    typeof obj === \"object\" &&\n    // is obvious\n    obj !== null &&\n    // separate instances (Array, DOM, ...)\n    obj.constructor === Object &&\n    // separate build-in like Math\n    Object.prototype.toString.call(obj) === \"[object Object]\"\n  );\n};\n","/**\n * Check if  element has scrollable content\n * @param {Node} node\n * @returns {Boolean}\n */\nexport const hasScrollbars = function (node) {\n  const overflowY = getComputedStyle(node)[\"overflow-y\"],\n    overflowX = getComputedStyle(node)[\"overflow-x\"],\n    vertical = (overflowY === \"scroll\" || overflowY === \"auto\") && Math.abs(node.scrollHeight - node.clientHeight) > 1,\n    horizontal = (overflowX === \"scroll\" || overflowX === \"auto\") && Math.abs(node.scrollWidth - node.clientWidth) > 1;\n\n  return vertical || horizontal;\n};\n\n/**\n * Check if element or one of the parents is scrollable\n * @param {Node} node  DOM Node element\n * @returns {Boolean}\n */\nexport const isScrollable = function (node) {\n  if (!node || !(typeof node === \"object\" && node instanceof Element) || node === document.body) {\n    return false;\n  }\n\n  if (node.__Panzoom) {\n    return false;\n  }\n\n  if (hasScrollbars(node)) {\n    return node;\n  }\n\n  return isScrollable(node.parentNode);\n};\n","/**\n * Access nested JavaScript objects by string path.\n * Example: `resolve(\"a.b.c\", {a:{b:{c:\"d\"}})` would return `d`\n * @param {String} path\n * @param {Object} obj\n * @returns {*}\n */\nexport const resolve = function (path, obj) {\n  return path.split(\".\").reduce(function (prev, curr) {\n    return prev && prev[curr];\n  }, obj);\n};\n","/**\n * Round half up; to be more specific and to ensure things like 1.005 round correctly\n * @param {Float} value\n * @param {Integer} precision\n * @returns {Float}\n */\nexport const round = (value, precision = 10000) => {\n  value = parseFloat(value) || 0;\n\n  return Math.round((value + Number.EPSILON) * precision) / precision;\n};\n","import { canUseDOM } from \"./canUseDOM.js\";\r\n\r\nlet preventScrollSupported = null;\r\n\r\nexport const FOCUSABLE_ELEMENTS = [\r\n  \"a[href]\",\r\n  \"area[href]\",\r\n  'input:not([disabled]):not([type=\"hidden\"]):not([aria-hidden])',\r\n  \"select:not([disabled]):not([aria-hidden])\",\r\n  \"textarea:not([disabled]):not([aria-hidden])\",\r\n  \"button:not([disabled]):not([aria-hidden])\",\r\n  \"iframe\",\r\n  \"object\",\r\n  \"embed\",\r\n  \"video\",\r\n  \"audio\",\r\n  \"[contenteditable]\",\r\n  '[tabindex]:not([tabindex^=\"-\"]):not([disabled]):not([aria-hidden])',\r\n];\r\n\r\nexport const setFocusOn = (node) => {\r\n  if (!node || !canUseDOM) {\r\n    return;\r\n  }\r\n\r\n  if (preventScrollSupported === null) {\r\n    document.createElement(\"div\").focus({\r\n      get preventScroll() {\r\n        preventScrollSupported = true;\r\n\r\n        return false;\r\n      },\r\n    });\r\n  }\r\n\r\n  try {\r\n    if (node.setActive) {\r\n      // IE/Edge\r\n      node.setActive();\r\n    } else if (preventScrollSupported) {\r\n      // Modern browsers\r\n      node.focus({ preventScroll: true });\r\n    } else {\r\n      // Safari does not support `preventScroll` option\r\n      // https://bugs.webkit.org/show_bug.cgi?id=178583\r\n\r\n      // Save position\r\n      const scrollTop = window.pageXOffset || document.body.scrollTop;\r\n      const scrollLeft = window.pageYOffset || document.body.scrollLeft;\r\n\r\n      node.focus();\r\n\r\n      document.body.scrollTo({\r\n        top: scrollTop,\r\n        left: scrollLeft,\r\n        behavior: \"auto\",\r\n      });\r\n    }\r\n  } catch (e) {}\r\n};\r\n","/**\n * Throttling enforces a maximum number of times a function can be called over time\n * @param {Function} func Callback function\n * @param {Integer} limit Milliseconds\n * @returns {Function}\n */\nexport const throttle = (func, limit) => {\n  let lastCall = 0;\n\n  return function (...args) {\n    const now = new Date().getTime();\n\n    if (now - lastCall < limit) {\n      return;\n    }\n\n    lastCall = now;\n\n    return func(...args);\n  };\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/** ============================================================================\n * fancybox\n *\n * @version   0.9.0\n * @author    RIESTER <wordpress@riester.com>\n * @copyright 2022 RIESTER\n * ========================================================================== */\n\nimport { /* webpackMode: \"eager\" */ Fancybox } from '@fancyapps/ui/src/Fancybox/Fancybox.js';\nrwp = typeof rwp === 'undefined' ? {} : rwp;\n\nfunction modal(selector = '[data-fancybox]', args = {}) {\n\tconst defaults = {\n\t\ttemplate: '<div class=\"spinner-border\" role=\"status\"><span class=\"visually-hidden\">Loading...</span></div>',\n\t\ton: {\n\t\t\tload: (instance, slide) => {\n\t\t\t\tconsole.log(`#${slide.index} slide is loaded!`);\n\t\t\t\tconsole.log(`This slide is selected: ${instance.getSlide().index === slide.index}`);\n\t\t\t},\n\t\t},\n\t};\n\n\tif (!rwp.isEmpty(args)) {\n\t\targs = rwp.extend(args, defaults);\n\t} else {\n\t\targs = defaults;\n\t}\n\n\tif (!rwp.isEmpty(selector)) {\n\t\tconst modal = new Fancybox(selector, args);\n\n\t\treturn modal;\n\t}\n}\n\nrwp.modal = modal;\n"],"names":["defaults","slides","preload","slidesPerPage","initialPage","initialSlide","friction","center","infinite","fill","dragFree","prefix","classNames","viewport","track","slide","slideSelected","l10n","Carousel","Base","constructor","$container","options","extend","super","this","state","HTMLElement","Error","slideNext","throttle","bind","slidePrev","init","__Carousel","pages","page","pageIndex","prevPage","prevPageIndex","attachPlugins","Plugins","trigger","initLayout","initSlides","updateMetrics","$track","length","style","transform","left","manageSlideVisiblity","initPanzoom","option","$viewport","querySelector","document","createElement","classList","add","split","append","childNodes","appendChild","elems","querySelectorAll","forEach","el","$el","isDom","push","Array","isArray","contentWidth","indexes","lastSlideWidth","index","slideWidth","getSlideMetrics","width","viewportWidth","Math","max","offsetWidth","round","getBoundingClientRect","viewportStyles","getComputedStyle","parseFloat","paddingLeft","paddingRight","Number","isInteger","i","slice","currentPage","currentWidth","shouldCenter","shouldFill","reduce","sum","min","rez","page2","findPageForSlide","parseInt","updatePanzoom","node","firstSlide","dataset","isTestEl","visibility","customClass","prepend","currentStyle","window","marginLeft","marginRight","remove","find","indexOf","slideTo","params","setPage","Panzoom","content","x","velocity","panTo","y","ignoreBounds","destroy","wrapInner","resizeParent","zoom","click","lockAxis","centerOnStart","textSelection","panOnlyZoomed","on","name","details","afterUpdate","updatePage","beforeTransform","onBeforeTransform","touchEnd","onTouchEnd","endAnimation","fitWidth","origWidth","boundX","from","to","boundY","handleCursor","currentX","getPropertyValue","leftBoundary","rightBoundary","hasDiff","insideCurrentInterval","insidePrevInterval","insideNextInterval","createSlideEl","removeSlideEl","nextIndex","nextPos","updatedX","abs","markSelectedSlides","curentIndex","srcset","lazySrcset","lazySrc","HTMLImageElement","src","backgroundImage","div","html","innerHTML","allElelements","goal","refSlide","refIndex","prev","curr","insertBefore","nextSibling","selectedClass","attr","contains","removeAttribute","setAttribute","manageInfiniteTrack","panzoom","isFlipped","resetDragPosition","event","dragOffset","time","nextPageIndex","getPageFromPosition","slideToClosest","xPos","pageCount","interval","floor","toClosest","nextPosition","nextInterval","elemDimWidth","currPosition","decreasedPosition","increasedPosition","diff1","diff2","diff3","detachPlugins","version","NEXT","PREV","GOTO","minSlideCount","Dots","carousel","$list","events","change","onChange","refresh","onRefresh","buildList","addEventListener","e","target","preventDefault","stopPropagation","removeList","parentNode","removeChild","rebuildDots","listExists","pagesCount","dotCount","children","lastChild","$dot","localize","code","previousSibling","setActiveDot","$activeDot","attach","detach","off","prevTpl","nextTpl","main","button","next","Navigation","$prev","$next","createButton","type","$btn","toUpperCase","build","wrapDimWidth","cleanup","Sync","selectedIndex","onNavReady","onNavClick","onNavCreateSlide","onTargetChange","addAsTargetFor","nav","attachEvents","addAsNavFor","clickedNavSlide","closest","selectedNavIndex","selectedSyncPage","markSelectedSlide","targetIndex","selectedNavPage","filter","sync","startIndex","showClass","hideClass","animated","hideScrollbar","parentEl","mainClass","autoFocus","trapFocus","placeFocusBack","closeButton","dragToClose","keyboard","Escape","Delete","Backspace","PageUp","PageDown","ArrowUp","ArrowDown","ArrowRight","ArrowLeft","template","spinner","instances","Map","called","Fancybox","items","map","item","_width","height","_height","bindHandlers","setItems","initCarousel","set","id","focus","rest","getSlide","value","undefined","call","methodName","onMousedown","onKeydown","onFocus","onClick","detachEvents","removeEventListener","$root","body","mainTemplate","insertAdjacentHTML","onscroll","scrollLeft","Object","entries","class","role","tabIndex","args","$backdrop","$carousel","getAttribute","documentElement","$trigger","currentSrc","$thumb","origTarget","thumb","caption","infiniteX","infiniteY","createSlide","onCreateSlide","settle","onSettle","touchMove","onTouchMove","afterTransform","onTransform","$caption","className","defaultPrevented","eventTarget","composedPath","matches","close","activeElement","FOCUSABLE_ELEMENTS","blur","getSelection","toString","action","scale","distanceY","yPos","opacity","fitHeight","setProperty","getInstance","key","ctrlKey","altKey","shiftKey","isUIElement","ignoreElements","isContentEditable","nodeName","ignoreFocusChange","currentSlide","$currentSlide","allFocusableElems","enabledElems","$firstEl","isNodeVisible","offsetParent","isNodeInsideCurrentSlide","isNodeOutsideCarousel","origTabindex","hasAttribute","setFocusOn","lastFocus","canUseDOM","scrollbarWidth","innerWidth","$style","getElementById","getElementsByTagName","revealScrollbar","clearContent","$content","$closeButton","_className","setContent","opts","toLowerCase","$fragment","createRange","createContextualFragment","error","Element","setError","suffix","display","manageCloseButton","revealContent","position","CLOSE","firstChild","done","animateCSS","$element","callback","dispatchEvent","CustomEvent","bubbles","cancelable","handleAnimationEnd","currentTarget","message","hideLoading","showLoading","$spinner","jumpTo","includes","delete","nextInstance","static","metaKey","triggerGroupName","fancyboxTrigger","triggerItems","triggerIndex","fancyboxIndex","matchingOpener","openers","keys","reverse","some","opener","found","String","fromOpener","detail","mapCallback","falseValues","trueValues","assign","JSON","parse","get","groupAll","groupAttr","groupValue","root","getRootNode","currentInstance","selector","attachClickEvent","fromEvent","size","test","readyState","fb","instance","values","all","Plugin","create","MODAL","ERROR","IMAGE_ERROR","ELEMENT_NOT_FOUND","AJAX_NOT_FOUND","AJAX_FORBIDDEN","IFRAME_ERROR","TOGGLE_ZOOM","TOGGLE_THUMBS","TOGGLE_SLIDESHOW","TOGGLE_FULLSCREEN","DOWNLOAD","Hash","fancybox","closing","onClosing","hasCreatedHistory","origHash","timer","clearTimeout","firstRun","currentHash","URL","hash","newHash","slug","setTimeout","history","title","location","pathname","search","hasSilentClose","replaceState","getParsedURL","selectedElem","groupElems","plugins","startFromUrl","proceed","onHashChange","requestAnimationFrame","substr","tmp","pop","join","buildURLQuery","obj","url","URLSearchParams","match","video","autoplay","ratio","youtube","autohide","fs","rel","hd","wmode","enablejsapi","html5","vimeo","show_title","show_byline","show_portrait","fullscreen","html5video","tpl","format","Html","onInit","ready","onReady","onRemoveSlide","onSelectSlide","onUnselectSlide","processType","videoId","encodeURIComponent","vendor","replace","charAt","playVideo","loadInlineContent","$placeHolder","cloneNode","attrId","loadAjaxContent","xhr","XMLHttpRequest","onreadystatechange","DONE","status","responseText","data","ajax","open","setRequestHeader","send","loadIframeContent","$iframe","resizeIframe","onerror","onload","isFirstLoad","isReady","setAspectRatio","maxWidth","maxHeight","offsetHeight","maxRatio","width_","height_","autoSize","$parent","parentStyle","compStyles","paddingX","paddingY","paddingTop","paddingBottom","contentWindow","$html","$body","overflow","scrollWidth","flex","scrollHeight","newStyle","poster","$video","promise","play","then","catch","muted","err","poller","command","func","method","postMessage","stringify","pause","abort","onMessage","origin","getElementsByClassName","source","ex","canZoomInClass","canZoomOutClass","zoomOpacity","zoomFriction","ignoreCoveredThumbnail","touch","doubleClick","wheel","fit","wrap","Image","onDone","onPageChange","clickTimer","$image","canZoom","zoomOut","imageFit","stopImmediatePropagation","onImageStatusChange","alt","draggable","sizes","shouldWrap","$wrap","complete","naturalWidth","naturalHeight","initSlidePanzoom","onWheel","passive","zoomIn","getZoomInfo","thumbRect","thumbWidth","thumbHeight","contentRect","contentHeight","shiftedTop","top","shiftedLeft","visualViewport","rect","visibleTopLeft","elementFromPoint","visibleBottomRight","right","bottom","animatePosition","once","clickAction","touchIsEnabled","zoomInClass","zoomOutClass","canZoomIn","zoomWithWheel","deltaY","dragPosition","midPoint","process","zoomWithClick","dblclickAction","currSlide","ScrollLock","pendingUpdate","startY","onResize","updateViewport","onTouchstart","onTouchmove","offsetLeft","offsetTop","touches","screenY","clientWidth","isScrollable","curY","isAtTop","scrollTop","isAtBottom","cancelAnimationFrame","minScreenHeight","autoStart","Thumbs","prepare","onPrepare","keydown","getSlides","toggle","hide","show","autoEnable","counter","tabindex","label","Fullscreen","slideshow","Slideshow","toggleZoom","download","thumbs","Toolbar","hasImage","isPlainObject","update","activate","onFsChange","scrollTo","isActive","deactivate","setTimer","clearTimer","prop","$svg","all_items","all_groups","fullscreenEnabled","fullScreen","group","idx","cnt","downloadSrc","pinchToZoom","decelFriction","bounceForce","baseScale","minScale","maxScale","step","wheelFactor","wheelLimit","draggableClass","draggingClass","resetValues","__Panzoom","updateRate","navigator","userAgent","container","origHeight","onLoad","getClientRects","dragStart","changedDelta","delta","deltaX","wheelDelta","newScale","clientX","clientY","zoomTo","initObserver","pointerTracker","PointerTracker","start","pointer","currentPointers","ignoreClickedElement","getTextNodeFromPoint","Date","now","move","previousPointers","prevMidpoint","getMidpoint","newMidpoint","panX","panY","prevDistance","getDistance","newDistance","scaleDiff","axisToLock","angle","atan2","PI","startPoint","startPointers","getZoomDelta","setDragResistance","startAnimation","end","_dragOffset","recalculateTransform","last","resizeObserver","ResizeObserver","updateTimer","isAnimating","observe","silently","contentIsImage","contentIsZoomable","shouldResizeParent","getFullWidth","getFullHeight","viewportRect","containerRect","viewportHeight","calculateAspectRatioFit","isZoomable","props","currentScale","currentHeight","percentXInCurrentBox","percentYInCurrentBox","nextWidth","nextHeight","getBounds","rAF","animate","setEdgeForce","setDragForce","setTransform","pastLeft","pastRight","pastTop","pastBottom","bound","distance","force","restX","restY","final","stop","disconnect","fallback","resolve","str","subkey","substring","listeners","listener","_","len","splice","newPlugins","plugin","pageXOffset","pageYOffset","element","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","Pointer","nativePointer","self","Touch","identifier","pageX","pageY","a","b","sqrt","isTouchEvent","_element","_pointerStart","buttons","p","_triggerPointerStart","_move","_pointerEnd","_touchStart","changedTouches","changedPointers","t","trackedChangedPointers","findIndex","_moveCallback","_triggerPointerEnd","_endCallback","_touchEnd","_startCallback","observables","boundCheck","check","observable","newObservable","clientHeight","unobserve","changedEntries","active","handleVisibilityChange","delay","$progress","transitionDuration","deep","shift","result","extenders","extender","hasOwnProperty","base","elem","baseVal","srcWidth","srcHeight","nodes","range","nodeType","Node","TEXT_NODE","selectNodeContents","prototype","hasScrollbars","overflowY","overflowX","vertical","horizontal","path","precision","EPSILON","preventScrollSupported","preventScroll","setActive","behavior","limit","lastCall","getTime","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","d","definition","o","defineProperty","enumerable","r","Symbol","toStringTag","rwp","modal","load","console","log","isEmpty"],"sourceRoot":""}