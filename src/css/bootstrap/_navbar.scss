/// ======================================================================== ///
/// @name   _narbar
///
/// @group  RWP
/// @version   0.9.0
/// @copyright 2022 RIESTER
/// ======================================================================== ///
@import '~bootstrap/scss/navbar';

.navbar {
	@each $color, $value in $theme-colors {
		&.bg-#{$color} {
			.sub-nav {
				// stylelint-disable-next-line
				--#{$variable-prefix}-sub-nav-bg: #{$value};
			}
		}
	}

	> .navbar-wrapper-inner {
		display: grid;
		gap: getcssvar(navbar-gap-y) getcssvar(navbar-gap-x);
		grid-template-rows: auto auto;
		@for $column from 1 through 6 {
			@each $breakpoint in map-keys($grid-breakpoints) {
				$infix: breakpoint-infix($breakpoint);

				@include media-breakpoint-up($breakpoint) {
					&.grid-columns#{$infix}-#{$column} {
						grid-template-columns: repeat($column, max-content);

						@if $infix != '' {
							grid-template-rows: auto;

							.navbar-collapse {
								grid-row-end: unset;
								grid-column: unset;
							}
						}
					}
				}
			}
		}

		.navbar-collapse {
			grid-row-end: -1;
			grid-column: 1 / -1;
		}
	}

	.dropdown {
		> .dropdown-menu {
			max-height: 0;
			transform-origin: top left;
			display: block;
			opacity: 0;
			visibility: hidden;
			backface-visibility: hidden;
			border: none;
			@include transition(all 0.4s easeInQuart);

			&.show {
				@include transition(all 0.4s easeOutQuart);

				opacity: 1;
				visibility: visible;
				max-height: 9999px;
			}
		}
	}

	.menu-divider {
		border-bottom: getcssvar(dropdown-divider-width) solid getcssvar(dropdown-divider-bg);

		.vr {
			display: none;
		}
	}
}

// Generate series of `.navbar-expand-*` responsive classes for configuring
// where your navbar collapses.
.navbar-expand {
	@each $breakpoint in map-keys($grid-breakpoints) {
		$next: breakpoint-next($breakpoint, $grid-breakpoints);
		$infix: breakpoint-infix($next, $grid-breakpoints);

		&#{$infix} {
			@include media-breakpoint-up($next) {
				.subnav.level-1-menu {
					position: absolute;
					top: 100%;
					left: 0;
					z-index: $zindex-dropdown;
					padding: $dropdown-padding-y $dropdown-padding-x;
					text-align: left; // Ensures proper alignment if parent has it changed (e.g., modal footer)
					background-clip: padding-box;
					border: $dropdown-border-width solid $dropdown-border-color;
					@include border-radius($dropdown-border-radius);
					@include box-shadow($dropdown-box-shadow);

					ul {
						@include font-size($dropdown-font-size);
					}
				}

				.dropdown {
					> .dropdown-menu {
						max-height: none;
						border: $dropdown-border-width solid $dropdown-border-color;
					}
				}

				.dropdown:not(.dropend) {
					> .dropdown-menu {
						top: 80%;
						transform: rotateX(-75deg);

						&.show {
							top: 100%;
							transform: rotateX(0deg);
						}
					}
				}

				.dropdown.dropend {
					> .dropdown-menu {
						top: 0;
						left: 80%;
						transform: rotateY(-75deg);

						&.show {
							left: 100%;
							transform: rotateY(0deg);
						}
					}
				}

				.menu-divider {
					border-bottom: none;

					.vr {
						display: block;
					}
				}
			}
		}
	}

	.nav-item {
		&:not(.level-0-item),
		&:not(.top-level-menu-item) {
			padding: $dropdown-item-padding-y $dropdown-item-padding-x;

			// Prevent dropdown overflow if there's no padding
			// See https://github.com/twbs/bootstrap/pull/27703
			@if $dropdown-padding-y == 0 {
				&:first-child {
					@include border-top-radius($dropdown-inner-border-radius);
				}

				&:last-child {
					@include border-bottom-radius($dropdown-inner-border-radius);
				}
			}

			.nav-link {
				padding: 0;
			}
		}
	}
}
